statement ok
drop table if exists t1 all;

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null);

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104);

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105);

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113);

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null);

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121);

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125);

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130);

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137);

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143);

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147);

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null);

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158);

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162);

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166);

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174);

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175);

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184);

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185);

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191);

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195);

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204);

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207);

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211);

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219);

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224);

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225);

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233);

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238);

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null);

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245);

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2 as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       c-d as col5
from t1
where c between b-2 and d+2
    or b>c
order by col4,col5,col2,col3,col1;

----
5 416 138 111 1
6 428 142 111 1
19 635 213 222 2
3 385 127 333 -3
10 483 163 333 -3
0 317 107 333 -2
20 652 216 333 -2
2 369 121 333 1
14 544 182 333 1
26 743 245 444 -1
4 391 131 444 1
15 560 188 444 2
21 666 220 444 2
16 579 191 444 3
23 698 234 555 -2
17 595 199 555 -1
22 685 229 555 -1
1 NULL NULL 555 -1
12 514 174 555 1
18 NULL NULL 555 1
8 455 153 555 NULL
9 475 159 555 NULL
11 502 168 555 NULL

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2 as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       c-d as col5
from t1
where c between b-2 and d+2
    or b>c
order by col4,col1,col2,col3,col5;

----
5 416 138 111 1
6 428 142 111 1
19 635 213 222 2
0 317 107 333 -2
2 369 121 333 1
3 385 127 333 -3
10 483 163 333 -3
14 544 182 333 1
20 652 216 333 -2
4 391 131 444 1
15 560 188 444 2
16 579 191 444 3
21 666 220 444 2
26 743 245 444 -1
1 NULL NULL 555 -1
8 455 153 555 NULL
9 475 159 555 NULL
11 502 168 555 NULL
12 514 174 555 1
17 595 199 555 -1
18 NULL NULL 555 1
22 685 229 555 -1
23 698 234 555 -2

statement query TTIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where (e>c or e<d)
    or c>d
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 1057 358 0 1
187.0 2806 1121 376 0 1
192.0 2878 1158 382 0 1
222.0 3331 1338 440 0 1
232.0 3473 1391 468 0 1
107.0 1612 635 1050 0 1
NULL NULL NULL 1120 0 1
NULL NULL 738 1240 0 1
162.0 2432 966 1600 0 1
247.0 3706 1484 490 0 2
137.0 2046 827 1390 0 2
142.0 2131 851 1430 0 2
172.0 2579 1030 1700 0 2
NULL NULL NULL NULL 0 2
182.0 2728 1096 364 0 3
197.0 2949 1180 398 0 3
212.0 3175 1277 426 0 3
217.0 3260 1297 432 0 3
227.0 3399 1360 458 0 3
NULL NULL 940 1580 0 3
127.0 1902 760 1290 0 4
132.0 1985 793 1300 0 4
NULL NULL NULL 402 0 NULL
NULL NULL NULL 2360 0 NULL
NULL NULL NULL NULL 0 NULL
NULL NULL NULL NULL 0 NULL

statement query TTIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where (e>c or e<d)
    or c>d
    or e+d between a+b-10 and c+130
order by col4,col6,col1,col5,col2,col3;

----
NULL NULL 1057 358 0 1
182.0 2728 1096 364 0 3
187.0 2806 1121 376 0 1
192.0 2878 1158 382 0 1
197.0 2949 1180 398 0 3
NULL NULL NULL 402 0 NULL
212.0 3175 1277 426 0 3
217.0 3260 1297 432 0 3
222.0 3331 1338 440 0 1
227.0 3399 1360 458 0 3
232.0 3473 1391 468 0 1
247.0 3706 1484 490 0 2
107.0 1612 635 1050 0 1
NULL NULL NULL 1120 0 1
NULL NULL 738 1240 0 1
127.0 1902 760 1290 0 4
132.0 1985 793 1300 0 4
137.0 2046 827 1390 0 2
142.0 2131 851 1430 0 2
NULL NULL 940 1580 0 3
162.0 2432 966 1600 0 1
172.0 2579 1030 1700 0 2
NULL NULL NULL 2360 0 NULL
NULL NULL NULL NULL 0 2
NULL NULL NULL NULL 0 NULL
NULL NULL NULL NULL 0 NULL

statement query TTIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where e+d between a+b-10 and c+130
    or (e>c or e<d)
    or c>d
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 1057 358 0 1
187.0 2806 1121 376 0 1
192.0 2878 1158 382 0 1
222.0 3331 1338 440 0 1
232.0 3473 1391 468 0 1
107.0 1612 635 1050 0 1
NULL NULL NULL 1120 0 1
NULL NULL 738 1240 0 1
162.0 2432 966 1600 0 1
247.0 3706 1484 490 0 2
137.0 2046 827 1390 0 2
142.0 2131 851 1430 0 2
172.0 2579 1030 1700 0 2
NULL NULL NULL NULL 0 2
182.0 2728 1096 364 0 3
197.0 2949 1180 398 0 3
212.0 3175 1277 426 0 3
217.0 3260 1297 432 0 3
227.0 3399 1360 458 0 3
NULL NULL 940 1580 0 3
127.0 1902 760 1290 0 4
132.0 1985 793 1300 0 4
NULL NULL NULL 402 0 NULL
NULL NULL NULL 2360 0 NULL
NULL NULL NULL NULL 0 NULL
NULL NULL NULL NULL 0 NULL

statement query FIIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where e+d between a+b-10 and c+130
    or (e>c or e<d)
    or c>d
order by col1,col4,col6,col5,col3,col2;

----
107.0 1612 635 1050 0 1
127.0 1902 760 1290 0 4
132.0 1985 793 1300 0 4
137.0 2046 827 1390 0 2
142.0 2131 851 1430 0 2
162.0 2432 966 1600 0 1
172.0 2579 1030 1700 0 2
182.0 2728 1096 364 0 3
187.0 2806 1121 376 0 1
192.0 2878 1158 382 0 1
197.0 2949 1180 398 0 3
212.0 3175 1277 426 0 3
217.0 3260 1297 432 0 3
222.0 3331 1338 440 0 1
227.0 3399 1360 458 0 3
232.0 3473 1391 468 0 1
247.0 3706 1484 490 0 2
NULL NULL 1057 358 0 1
NULL NULL NULL 402 0 NULL
NULL NULL NULL 1120 0 1
NULL NULL 738 1240 0 1
NULL NULL 940 1580 0 3
NULL NULL NULL 2360 0 NULL
NULL NULL NULL NULL 0 2
NULL NULL NULL NULL 0 NULL
NULL NULL NULL NULL 0 NULL

statement query IIIIII
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       abs(a) as col3,
       d as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (e>c or e<d)
order by col6,col4,col5,col2,col3,col1;

----
4 1902 127 128 385 -3
-1 2432 163 164 483 -3
-1 1612 107 108 317 -2
3 3260 216 217 652 -2
1 3473 234 233 698 -2
-1 NULL NULL 114 NULL -1
3 2949 199 196 595 -1
NULL NULL 201 203 NULL -1
3 3399 229 226 685 -1
2 3706 245 248 743 -1
-4 1985 131 133 391 1
2 2046 138 136 416 1
2 2131 142 140 428 1
-2 2579 174 171 514 1
-3 2728 182 183 544 1
-1 2806 188 185 560 2
-3 3175 213 212 635 2
-1 3331 220 222 666 2
NULL NULL 239 238 711 NULL
3 NULL 159 NULL 475 NULL
-1 NULL 179 NULL 529 NULL

statement query IIIIII
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       abs(a) as col3,
       d as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (e>c or e<d)
order by col6,col4,col1,col5,col3,col2;

----
4 1902 127 128 385 -3
-1 2432 163 164 483 -3
-1 1612 107 108 317 -2
3 3260 216 217 652 -2
1 3473 234 233 698 -2
-1 NULL NULL 114 NULL -1
3 2949 199 196 595 -1
NULL NULL 201 203 NULL -1
3 3399 229 226 685 -1
2 3706 245 248 743 -1
-4 1985 131 133 391 1
2 2046 138 136 416 1
2 2131 142 140 428 1
-2 2579 174 171 514 1
-3 2728 182 183 544 1
-1 2806 188 185 560 2
-3 3175 213 212 635 2
-1 3331 220 222 666 2
NULL NULL 239 238 711 NULL
-1 NULL 179 NULL 529 NULL
3 NULL 159 NULL 475 NULL

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       c as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
order by col2,col3,col1;

----
1290 222 125
1050 333 106

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       c as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
order by col3,col2,col1;

----
1050 333 106
1290 222 125

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where c>d
order by col1;

----
0
0
0
0
0
0
0
0
0
0
0
0
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where c>d
order by col1;

----
0
0
0
0
0
0
0
0
0
0
0
0
0

statement query I
select d-e as col1
from t1
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIIIIII
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a as col4,
       d as col5,
       a+b*2+c*3+d*4 as col6,
       a+b*2 as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
106 0 333 107 108 1067 317
123 2 222 121 122 1226 369
125 3 222 127 128 1272 385
134 4 333 131 133 1325 391
137 5 222 138 136 1371 416
141 6 222 142 140 1411 428
161 10 444 163 164 1622 483
172 12 444 174 171 1714 514
184 14 333 182 183 1828 544
187 15 333 188 185 1861 560
193 16 222 191 190 1918 579
195 17 333 199 196 1964 595
214 19 333 213 212 2125 635
215 20 222 216 217 2165 652
224 21 222 220 222 2226 666
225 22 333 229 226 2264 685
231 23 333 234 233 2323 698
247 26 111 245 248 2476 743
147 7 444 149 NULL NULL 439
150 8 333 153 NULL NULL 455
155 9 333 159 NULL NULL 475
166 11 333 168 NULL NULL 502
176 13 444 179 NULL NULL 529
NULL 24 444 239 238 NULL 711
244 25 444 243 NULL NULL 723
102 0 444 104 101 NULL NULL
119 0 444 115 116 NULL NULL
202 0 444 201 203 NULL NULL
113 1 444 NULL 114 NULL NULL
208 18 444 NULL 207 NULL NULL

statement query IIIIITT
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a as col4,
       d as col5,
       a+b*2+c*3+d*4 as col6,
       a+b*2 as col7
from t1
order by col1,col3,col2,col6,col7,col4,col5;

----
102 0 444 104 101 NULL NULL
106 0 333 107 108 1067 317
113 1 444 NULL 114 NULL NULL
119 0 444 115 116 NULL NULL
123 2 222 121 122 1226 369
125 3 222 127 128 1272 385
134 4 333 131 133 1325 391
137 5 222 138 136 1371 416
141 6 222 142 140 1411 428
147 7 444 149 NULL NULL 439
150 8 333 153 NULL NULL 455
155 9 333 159 NULL NULL 475
161 10 444 163 164 1622 483
166 11 333 168 NULL NULL 502
172 12 444 174 171 1714 514
176 13 444 179 NULL NULL 529
184 14 333 182 183 1828 544
187 15 333 188 185 1861 560
193 16 222 191 190 1918 579
195 17 333 199 196 1964 595
202 0 444 201 203 NULL NULL
208 18 444 NULL 207 NULL NULL
214 19 333 213 212 2125 635
215 20 222 216 217 2165 652
224 21 222 220 222 2226 666
225 22 333 229 226 2264 685
231 23 333 234 233 2323 698
244 25 444 243 NULL NULL 723
247 26 111 245 248 2476 743
NULL 24 444 239 238 NULL 711

statement query TIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col2,col3,col1;

----
NULL 1057 529 358 555
182.0 1096 544 364 333
187.0 1121 560 376 444
192.0 1158 579 382 444
197.0 1180 595 398 555
NULL NULL NULL 402 222
212.0 1277 635 426 222
217.0 1297 652 432 333
222.0 1338 666 440 444
227.0 1360 685 458 555
232.0 1391 698 468 555
NULL 1455 723 486 222
247.0 1484 743 490 444
107.0 635 317 1050 333
NULL NULL NULL 1120 555
NULL 738 369 1240 333
127.0 760 385 1290 333
132.0 793 391 1300 444
137.0 827 416 1390 111
142.0 851 428 1430 111
NULL 880 439 1450 555
NULL 905 455 1510 555
NULL 940 475 1580 555
162.0 966 483 1600 333
NULL 1000 502 1670 555
172.0 1030 514 1700 555
NULL NULL 711 2360 555
NULL NULL NULL NULL 333
NULL NULL NULL NULL 555
NULL NULL NULL NULL 555

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col2,col1,col3,col4;

----
137.0 827 416 1390 111
142.0 851 428 1430 111
212.0 1277 635 426 222
NULL 1455 723 486 222
NULL NULL NULL 402 222
107.0 635 317 1050 333
NULL 738 369 1240 333
127.0 760 385 1290 333
162.0 966 483 1600 333
182.0 1096 544 364 333
217.0 1297 652 432 333
NULL NULL NULL NULL 333
132.0 793 391 1300 444
187.0 1121 560 376 444
192.0 1158 579 382 444
222.0 1338 666 440 444
247.0 1484 743 490 444
NULL 880 439 1450 555
NULL 905 455 1510 555
NULL 940 475 1580 555
NULL 1000 502 1670 555
172.0 1030 514 1700 555
NULL 1057 529 358 555
197.0 1180 595 398 555
227.0 1360 685 458 555
232.0 1391 698 468 555
NULL NULL 711 2360 555
NULL NULL NULL 1120 555
NULL NULL NULL NULL 555
NULL NULL NULL NULL 555

statement query IIIFIII
select b-c as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2 as col3,
       (a+b+c+d+e)/5 as col4,
       d-e as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
2 444 743 247.0 2 111 245
1 333 369 NULL NULL 222 121
4 333 385 127.0 2 222 127
2 111 416 137.0 1 222 138
2 111 428 142.0 -4 222 142
1 444 579 192.0 -2 222 191
3 333 652 217.0 -2 222 216
-1 444 666 222.0 1 222 220
-1 333 317 107.0 -1 333 107
-4 444 391 132.0 1 333 131
1 555 455 NULL NULL 333 153
3 555 475 NULL NULL 333 159
1 555 502 NULL NULL 333 168
-3 333 544 182.0 3 333 182
-1 444 560 187.0 -4 333 188
3 555 595 197.0 -1 333 199
-3 222 635 212.0 2 333 213
3 555 685 227.0 -1 333 229
1 555 698 232.0 3 333 234
NULL 555 NULL NULL NULL 444 104
NULL 333 NULL NULL -1 444 115
-2 555 439 NULL NULL 444 149
-1 333 483 162.0 2 444 163
-2 555 514 172.0 -2 444 174
-1 555 529 NULL NULL 444 179
NULL 222 NULL NULL -1 444 201
NULL 555 711 NULL 1 444 239
-4 222 723 NULL NULL 444 243
-1 555 NULL NULL 4 444 NULL
-2 555 NULL NULL NULL 444 NULL

statement query IIIFIII
select b-c as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2 as col3,
       (a+b+c+d+e)/5 as col4,
       d-e as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a as col7
from t1
order by col4,col5,col2,col6,col7,col3,col1;

----
-1 333 317 107.0 -1 333 107
4 333 385 127.0 2 222 127
-4 444 391 132.0 1 333 131
2 111 416 137.0 1 222 138
2 111 428 142.0 -4 222 142
-1 333 483 162.0 2 444 163
-2 555 514 172.0 -2 444 174
-3 333 544 182.0 3 333 182
-1 444 560 187.0 -4 333 188
1 444 579 192.0 -2 222 191
3 555 595 197.0 -1 333 199
-3 222 635 212.0 2 333 213
3 333 652 217.0 -2 222 216
-1 444 666 222.0 1 222 220
3 555 685 227.0 -1 333 229
1 555 698 232.0 3 333 234
2 444 743 247.0 2 111 245
NULL 222 NULL NULL -1 444 201
NULL 333 NULL NULL -1 444 115
NULL 555 711 NULL 1 444 239
-1 555 NULL NULL 4 444 NULL
-4 222 723 NULL NULL 444 243
1 333 369 NULL NULL 222 121
1 555 455 NULL NULL 333 153
3 555 475 NULL NULL 333 159
1 555 502 NULL NULL 333 168
NULL 555 NULL NULL NULL 444 104
-2 555 439 NULL NULL 444 149
-1 555 529 NULL NULL 444 179
-2 555 NULL NULL NULL 444 NULL

statement query I
select a as col1
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query I
select a as col1
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query I
select a as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query I
select a as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query I
select a as col1
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query I
select a as col1
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col1;

----
104
107
127
131
138
142
159
163
168
174
182
188
191
199
201
213
216
220
229
234
239
245
NULL

statement query TI
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
NULL 358
2728 364
2806 376
2878 382
2949 398
NULL 402
3175 426
3260 432
3331 440
3399 458
3473 468
NULL 486
3706 490
1612 1050
NULL 1120
NULL 1240
1902 1290
1985 1300
2046 1390
2131 1430
NULL 1450
NULL 1510
NULL 1580
2432 1600
NULL 1670
2579 1700
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
1612 1050
1902 1290
1985 1300
2046 1390
2131 1430
2432 1600
2579 1700
2728 364
2806 376
2878 382
2949 398
3175 426
3260 432
3331 440
3399 458
3473 468
3706 490
NULL 358
NULL 402
NULL 486
NULL 1120
NULL 1240
NULL 1450
NULL 1510
NULL 1580
NULL 1670
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query TI
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or a>b
order by col2,col1;

----
NULL 358
2728 364
2806 376
2878 382
2949 398
NULL 402
3175 426
3260 432
3331 440
3399 458
3473 468
NULL 486
3706 490
1612 1050
NULL 1120
NULL 1240
1902 1290
1985 1300
2046 1390
2131 1430
NULL 1450
NULL 1510
NULL 1580
2432 1600
NULL 1670
2579 1700
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query TI
select a+b*2+c*3+d*4+e*5 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or a>b
order by col2,col1;

----
NULL 358
2728 364
2806 376
2878 382
2949 398
NULL 402
3175 426
3260 432
3331 440
3399 458
3473 468
NULL 486
3706 490
1612 1050
NULL 1120
NULL 1240
1902 1290
1985 1300
2046 1390
2131 1430
NULL 1450
NULL 1510
NULL 1580
2432 1600
NULL 1670
2579 1700
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query IIIII
select c-d as col1,
       abs(a) as col2,
       b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d>e
    or (e>c or e<d)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
-1 245 249 111 2476
-3 127 129 222 1272
1 138 139 222 1371
1 142 143 222 1411
3 191 194 222 1918
-2 216 218 222 2165
2 220 223 222 2226
-2 107 105 333 1067
1 131 130 333 1325
1 182 181 333 1828
2 188 186 333 1861
-1 199 198 333 1964
2 213 211 333 2125
-1 229 228 333 2264
-2 234 232 333 2323
NULL 159 158 333 NULL
-3 163 160 444 1622
1 174 170 444 1714
1 104 NULL 444 NULL
NULL 179 175 444 NULL
-1 201 NULL 444 NULL
NULL 239 236 444 NULL
-1 NULL 112 444 NULL
1 NULL 206 444 NULL

statement query IIIII
select c-d as col1,
       abs(a) as col2,
       b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d>e
    or (e>c or e<d)
    or d not between 110 and 150
order by col3,col2,col1,col4,col5;

----
-2 107 105 333 1067
-1 NULL 112 444 NULL
-3 127 129 222 1272
1 131 130 333 1325
1 138 139 222 1371
1 142 143 222 1411
NULL 159 158 333 NULL
-3 163 160 444 1622
1 174 170 444 1714
NULL 179 175 444 NULL
1 182 181 333 1828
2 188 186 333 1861
3 191 194 222 1918
-1 199 198 333 1964
1 NULL 206 444 NULL
2 213 211 333 2125
-2 216 218 222 2165
2 220 223 222 2226
-1 229 228 333 2264
-2 234 232 333 2323
NULL 239 236 444 NULL
-1 245 249 111 2476
1 104 NULL 444 NULL
-1 201 NULL 444 NULL

statement query IIIII
select c-d as col1,
       abs(a) as col2,
       b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d not between 110 and 150
    or d>e
    or (e>c or e<d)
order by col4,col5,col2,col3,col1;

----
-1 245 249 111 2476
-3 127 129 222 1272
1 138 139 222 1371
1 142 143 222 1411
3 191 194 222 1918
-2 216 218 222 2165
2 220 223 222 2226
-2 107 105 333 1067
1 131 130 333 1325
1 182 181 333 1828
2 188 186 333 1861
-1 199 198 333 1964
2 213 211 333 2125
-1 229 228 333 2264
-2 234 232 333 2323
NULL 159 158 333 NULL
-3 163 160 444 1622
1 174 170 444 1714
1 104 NULL 444 NULL
NULL 179 175 444 NULL
-1 201 NULL 444 NULL
NULL 239 236 444 NULL
-1 NULL 112 444 NULL
1 NULL 206 444 NULL

statement query IIIII
select c-d as col1,
       abs(a) as col2,
       b as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d not between 110 and 150
    or d>e
    or (e>c or e<d)
order by col3,col1,col4,col5,col2;

----
-2 107 105 333 1067
-1 NULL 112 444 NULL
-3 127 129 222 1272
1 131 130 333 1325
1 138 139 222 1371
1 142 143 222 1411
NULL 159 158 333 NULL
-3 163 160 444 1622
1 174 170 444 1714
NULL 179 175 444 NULL
1 182 181 333 1828
2 188 186 333 1861
3 191 194 222 1918
-1 199 198 333 1964
1 NULL 206 444 NULL
2 213 211 333 2125
-2 216 218 222 2165
2 220 223 222 2226
-1 229 228 333 2264
-2 234 232 333 2323
NULL 239 236 444 NULL
-1 245 249 111 2476
-1 201 NULL 444 NULL
1 104 NULL 444 NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4,
       a-b as col5,
       c-d as col6,
       a+b*2+c*3+d*4 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
1600 2 164 966 3 -3 1622
1050 -1 108 635 2 -2 1067
432 -2 217 1297 -2 -2 2165
468 3 233 1391 2 -2 2323
398 -1 196 1180 1 -1 1964
458 -1 226 1360 1 -1 2264
490 2 248 1484 -4 -1 2476
402 -1 203 NULL NULL -1 NULL
1300 1 133 793 1 1 1325
1390 1 136 827 -1 1 1371
1430 -4 140 851 -1 1 1411
1700 -2 171 1030 4 1 1714
364 3 183 1096 1 1 1828
NULL NULL 101 NULL NULL 1 NULL
NULL NULL 207 NULL NULL 1 NULL
376 -4 185 1121 2 2 1861
426 2 212 1277 2 2 2125
440 1 222 1338 -3 2 2226
382 -2 190 1158 -3 3 1918
1580 NULL NULL 940 1 NULL NULL
1670 NULL NULL 1000 1 NULL NULL
2360 1 238 NULL 3 NULL NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4,
       a-b as col5,
       c-d as col6,
       a+b*2+c*3+d*4 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col5,col7,col2,col6,col1,col4,col3;

----
490 2 248 1484 -4 -1 2476
382 -2 190 1158 -3 3 1918
440 1 222 1338 -3 2 2226
432 -2 217 1297 -2 -2 2165
1390 1 136 827 -1 1 1371
1430 -4 140 851 -1 1 1411
1300 1 133 793 1 1 1325
364 3 183 1096 1 1 1828
398 -1 196 1180 1 -1 1964
458 -1 226 1360 1 -1 2264
1580 NULL NULL 940 1 NULL NULL
1670 NULL NULL 1000 1 NULL NULL
1050 -1 108 635 2 -2 1067
376 -4 185 1121 2 2 1861
426 2 212 1277 2 2 2125
468 3 233 1391 2 -2 2323
1600 2 164 966 3 -3 1622
2360 1 238 NULL 3 NULL NULL
1700 -2 171 1030 4 1 1714
402 -1 203 NULL NULL -1 NULL
NULL NULL 101 NULL NULL 1 NULL
NULL NULL 207 NULL NULL 1 NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4,
       a-b as col5,
       c-d as col6,
       a+b*2+c*3+d*4 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col6,col7,col4,col5,col2,col3,col1;

----
1600 2 164 966 3 -3 1622
1050 -1 108 635 2 -2 1067
432 -2 217 1297 -2 -2 2165
468 3 233 1391 2 -2 2323
398 -1 196 1180 1 -1 1964
458 -1 226 1360 1 -1 2264
490 2 248 1484 -4 -1 2476
402 -1 203 NULL NULL -1 NULL
1300 1 133 793 1 1 1325
1390 1 136 827 -1 1 1371
1430 -4 140 851 -1 1 1411
1700 -2 171 1030 4 1 1714
364 3 183 1096 1 1 1828
NULL NULL 101 NULL NULL 1 NULL
NULL NULL 207 NULL NULL 1 NULL
376 -4 185 1121 2 2 1861
426 2 212 1277 2 2 2125
440 1 222 1338 -3 2 2226
382 -2 190 1158 -3 3 1918
1580 NULL NULL 940 1 NULL NULL
1670 NULL NULL 1000 1 NULL NULL
2360 1 238 NULL 3 NULL NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4,
       a-b as col5,
       c-d as col6,
       a+b*2+c*3+d*4 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col6,col2,col1,col7,col4,col5,col3;

----
1600 2 164 966 3 -3 1622
432 -2 217 1297 -2 -2 2165
1050 -1 108 635 2 -2 1067
468 3 233 1391 2 -2 2323
398 -1 196 1180 1 -1 1964
402 -1 203 NULL NULL -1 NULL
458 -1 226 1360 1 -1 2264
490 2 248 1484 -4 -1 2476
1430 -4 140 851 -1 1 1411
1700 -2 171 1030 4 1 1714
1300 1 133 793 1 1 1325
1390 1 136 827 -1 1 1371
364 3 183 1096 1 1 1828
NULL NULL 101 NULL NULL 1 NULL
NULL NULL 207 NULL NULL 1 NULL
376 -4 185 1121 2 2 1861
440 1 222 1338 -3 2 2226
426 2 212 1277 2 2 2125
382 -2 190 1158 -3 3 1918
2360 1 238 NULL 3 NULL NULL
1580 NULL NULL 940 1 NULL NULL
1670 NULL NULL 1000 1 NULL NULL

statement query IFII
select d as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       a+b*2+c*3 as col4
from t1
where c>d
   and (e>a and e<b)
order by col4,col2,col3,col1;

----
190 192.0 192 1158
222 222.0 221 1338

statement query IFII
select d as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       a+b*2+c*3 as col4
from t1
where c>d
   and (e>a and e<b)
order by col3,col1,col4,col2;

----
190 192.0 192 1158
222 222.0 221 1338

statement query IIFIIII
select e as col1,
       c-d as col2,
       (a+b+c+d+e)/5 as col3,
       abs(b-c) as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col7,col4,col5,col2,col3,col1;

----
109 -2 107.0 1 1050 1612 333
126 -3 127.0 4 1290 1902 222
132 1 132.0 4 1300 1985 333
135 1 137.0 2 1390 2046 222
144 1 142.0 2 1430 2131 222
162 -3 162.0 1 1600 2432 444
173 1 172.0 2 1700 2579 444
180 1 182.0 3 364 2728 333
189 2 187.0 1 376 2806 333
192 3 192.0 1 382 2878 222
197 -1 197.0 3 398 2949 333
210 2 212.0 3 426 3175 333
219 -2 217.0 3 432 3260 222
221 2 222.0 1 440 3331 222
227 -1 227.0 3 458 3399 333
230 -2 232.0 1 468 3473 333
246 -1 247.0 2 490 3706 111
NULL 1 NULL 1 1240 NULL 222
NULL NULL NULL 1 1510 NULL 333
165 NULL NULL 1 1670 NULL 333
157 NULL NULL 3 1580 NULL 333
177 NULL NULL 1 358 NULL 444
110 -1 NULL 1 1120 NULL 444
146 NULL NULL 2 1450 NULL 444
NULL 1 NULL 2 NULL NULL 444
NULL NULL NULL 4 486 NULL 444
204 -1 NULL NULL 402 NULL 444
237 NULL NULL NULL 2360 NULL 444
NULL 1 NULL NULL NULL NULL 444
117 3 NULL NULL NULL NULL 444

statement query IIFIIII
select e as col1,
       c-d as col2,
       (a+b+c+d+e)/5 as col3,
       abs(b-c) as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col5,col3,col6,col7,col4,col1;

----
126 -3 127.0 4 1290 1902 222
162 -3 162.0 1 1600 2432 444
219 -2 217.0 3 432 3260 222
230 -2 232.0 1 468 3473 333
109 -2 107.0 1 1050 1612 333
197 -1 197.0 3 398 2949 333
204 -1 NULL NULL 402 NULL 444
227 -1 227.0 3 458 3399 333
246 -1 247.0 2 490 3706 111
110 -1 NULL 1 1120 NULL 444
180 1 182.0 3 364 2728 333
NULL 1 NULL 1 1240 NULL 222
132 1 132.0 4 1300 1985 333
135 1 137.0 2 1390 2046 222
144 1 142.0 2 1430 2131 222
173 1 172.0 2 1700 2579 444
NULL 1 NULL 2 NULL NULL 444
NULL 1 NULL NULL NULL NULL 444
189 2 187.0 1 376 2806 333
210 2 212.0 3 426 3175 333
221 2 222.0 1 440 3331 222
192 3 192.0 1 382 2878 222
117 3 NULL NULL NULL NULL 444
177 NULL NULL 1 358 NULL 444
NULL NULL NULL 4 486 NULL 444
146 NULL NULL 2 1450 NULL 444
NULL NULL NULL 1 1510 NULL 333
157 NULL NULL 3 1580 NULL 333
165 NULL NULL 1 1670 NULL 333
237 NULL NULL NULL 2360 NULL 444

statement query IIIII
select c-d as col1,
       c as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col2,col3,col1;

----
-2 106 1050 1067 -1
1 123 1240 1226 NULL
-3 125 1290 1272 2
1 134 1300 1325 1
1 137 1390 1371 1
1 141 1430 1411 -4
-3 161 1600 1622 2
1 172 1700 1714 -2
1 184 364 1828 3
2 187 376 1861 -4
3 193 382 1918 -2
-1 195 398 1964 -1
2 214 426 2125 2
-2 215 432 2165 -2
2 224 440 2226 1
-1 225 458 2264 -1
-2 231 468 2323 3
-1 247 490 2476 2
3 119 NULL NULL -1
-1 202 402 NULL -1
NULL NULL 2360 NULL 1
-1 113 1120 NULL 4
1 102 NULL NULL NULL
NULL 147 1450 NULL NULL
NULL 150 1510 NULL NULL
NULL 155 1580 NULL NULL
NULL 166 1670 NULL NULL
NULL 176 358 NULL NULL
1 208 NULL NULL NULL
NULL 244 486 NULL NULL

statement query IIIII
select c-d as col1,
       c as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col3,col2,col4,col1;

----
2 187 376 1861 -4
1 141 1430 1411 -4
3 193 382 1918 -2
-2 215 432 2165 -2
1 172 1700 1714 -2
-1 195 398 1964 -1
-1 202 402 NULL -1
-1 225 458 2264 -1
-2 106 1050 1067 -1
3 119 NULL NULL -1
2 224 440 2226 1
1 134 1300 1325 1
1 137 1390 1371 1
NULL NULL 2360 NULL 1
2 214 426 2125 2
-1 247 490 2476 2
-3 125 1290 1272 2
-3 161 1600 1622 2
1 184 364 1828 3
-2 231 468 2323 3
-1 113 1120 NULL 4
NULL 176 358 NULL NULL
NULL 244 486 NULL NULL
1 123 1240 1226 NULL
NULL 147 1450 NULL NULL
NULL 150 1510 NULL NULL
NULL 155 1580 NULL NULL
NULL 166 1670 NULL NULL
1 102 NULL NULL NULL
1 208 NULL NULL NULL

statement query TIT
select case when c>avg_c then a*2 else b*10 end as col1,
       abs(a) as col2,
       b-c as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col3,col1;

----
NULL 104 NULL
1050 107 -1
NULL 115 NULL
1240 121 1
1290 127 4
1300 131 -4
1390 138 2
1430 142 2
1450 149 -2
1510 153 1
1580 159 3
1600 163 -1
1670 168 1
1700 174 -2
358 179 -1
364 182 -3
376 188 -1
382 191 1
398 199 3
402 201 NULL
426 213 -3
432 216 3
440 220 -1
458 229 3
468 234 1
2360 239 NULL
486 243 -4
490 245 2
NULL NULL -2
1120 NULL -1

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       abs(a) as col2,
       b-c as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col3,col1,col2;

----
486 243 -4
1300 131 -4
364 182 -3
426 213 -3
1450 149 -2
1700 174 -2
NULL NULL -2
358 179 -1
376 188 -1
440 220 -1
1050 107 -1
1120 NULL -1
1600 163 -1
382 191 1
468 234 1
1240 121 1
1510 153 1
1670 168 1
490 245 2
1390 138 2
1430 142 2
398 199 3
432 216 3
458 229 3
1580 159 3
1290 127 4
402 201 NULL
2360 239 NULL
NULL 104 NULL
NULL 115 NULL

statement query IIIII
select c-d as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3 as col5
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1;

----
-2 -1 333 1612 635
-3 4 222 1902 760
1 -4 333 1985 793
1 2 222 2046 827
-3 -1 444 2432 966
1 -3 333 2728 1096
2 -3 333 3175 1277
2 -1 222 3331 1338
-2 1 333 3473 1391
-1 2 111 3706 1484
-1 -1 444 NULL NULL
NULL NULL 444 NULL NULL

statement query IIIII
select c-d as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3 as col5
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col4,col1,col5,col3,col2;

----
-2 -1 333 1612 635
-3 4 222 1902 760
1 -4 333 1985 793
1 2 222 2046 827
-3 -1 444 2432 966
1 -3 333 2728 1096
2 -3 333 3175 1277
2 -1 222 3331 1338
-2 1 333 3473 1391
-1 2 111 3706 1484
-1 -1 444 NULL NULL
NULL NULL 444 NULL NULL

statement query IIIII
select c-d as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3 as col5
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col4,col5,col2,col3,col1;

----
-2 -1 333 1612 635
-3 4 222 1902 760
1 -4 333 1985 793
1 2 222 2046 827
-3 -1 444 2432 966
1 -3 333 2728 1096
2 -3 333 3175 1277
2 -1 222 3331 1338
-2 1 333 3473 1391
-1 2 111 3706 1484
-1 -1 444 NULL NULL
NULL NULL 444 NULL NULL

statement query IIIII
select c-d as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3 as col5
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col1,col4,col3,col2,col5;

----
-3 4 222 1902 760
-3 -1 444 2432 966
-2 -1 333 1612 635
-2 1 333 3473 1391
-1 2 111 3706 1484
-1 -1 444 NULL NULL
1 -4 333 1985 793
1 2 222 2046 827
1 -3 333 2728 1096
2 -3 333 3175 1277
2 -1 222 3331 1338
NULL NULL 444 NULL NULL

statement query III
select c as col1,
       abs(b-c) as col2,
       c-d as col3
from t1
order by col2,col3,col1;

----
161 1 -3
106 1 -2
231 1 -2
113 1 -1
123 1 1
187 1 2
224 1 2
193 1 3
150 1 NULL
166 1 NULL
176 1 NULL
247 2 -1
137 2 1
141 2 1
172 2 1
208 2 1
147 2 NULL
215 3 -2
195 3 -1
225 3 -1
184 3 1
214 3 2
155 3 NULL
125 4 -3
134 4 1
244 4 NULL
202 NULL -1
102 NULL 1
119 NULL 3
NULL NULL NULL

statement query III
select c as col1,
       abs(b-c) as col2,
       c-d as col3
from t1
order by col3,col2,col1;

----
161 1 -3
125 4 -3
106 1 -2
231 1 -2
215 3 -2
113 1 -1
247 2 -1
195 3 -1
225 3 -1
202 NULL -1
123 1 1
137 2 1
141 2 1
172 2 1
208 2 1
184 3 1
134 4 1
102 NULL 1
187 1 2
224 1 2
214 3 2
193 1 3
119 NULL 3
150 1 NULL
166 1 NULL
176 1 NULL
147 2 NULL
155 3 NULL
244 4 NULL
NULL NULL NULL

statement query IIIF
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3,
       (a+b+c+d+e)/5 as col4
from t1
where c>d
order by col4,col2,col3,col1;

----
4 1325 391 132.0
2 1371 416 137.0
2 1411 428 142.0
2 1714 514 172.0
3 1828 544 182.0
1 1861 560 187.0
1 1918 579 192.0
3 2125 635 212.0
1 2226 666 222.0
1 1226 369 NULL
2 NULL NULL NULL
NULL NULL NULL NULL
NULL NULL NULL NULL

statement query IIIT
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2 as col3,
       (a+b+c+d+e)/5 as col4
from t1
where c>d
order by col2,col1,col4,col3;

----
1 1226 369 NULL
4 1325 391 132.0
2 1371 416 137.0
2 1411 428 142.0
2 1714 514 172.0
3 1828 544 182.0
1 1861 560 187.0
1 1918 579 192.0
3 2125 635 212.0
1 2226 666 222.0
2 NULL NULL NULL
NULL NULL NULL NULL
NULL NULL NULL NULL

statement query IIT
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       (a+b+c+d+e)/5 as col3
from t1
order by col2,col3,col1;

----
0 104 NULL
0 107 107.0
0 115 NULL
0 121 NULL
0 127 127.0
0 131 132.0
0 138 137.0
0 142 142.0
0 149 NULL
0 153 NULL
0 159 NULL
0 163 162.0
0 168 NULL
0 174 172.0
0 179 NULL
0 182 182.0
0 188 187.0
0 191 192.0
0 199 197.0
0 201 NULL
0 213 212.0
0 216 217.0
0 220 222.0
0 229 227.0
0 234 232.0
0 239 NULL
0 243 NULL
0 245 247.0
0 NULL NULL
0 NULL NULL

statement query IIF
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       (a+b+c+d+e)/5 as col3
from t1
order by col3,col1,col2;

----
0 107 107.0
0 127 127.0
0 131 132.0
0 138 137.0
0 142 142.0
0 163 162.0
0 174 172.0
0 182 182.0
0 188 187.0
0 191 192.0
0 199 197.0
0 213 212.0
0 216 217.0
0 220 222.0
0 229 227.0
0 234 232.0
0 245 247.0
0 104 NULL
0 115 NULL
0 121 NULL
0 149 NULL
0 153 NULL
0 159 NULL
0 168 NULL
0 179 NULL
0 201 NULL
0 239 NULL
0 243 NULL
0 NULL NULL
0 NULL NULL

statement query I
select c as col1
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col1;

----
184
195
225

statement query I
select c as col1
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col1;

----
184
195
225

statement query I
select c as col1
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col1;

----
184
195
225

statement query I
select c as col1
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col1;

----
184
195
225

statement query IIII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col4,col2,col3,col1;

----
1096 14 1 333
1180 17 -1 555
1360 22 -1 555

statement query IIII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col4,col2,col1,col3;

----
1096 14 1 333
1180 17 -1 555
1360 22 -1 555

statement query IIII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
1096 14 1 333
1180 17 -1 555
1360 22 -1 555

statement query IIII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       c-d as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col1,col3,col4,col2;

----
1096 14 1 333
1180 17 -1 555
1360 22 -1 555

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where d not between 110 and 150
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
187 376 0 -4 188
193 382 0 -2 191
215 432 0 -2 216
224 440 0 1 220
161 1600 0 2 163
214 426 0 2 213
231 468 0 3 234

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where d not between 110 and 150
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
order by col3,col4,col1,col5,col2;

----
187 376 0 -4 188
193 382 0 -2 191
215 432 0 -2 216
224 440 0 1 220
161 1600 0 2 163
214 426 0 2 213
231 468 0 3 234

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
187 376 0 -4 188
193 382 0 -2 191
215 432 0 -2 216
224 440 0 1 220
161 1600 0 2 163
214 426 0 2 213
231 468 0 3 234

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col4,col1,col3,col2,col5;

----
187 376 0 -4 188
193 382 0 -2 191
215 432 0 -2 216
224 440 0 1 220
161 1600 0 2 163
214 426 0 2 213
231 468 0 3 234

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d not between 110 and 150
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
187 376 0 -4 188
193 382 0 -2 191
215 432 0 -2 216
224 440 0 1 220
161 1600 0 2 163
214 426 0 2 213
231 468 0 3 234

statement query IIIII
select c as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       a as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d not between 110 and 150
   and (c<=d-2 or c>=d+2)
order by col2,col5,col4,col3,col1;

----
187 376 0 -4 188
193 382 0 -2 191
214 426 0 2 213
215 432 0 -2 216
224 440 0 1 220
231 468 0 3 234
161 1600 0 2 163

statement query IIIII
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       d-e as col3,
       b-c as col4,
       a as col5
from t1
order by col4,col5,col2,col3,col1;

----
793 444 1 -4 131
1455 222 NULL -4 243
1096 333 3 -3 182
1277 222 2 -3 213
880 555 NULL -2 149
1030 555 -2 -2 174
NULL 555 NULL -2 NULL
635 333 -1 -1 107
966 333 2 -1 163
1057 555 NULL -1 179
1121 444 -4 -1 188
1338 444 1 -1 220
NULL 555 4 -1 NULL
738 333 NULL 1 121
905 555 NULL 1 153
1000 555 NULL 1 168
1158 444 -2 1 191
1391 555 3 1 234
827 111 1 2 138
851 111 -4 2 142
1484 444 2 2 245
940 555 NULL 3 159
1180 555 -1 3 199
1297 333 -2 3 216
1360 555 -1 3 229
760 333 2 4 127
NULL 555 NULL NULL 104
NULL 333 -1 NULL 115
NULL 222 -1 NULL 201
NULL 555 1 NULL 239

statement query IIIII
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       d-e as col3,
       b-c as col4,
       a as col5
from t1
order by col1,col2,col4,col3,col5;

----
635 333 -1 -1 107
738 333 NULL 1 121
760 333 2 4 127
793 444 1 -4 131
827 111 1 2 138
851 111 -4 2 142
880 555 NULL -2 149
905 555 NULL 1 153
940 555 NULL 3 159
966 333 2 -1 163
1000 555 NULL 1 168
1030 555 -2 -2 174
1057 555 NULL -1 179
1096 333 3 -3 182
1121 444 -4 -1 188
1158 444 -2 1 191
1180 555 -1 3 199
1277 222 2 -3 213
1297 333 -2 3 216
1338 444 1 -1 220
1360 555 -1 3 229
1391 555 3 1 234
1455 222 NULL -4 243
1484 444 2 2 245
NULL 222 -1 NULL 201
NULL 333 -1 NULL 115
NULL 555 NULL -2 NULL
NULL 555 4 -1 NULL
NULL 555 1 NULL 239
NULL 555 NULL NULL 104

statement query III
select e as col1,
       d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (e>a and e<b)
order by col2,col3,col1;

----
192 190 0
221 222 0
246 248 0

statement query III
select e as col1,
       d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3
from t1
where (e>a and e<b)
order by col1,col2,col3;

----
192 190 0
221 222 0
246 248 0

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2 as col5,
       c as col6
from t1
where (c<=d-2 or c>=d+2)
order by col6,col4,col5,col2,col3,col1;

----
1612 107 333 0 317 106
NULL 115 333 0 NULL 119
1902 127 333 3 385 125
2432 163 333 10 483 161
2806 188 444 15 560 187
2878 191 444 16 579 193
3175 213 222 19 635 214
3260 216 333 20 652 215
3331 220 444 21 666 224
3473 234 555 23 698 231

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2 as col5,
       c as col6
from t1
where (c<=d-2 or c>=d+2)
order by col6,col2,col1,col4,col5,col3;

----
1612 107 333 0 317 106
NULL 115 333 0 NULL 119
1902 127 333 3 385 125
2432 163 333 10 483 161
2806 188 444 15 560 187
2878 191 444 16 579 193
3175 213 222 19 635 214
3260 216 333 20 652 215
3331 220 444 21 666 224
3473 234 555 23 698 231

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where d>e
    or e+d between a+b-10 and c+130
    or a>b
order by col2,col3,col1;

----
444 -4 245
444 -3 220
333 -2 127
111 -1 138
444 1 131
555 1 159
555 1 168
333 1 182
555 1 199
555 1 229
333 2 107
555 2 153
444 2 188
222 2 213
555 2 234
333 3 163
555 3 239
222 3 243
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where d>e
    or e+d between a+b-10 and c+130
    or a>b
order by col2,col3,col1;

----
444 -4 245
444 -3 220
333 -2 127
111 -1 138
444 1 131
555 1 159
555 1 168
333 1 182
555 1 199
555 1 229
333 2 107
555 2 153
444 2 188
222 2 213
555 2 234
333 3 163
555 3 239
222 3 243
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where e+d between a+b-10 and c+130
    or d>e
    or a>b
order by col2,col3,col1;

----
444 -4 245
444 -3 220
333 -2 127
111 -1 138
444 1 131
555 1 159
555 1 168
333 1 182
555 1 199
555 1 229
333 2 107
555 2 153
444 2 188
222 2 213
555 2 234
333 3 163
555 3 239
222 3 243
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where e+d between a+b-10 and c+130
    or d>e
    or a>b
order by col1,col2,col3;

----
111 -1 138
222 2 213
222 3 243
333 -2 127
333 1 182
333 2 107
333 3 163
444 -4 245
444 -3 220
444 1 131
444 2 188
555 1 159
555 1 168
555 1 199
555 1 229
555 2 153
555 2 234
555 3 239
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where e+d between a+b-10 and c+130
    or a>b
    or d>e
order by col2,col3,col1;

----
444 -4 245
444 -3 220
333 -2 127
111 -1 138
444 1 131
555 1 159
555 1 168
333 1 182
555 1 199
555 1 229
333 2 107
555 2 153
444 2 188
222 2 213
555 2 234
333 3 163
555 3 239
222 3 243
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a as col3
from t1
where e+d between a+b-10 and c+130
    or a>b
    or d>e
order by col2,col3,col1;

----
444 -4 245
444 -3 220
333 -2 127
111 -1 138
444 1 131
555 1 159
555 1 168
333 1 182
555 1 199
555 1 229
333 2 107
555 2 153
444 2 188
222 2 213
555 2 234
333 3 163
555 3 239
222 3 243
555 4 149
555 4 174
555 4 179
555 NULL NULL

statement query III
select a+b*2+c*3 as col1,
       b-c as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where (c<=d-2 or c>=d+2)
order by col2,col3,col1;

----
1277 -3 3175
635 -1 1612
966 -1 2432
1121 -1 2806
1338 -1 3331
1158 1 2878
1391 1 3473
1297 3 3260
760 4 1902
NULL NULL NULL

statement query III
select a+b*2+c*3 as col1,
       b-c as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where (c<=d-2 or c>=d+2)
order by col1,col2,col3;

----
635 -1 1612
760 4 1902
966 -1 2432
1121 -1 2806
1158 1 2878
1277 -3 3175
1297 3 3260
1338 -1 3331
1391 1 3473
NULL NULL NULL

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       e as col3,
       a+b*2 as col4,
       b-c as col5
from t1
order by col4,col5,col2,col3,col1;

----
333 0 109 317 -1
333 0 NULL 369 1
333 0 126 385 4
444 0 132 391 -4
111 0 135 416 2
111 0 144 428 2
555 0 146 439 -2
555 0 NULL 455 1
555 0 157 475 3
333 0 162 483 -1
555 0 165 502 1
555 0 173 514 -2
555 0 177 529 -1
333 0 180 544 -3
444 0 189 560 -1
444 0 192 579 1
555 0 197 595 3
222 0 210 635 -3
333 0 219 652 3
444 0 221 666 -1
555 0 227 685 3
555 0 230 698 1
555 0 237 711 NULL
222 0 NULL 723 -4
444 0 246 743 2
555 0 NULL NULL -2
555 0 110 NULL -1
333 0 117 NULL NULL
222 0 204 NULL NULL
555 0 NULL NULL NULL

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       e as col3,
       a+b*2 as col4,
       b-c as col5
from t1
order by col3,col1,col4,col5,col2;

----
333 0 109 317 -1
555 0 110 NULL -1
333 0 117 NULL NULL
333 0 126 385 4
444 0 132 391 -4
111 0 135 416 2
111 0 144 428 2
555 0 146 439 -2
555 0 157 475 3
333 0 162 483 -1
555 0 165 502 1
555 0 173 514 -2
555 0 177 529 -1
333 0 180 544 -3
444 0 189 560 -1
444 0 192 579 1
555 0 197 595 3
222 0 204 NULL NULL
222 0 210 635 -3
333 0 219 652 3
444 0 221 666 -1
555 0 227 685 3
555 0 230 698 1
555 0 237 711 NULL
444 0 246 743 2
222 0 NULL 723 -4
333 0 NULL 369 1
555 0 NULL 455 1
555 0 NULL NULL -2
555 0 NULL NULL NULL

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where d>e
   and b>c
   and (a>b-2 and a<b+2)
order by col2,col1;

----
137.0 2

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where d>e
   and b>c
   and (a>b-2 and a<b+2)
order by col2,col1;

----
137.0 2

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
   and d>e
order by col2,col1;

----
137.0 2

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where (a>b-2 and a<b+2)
   and b>c
   and d>e
order by col1,col2;

----
137.0 2

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and b>c
order by col2,col1;

----
137.0 2

statement query FI
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and b>c
order by col1,col2;

----
137.0 2

statement query IIFI
select abs(a) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       a-b as col4
from t1
where e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----
127 1902 127.0 -2
107 1612 107.0 2

statement query IIFI
select abs(a) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       a-b as col4
from t1
where e+d between a+b-10 and c+130
order by col2,col4,col3,col1;

----
107 1612 107.0 2
127 1902 127.0 -2

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and (e>c or e<d)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and (e>c or e<d)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
   and d>e
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
   and d>e
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where d>e
   and (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where d>e
   and (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query I
select d as col1
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
order by col1;

----
114
128
133
136
164
183
212
222
233
238
248

statement query IIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col4,col2,col3,col1;

----
1300 1325 1 -4
364 1828 1 -3
426 2125 2 -3
1700 1714 4 -2
1050 1067 2 -1
1600 1622 3 -1
376 1861 2 -1
440 2226 -3 -1
358 NULL 4 -1
1120 NULL NULL -1
468 2323 2 1
1390 1371 -1 2
1430 1411 -1 2
490 2476 -4 2
398 1964 1 3
432 2165 -2 3
458 2264 1 3
1580 NULL 1 3
1290 1272 -2 4
2360 NULL 3 NULL
402 NULL NULL NULL

statement query ITII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col1,col4,col2,col3;

----
358 NULL 4 -1
364 1828 1 -3
376 1861 2 -1
398 1964 1 3
402 NULL NULL NULL
426 2125 2 -3
432 2165 -2 3
440 2226 -3 -1
458 2264 1 3
468 2323 2 1
490 2476 -4 2
1050 1067 2 -1
1120 NULL NULL -1
1290 1272 -2 4
1300 1325 1 -4
1390 1371 -1 2
1430 1411 -1 2
1580 NULL 1 3
1600 1622 3 -1
1700 1714 4 -2
2360 NULL 3 NULL

statement query IIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----
1300 1325 1 -4
364 1828 1 -3
426 2125 2 -3
1700 1714 4 -2
1050 1067 2 -1
1600 1622 3 -1
376 1861 2 -1
440 2226 -3 -1
358 NULL 4 -1
1120 NULL NULL -1
468 2323 2 1
1390 1371 -1 2
1430 1411 -1 2
490 2476 -4 2
398 1964 1 3
432 2165 -2 3
458 2264 1 3
1580 NULL 1 3
1290 1272 -2 4
2360 NULL 3 NULL
402 NULL NULL NULL

statement query IIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col3,col4,col2,col1;

----
490 2476 -4 2
440 2226 -3 -1
432 2165 -2 3
1290 1272 -2 4
1390 1371 -1 2
1430 1411 -1 2
1300 1325 1 -4
364 1828 1 -3
398 1964 1 3
458 2264 1 3
1580 NULL 1 3
426 2125 2 -3
1050 1067 2 -1
376 1861 2 -1
468 2323 2 1
1600 1622 3 -1
2360 NULL 3 NULL
1700 1714 4 -2
358 NULL 4 -1
1120 NULL NULL -1
402 NULL NULL NULL

statement query II
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4 as col2
from t1
where b>c
   and a>b
order by col2,col1;

----
1180 1964
1360 2264
1391 2323
905 NULL
940 NULL
1000 NULL

statement query IT
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4 as col2
from t1
where b>c
   and a>b
order by col1,col2;

----
905 NULL
940 NULL
1000 NULL
1180 1964
1360 2264
1391 2323

statement query II
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4 as col2
from t1
where a>b
   and b>c
order by col2,col1;

----
1180 1964
1360 2264
1391 2323
905 NULL
940 NULL
1000 NULL

statement query II
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4 as col2
from t1
where a>b
   and b>c
order by col2,col1;

----
1180 1964
1360 2264
1391 2323
905 NULL
940 NULL
1000 NULL

statement query II
select d as col1,
       abs(b-c) as col2
from t1
order by col2,col1;

----
108 1
114 1
122 1
164 1
185 1
190 1
222 1
233 1
NULL 1
NULL 1
NULL 1
136 2
140 2
171 2
207 2
248 2
NULL 2
183 3
196 3
212 3
217 3
226 3
NULL 3
128 4
133 4
NULL 4
101 NULL
116 NULL
203 NULL
238 NULL

statement query II
select d as col1,
       abs(b-c) as col2
from t1
order by col2,col1;

----
108 1
114 1
122 1
164 1
185 1
190 1
222 1
233 1
NULL 1
NULL 1
NULL 1
136 2
140 2
171 2
207 2
248 2
NULL 2
183 3
196 3
212 3
217 3
226 3
NULL 3
128 4
133 4
NULL 4
101 NULL
116 NULL
203 NULL
238 NULL

statement query IIIIIII
select abs(b-c) as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5,
       a-b as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1;

----
2 -1 3706 490 2 -4 246
1 2 3331 440 -1 -3 221
1 1 NULL 1240 1 -3 NULL
2 1 2046 1390 2 -1 135
2 1 2131 1430 2 -1 144
4 1 1985 1300 -4 1 132
3 1 2728 364 -3 1 180
1 -2 1612 1050 -1 2 109
1 2 2806 376 -1 2 189
3 2 3175 426 -3 2 210
1 -2 3473 468 1 2 230
1 -3 2432 1600 -1 3 162
2 1 2579 1700 -2 4 173
1 -1 NULL 1120 -1 NULL 110
2 1 NULL NULL -2 NULL NULL

statement query IIIIIII
select abs(b-c) as col1,
       c-d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5,
       a-b as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col7,col6,col5,col3,col4,col2,col1;

----
1 -2 1612 1050 -1 2 109
1 -1 NULL 1120 -1 NULL 110
4 1 1985 1300 -4 1 132
2 1 2046 1390 2 -1 135
2 1 2131 1430 2 -1 144
1 -3 2432 1600 -1 3 162
2 1 2579 1700 -2 4 173
3 1 2728 364 -3 1 180
1 2 2806 376 -1 2 189
3 2 3175 426 -3 2 210
1 2 3331 440 -1 -3 221
1 -2 3473 468 1 2 230
2 -1 3706 490 2 -4 246
1 1 NULL 1240 1 -3 NULL
2 1 NULL NULL -2 NULL NULL

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a as col3,
       d-e as col4,
       a+b*2+c*3 as col5
from t1
where (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
2 6 142 -4 851
3 17 199 -1 1180
3 22 229 -1 1360
-4 4 131 1 793
2 5 138 1 827
-3 14 182 3 1096
3 9 159 NULL 940
1 11 168 NULL 1000

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a as col3,
       d-e as col4,
       a+b*2+c*3 as col5
from t1
where (a>b-2 and a<b+2)
order by col3,col5,col2,col4,col1;

----
-4 4 131 1 793
2 5 138 1 827
2 6 142 -4 851
3 9 159 NULL 940
1 11 168 NULL 1000
-3 14 182 3 1096
3 17 199 -1 1180
3 22 229 -1 1360

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where d not between 110 and 150
   and a>b
   and c>d
order by col1;

----
222
333
444
555

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where d not between 110 and 150
   and a>b
   and c>d
order by col1;

----
222
333
444
555

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where a>b
   and d not between 110 and 150
   and c>d
order by col1;

----
222
333
444
555

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where a>b
   and d not between 110 and 150
   and c>d
order by col1;

----
222
333
444
555

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where c>d
   and d not between 110 and 150
   and a>b
order by col1;

----
222
333
444
555

statement query I
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1
from t1
where c>d
   and d not between 110 and 150
   and a>b
order by col1;

----
222
333
444
555

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
    or c>d
order by col6,col4,col5,col2,col3,col1;

----
4 1 333 1300 133 -4
14 1 333 364 183 -3
19 2 333 426 212 -3
12 4 444 1700 171 -2
18 NULL 444 NULL 207 -2
15 2 333 376 185 -1
21 -3 222 440 222 -1
0 2 333 1050 108 -1
10 3 444 1600 164 -1
16 -3 222 382 190 1
23 2 333 468 233 1
2 -3 222 1240 122 1
11 1 333 1670 NULL 1
5 -1 222 1390 136 2
6 -1 222 1430 140 2
17 1 333 398 196 3
20 -2 222 432 217 3
22 1 333 458 226 3
9 1 333 1580 NULL 3
3 -2 222 1290 128 4
0 NULL 444 NULL 101 NULL
0 NULL 444 NULL 116 NULL

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
    or c>d
order by col3,col6,col5,col1,col4,col2;

----
21 -3 222 440 222 -1
2 -3 222 1240 122 1
16 -3 222 382 190 1
5 -1 222 1390 136 2
6 -1 222 1430 140 2
20 -2 222 432 217 3
3 -2 222 1290 128 4
4 1 333 1300 133 -4
14 1 333 364 183 -3
19 2 333 426 212 -3
0 2 333 1050 108 -1
15 2 333 376 185 -1
23 2 333 468 233 1
11 1 333 1670 NULL 1
17 1 333 398 196 3
22 1 333 458 226 3
9 1 333 1580 NULL 3
12 4 444 1700 171 -2
18 NULL 444 NULL 207 -2
10 3 444 1600 164 -1
0 NULL 444 NULL 101 NULL
0 NULL 444 NULL 116 NULL

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where c>d
    or (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
order by col6,col4,col5,col2,col3,col1;

----
4 1 333 1300 133 -4
14 1 333 364 183 -3
19 2 333 426 212 -3
12 4 444 1700 171 -2
18 NULL 444 NULL 207 -2
15 2 333 376 185 -1
21 -3 222 440 222 -1
0 2 333 1050 108 -1
10 3 444 1600 164 -1
16 -3 222 382 190 1
23 2 333 468 233 1
2 -3 222 1240 122 1
11 1 333 1670 NULL 1
5 -1 222 1390 136 2
6 -1 222 1430 140 2
17 1 333 398 196 3
20 -2 222 432 217 3
22 1 333 458 226 3
9 1 333 1580 NULL 3
3 -2 222 1290 128 4
0 NULL 444 NULL 101 NULL
0 NULL 444 NULL 116 NULL

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where c>d
    or (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
order by col1,col3,col4,col6,col5,col2;

----
0 2 333 1050 108 -1
0 NULL 444 NULL 101 NULL
0 NULL 444 NULL 116 NULL
2 -3 222 1240 122 1
3 -2 222 1290 128 4
4 1 333 1300 133 -4
5 -1 222 1390 136 2
6 -1 222 1430 140 2
9 1 333 1580 NULL 3
10 3 444 1600 164 -1
11 1 333 1670 NULL 1
12 4 444 1700 171 -2
14 1 333 364 183 -3
15 2 333 376 185 -1
16 -3 222 382 190 1
17 1 333 398 196 3
18 NULL 444 NULL 207 -2
19 2 333 426 212 -3
20 -2 222 432 217 3
21 -3 222 440 222 -1
22 1 333 458 226 3
23 2 333 468 233 1

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where (c<=d-2 or c>=d+2)
    or (a>b-2 and a<b+2)
    or c>d
order by col6,col4,col5,col2,col3,col1;

----
4 1 333 1300 133 -4
14 1 333 364 183 -3
19 2 333 426 212 -3
12 4 444 1700 171 -2
18 NULL 444 NULL 207 -2
15 2 333 376 185 -1
21 -3 222 440 222 -1
0 2 333 1050 108 -1
10 3 444 1600 164 -1
16 -3 222 382 190 1
23 2 333 468 233 1
2 -3 222 1240 122 1
11 1 333 1670 NULL 1
5 -1 222 1390 136 2
6 -1 222 1430 140 2
17 1 333 398 196 3
20 -2 222 432 217 3
22 1 333 458 226 3
9 1 333 1580 NULL 3
3 -2 222 1290 128 4
0 NULL 444 NULL 101 NULL
0 NULL 444 NULL 116 NULL

statement query ITITIT
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a-b as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col4,
       d as col5,
       b-c as col6
from t1
where (c<=d-2 or c>=d+2)
    or (a>b-2 and a<b+2)
    or c>d
order by col5,col1,col6,col4,col2,col3;

----
0 NULL 444 NULL 101 NULL
0 2 333 1050 108 -1
0 NULL 444 NULL 116 NULL
2 -3 222 1240 122 1
3 -2 222 1290 128 4
4 1 333 1300 133 -4
5 -1 222 1390 136 2
6 -1 222 1430 140 2
10 3 444 1600 164 -1
12 4 444 1700 171 -2
14 1 333 364 183 -3
15 2 333 376 185 -1
16 -3 222 382 190 1
17 1 333 398 196 3
18 NULL 444 NULL 207 -2
19 2 333 426 212 -3
20 -2 222 432 217 3
21 -3 222 440 222 -1
22 1 333 458 226 3
23 2 333 468 233 1
9 1 333 1580 NULL 3
11 1 333 1670 NULL 1

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       d-e as col2,
       a+b*2 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
order by col4,col2,col3,col1;

----
444 2 743 111
111 -4 428 222
444 -2 579 222
333 -2 652 222
111 1 416 222
444 1 666 222
333 2 385 222
333 NULL 369 222
444 -4 560 333
333 -1 317 333
555 -1 595 333
555 -1 685 333
444 1 391 333
222 2 635 333
333 3 544 333
555 3 698 333
555 NULL 455 333
555 NULL 475 333
555 NULL 502 333
555 -2 514 444
222 -1 NULL 444
333 -1 NULL 444
555 1 711 444
333 2 483 444
555 4 NULL 444
555 NULL 439 444
555 NULL 529 444
222 NULL 723 444
555 NULL NULL 444
555 NULL NULL 444

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       d-e as col2,
       a+b*2 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
order by col2,col4,col1,col3;

----
111 -4 428 222
444 -4 560 333
333 -2 652 222
444 -2 579 222
555 -2 514 444
333 -1 317 333
555 -1 595 333
555 -1 685 333
222 -1 NULL 444
333 -1 NULL 444
111 1 416 222
444 1 666 222
444 1 391 333
555 1 711 444
444 2 743 111
333 2 385 222
222 2 635 333
333 2 483 444
333 3 544 333
555 3 698 333
555 4 NULL 444
333 NULL 369 222
555 NULL 455 333
555 NULL 475 333
555 NULL 502 333
222 NULL 723 444
555 NULL 439 444
555 NULL 529 444
555 NULL NULL 444
555 NULL NULL 444

statement query II
select b-c as col1,
       a+b*2+c*3 as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
-1 635
4 760
-1 966
-1 1121
1 1158
-3 1277
3 1297
-1 1338
1 1391
NULL NULL

statement query II
select b-c as col1,
       a+b*2+c*3 as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
-1 635
4 760
-1 966
-1 1121
1 1158
-3 1277
3 1297
-1 1338
1 1391
NULL NULL

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col6,col4,col5,col2,col3,col1;

----
1902 127 4 -2 333 -3
2432 163 1 3 333 -3
1612 107 1 2 333 -2
3473 234 1 2 555 -2
3706 245 2 -4 444 -1
NULL NULL 1 NULL 555 -1
2046 138 2 -1 111 1
2728 182 3 1 333 1
1985 131 4 1 444 1
3331 220 1 -3 444 2
3175 213 3 2 222 2
NULL 239 NULL 3 555 NULL

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
order by col5,col2,col1,col3,col6,col4;

----
2046 138 2 -1 111 1
3175 213 3 2 222 2
1612 107 1 2 333 -2
1902 127 4 -2 333 -3
2432 163 1 3 333 -3
2728 182 3 1 333 1
1985 131 4 1 444 1
3331 220 1 -3 444 2
3706 245 2 -4 444 -1
3473 234 1 2 555 -2
NULL 239 NULL 3 555 NULL
NULL NULL 1 NULL 555 -1

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
1902 127 4 -2 333 -3
2432 163 1 3 333 -3
1612 107 1 2 333 -2
3473 234 1 2 555 -2
3706 245 2 -4 444 -1
NULL NULL 1 NULL 555 -1
2046 138 2 -1 111 1
2728 182 3 1 333 1
1985 131 4 1 444 1
3331 220 1 -3 444 2
3175 213 3 2 222 2
NULL 239 NULL 3 555 NULL

statement query IIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       abs(a) as col2,
       abs(b-c) as col3,
       a-b as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6
from t1
where d>e
    or e+d between a+b-10 and c+130
order by col1,col4,col3,col6,col5,col2;

----
1612 107 1 2 333 -2
1902 127 4 -2 333 -3
1985 131 4 1 444 1
2046 138 2 -1 111 1
2432 163 1 3 333 -3
2728 182 3 1 333 1
3175 213 3 2 222 2
3331 220 1 -3 444 2
3473 234 1 2 555 -2
3706 245 2 -4 444 -1
NULL 239 NULL 3 555 NULL
NULL NULL 1 NULL 555 -1

statement query III
select a as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3
from t1
where e+d between a+b-10 and c+130
order by col2,col3,col1;

----
107 635 107
127 760 127

statement query III
select a as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3
from t1
where e+d between a+b-10 and c+130
order by col3,col1,col2;

----
107 635 107
127 760 127

statement query IITIII
select a+b*2+c*3+d*4 as col1,
       a as col2,
       e as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3 as col6
from t1
where b>c
    or d>e
order by col6,col4,col5,col2,col3,col1;

----
1226 121 NULL 222 2 738
1272 127 126 222 3 760
1325 131 132 333 4 793
1371 138 135 222 5 827
1411 142 144 222 6 851
NULL 153 NULL 333 8 905
NULL 159 157 333 9 940
1622 163 162 444 10 966
NULL 168 165 333 11 1000
1828 182 180 333 14 1096
1918 191 192 222 16 1158
1964 199 197 333 17 1180
2125 213 210 333 19 1277
2165 216 219 222 20 1297
2226 220 221 222 21 1338
2264 229 227 333 22 1360
2323 234 230 333 23 1391
2476 245 246 111 26 1484
NULL NULL 110 444 1 NULL
NULL 239 237 444 24 NULL

statement query IITIII
select a+b*2+c*3+d*4 as col1,
       a as col2,
       e as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3 as col6
from t1
where b>c
    or d>e
order by col2,col1,col3,col5,col6,col4;

----
1226 121 NULL 222 2 738
1272 127 126 222 3 760
1325 131 132 333 4 793
1371 138 135 222 5 827
1411 142 144 222 6 851
NULL 153 NULL 333 8 905
NULL 159 157 333 9 940
1622 163 162 444 10 966
NULL 168 165 333 11 1000
1828 182 180 333 14 1096
1918 191 192 222 16 1158
1964 199 197 333 17 1180
2125 213 210 333 19 1277
2165 216 219 222 20 1297
2226 220 221 222 21 1338
2264 229 227 333 22 1360
2323 234 230 333 23 1391
NULL 239 237 444 24 NULL
2476 245 246 111 26 1484
NULL NULL 110 444 1 NULL

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       e as col2,
       abs(a) as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col3,col1;

----
1050 109 107
1120 110 NULL
NULL 117 115
1290 126 127
1300 132 131
1390 135 138
1430 144 142
1450 146 149
1580 157 159
1600 162 163
1670 165 168
1700 173 174
358 177 179
364 180 182
376 189 188
382 192 191
398 197 199
402 204 201
426 210 213
432 219 216
440 221 220
458 227 229
468 230 234
2360 237 239
490 246 245
NULL NULL 104
1240 NULL 121
1510 NULL 153
486 NULL 243
NULL NULL NULL

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       e as col2,
       abs(a) as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1,col3;

----
1050 109 107
1120 110 NULL
NULL 117 115
1290 126 127
1300 132 131
1390 135 138
1430 144 142
1450 146 149
1580 157 159
1600 162 163
1670 165 168
1700 173 174
358 177 179
364 180 182
376 189 188
382 192 191
398 197 199
402 204 201
426 210 213
432 219 216
440 221 220
458 227 229
468 230 234
2360 237 239
490 246 245
486 NULL 243
1240 NULL 121
1510 NULL 153
NULL NULL 104
NULL NULL NULL

statement query I
select (select count(*) from t1 as x where x.b<t1.b) as col1
from t1
where (a>b-2 and a<b+2)
order by col1;

----
4
5
6
9
11
14
17
22

statement query I
select (select count(*) from t1 as x where x.b<t1.b) as col1
from t1
where (a>b-2 and a<b+2)
order by col1;

----
4
5
6
9
11
14
17
22

statement query IIIIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
106 1050 2 1067 333 108
113 1120 NULL NULL 444 114
123 1240 -3 1226 222 122
134 1300 1 1325 333 133
137 1390 -1 1371 222 136
141 1430 -1 1411 222 140
161 1600 3 1622 444 164
172 1700 4 1714 444 171
184 364 1 1828 333 183
187 376 2 1861 333 185
208 NULL NULL NULL 444 207
214 426 2 2125 333 212
224 440 -3 2226 222 222
231 468 2 2323 333 233
247 490 -4 2476 111 248

statement query IIIIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col5,col2,col3,col6,col4,col1;

----
247 490 -4 2476 111 248
224 440 -3 2226 222 222
123 1240 -3 1226 222 122
137 1390 -1 1371 222 136
141 1430 -1 1411 222 140
184 364 1 1828 333 183
187 376 2 1861 333 185
214 426 2 2125 333 212
231 468 2 2323 333 233
106 1050 2 1067 333 108
134 1300 1 1325 333 133
113 1120 NULL NULL 444 114
161 1600 3 1622 444 164
172 1700 4 1714 444 171
208 NULL NULL NULL 444 207

statement query IIIIF
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4 as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col5,col2,col3,col1;

----
-1 0 107 1067 107.0
1 2 121 1226 NULL
4 3 127 1272 127.0
-4 4 131 1325 132.0
2 5 138 1371 137.0
2 6 142 1411 142.0
-1 10 163 1622 162.0
-2 12 174 1714 172.0
-3 14 182 1828 182.0
-1 15 188 1861 187.0
1 16 191 1918 192.0
3 17 199 1964 197.0
-3 19 213 2125 212.0
3 20 216 2165 217.0
-1 21 220 2226 222.0
3 22 229 2264 227.0
1 23 234 2323 232.0
2 26 245 2476 247.0
NULL 0 104 NULL NULL
NULL 0 115 NULL NULL
NULL 0 201 NULL NULL
-1 1 NULL NULL NULL
-2 7 149 NULL NULL
1 8 153 NULL NULL
3 9 159 NULL NULL
1 11 168 NULL NULL
-1 13 179 NULL NULL
-2 18 NULL NULL NULL
NULL 24 239 NULL NULL
-4 25 243 NULL NULL

statement query IIIIF
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4 as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col1,col5,col2,col3;

----
-1 0 107 1067 107.0
1 2 121 1226 NULL
4 3 127 1272 127.0
-4 4 131 1325 132.0
2 5 138 1371 137.0
2 6 142 1411 142.0
-1 10 163 1622 162.0
-2 12 174 1714 172.0
-3 14 182 1828 182.0
-1 15 188 1861 187.0
1 16 191 1918 192.0
3 17 199 1964 197.0
-3 19 213 2125 212.0
3 20 216 2165 217.0
-1 21 220 2226 222.0
3 22 229 2264 227.0
1 23 234 2323 232.0
2 26 245 2476 247.0
-4 25 243 NULL NULL
-2 7 149 NULL NULL
-2 18 NULL NULL NULL
-1 1 NULL NULL NULL
-1 13 179 NULL NULL
1 8 153 NULL NULL
1 11 168 NULL NULL
3 9 159 NULL NULL
NULL 0 104 NULL NULL
NULL 0 115 NULL NULL
NULL 0 201 NULL NULL
NULL 24 239 NULL NULL

statement query IIIII
select a+b*2+c*3+d*4 as col1,
       e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a-b as col4,
       d as col5
from t1
where (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
2476 246 111 -4 248
1226 NULL 222 -3 122
1918 192 222 -3 190
2226 221 222 -3 222
1272 126 222 -2 128
2165 219 222 -2 217
1371 135 222 -1 136
1411 144 222 -1 140
1325 132 333 1 133
1828 180 333 1 183
1964 197 333 1 196
2264 227 333 1 226
NULL 157 333 1 NULL
NULL 165 333 1 NULL
1861 189 333 2 185
2125 210 333 2 212
2323 230 333 2 233
NULL NULL 333 2 NULL
1622 162 444 3 164
NULL 237 444 3 238
NULL NULL 444 3 NULL
1714 173 444 4 171
NULL 146 444 4 NULL
NULL 177 444 4 NULL
NULL 110 444 NULL 114
NULL NULL 444 NULL 207

statement query TIITI
select a+b*2+c*3+d*4 as col1,
       e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a-b as col4,
       d as col5
from t1
where (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col5,col3,col2,col4,col1;

----
NULL 110 444 NULL 114
1226 NULL 222 -3 122
1272 126 222 -2 128
1325 132 333 1 133
1371 135 222 -1 136
1411 144 222 -1 140
1622 162 444 3 164
1714 173 444 4 171
1828 180 333 1 183
1861 189 333 2 185
1918 192 222 -3 190
1964 197 333 1 196
NULL NULL 444 NULL 207
2125 210 333 2 212
2165 219 222 -2 217
2226 221 222 -3 222
2264 227 333 1 226
2323 230 333 2 233
NULL 237 444 3 238
2476 246 111 -4 248
NULL 157 333 1 NULL
NULL 165 333 1 NULL
NULL NULL 333 2 NULL
NULL 146 444 4 NULL
NULL 177 444 4 NULL
NULL NULL 444 3 NULL

statement query IIIII
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where c between b-2 and d+2
   and b>c
order by col4,col5,col2,col3,col1;

----
138 222 2 0 111
142 222 2 0 111
121 222 1 0 333
245 111 2 0 444
234 333 1 0 555

statement query IIIII
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where c between b-2 and d+2
   and b>c
order by col3,col2,col4,col5,col1;

----
121 222 1 0 333
234 333 1 0 555
245 111 2 0 444
138 222 2 0 111
142 222 2 0 111

statement query IIIII
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where b>c
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
138 222 2 0 111
142 222 2 0 111
121 222 1 0 333
245 111 2 0 444
234 333 1 0 555

statement query IIIII
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where b>c
   and c between b-2 and d+2
order by col3,col1,col2,col5,col4;

----
121 222 1 0 333
234 333 1 0 555
138 222 2 0 111
142 222 2 0 111
245 111 2 0 444

statement query IIIIII
select a+b*2+c*3 as col1,
       abs(a) as col2,
       a+b*2 as col3,
       b as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col4,col5,col2,col3,col1;

----
1057 179 529 175 177 358
1096 182 544 181 180 364
1121 188 560 186 189 376
1158 191 579 194 192 382
1180 199 595 198 197 398
1277 213 635 211 210 426
1297 216 652 218 219 432
1338 220 666 223 221 440
1360 229 685 228 227 458
1391 234 698 232 230 468
1455 243 723 240 NULL 486
1484 245 743 249 246 490
NULL NULL NULL 112 110 1120
738 121 369 124 NULL 1240
760 127 385 129 126 1290
793 131 391 130 132 1300
827 138 416 139 135 1390
851 142 428 143 144 1430
880 149 439 145 146 1450
905 153 455 151 NULL 1510
940 159 475 158 157 1580
966 163 483 160 162 1600
1000 168 502 167 165 1670
1030 174 514 170 173 1700
NULL 239 711 236 237 2360
NULL NULL NULL 206 NULL NULL

statement query IIIITI
select a+b*2+c*3 as col1,
       abs(a) as col2,
       a+b*2 as col3,
       b as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col3,col5,col6,col4,col2;

----
738 121 369 124 NULL 1240
760 127 385 129 126 1290
793 131 391 130 132 1300
827 138 416 139 135 1390
851 142 428 143 144 1430
880 149 439 145 146 1450
905 153 455 151 NULL 1510
940 159 475 158 157 1580
966 163 483 160 162 1600
1000 168 502 167 165 1670
1030 174 514 170 173 1700
1057 179 529 175 177 358
1096 182 544 181 180 364
1121 188 560 186 189 376
1158 191 579 194 192 382
1180 199 595 198 197 398
1277 213 635 211 210 426
1297 216 652 218 219 432
1338 220 666 223 221 440
1360 229 685 228 227 458
1391 234 698 232 230 468
1455 243 723 240 NULL 486
1484 245 743 249 246 490
NULL 239 711 236 237 2360
NULL NULL NULL 112 110 1120
NULL NULL NULL 206 NULL NULL

statement query III
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
order by col2,col3,col1;

----
-3 1272 129
1 1325 130
1 1371 139
1 1411 143
-3 1622 160
1 1714 170
1 1828 181
2 1861 186
-1 1964 198
2 2125 211
-2 2165 218
2 2226 223
-1 2264 228
-2 2323 232
-1 2476 249
-1 NULL 112
NULL NULL 158
NULL NULL 175
NULL NULL 236

statement query III
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
order by col1,col3,col2;

----
-3 1272 129
-3 1622 160
-2 2165 218
-2 2323 232
-1 NULL 112
-1 1964 198
-1 2264 228
-1 2476 249
1 1325 130
1 1371 139
1 1411 143
1 1714 170
1 1828 181
2 1861 186
2 2125 211
2 2226 223
NULL NULL 158
NULL NULL 175
NULL NULL 236

statement query III
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3
from t1
where (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1;

----
-3 1272 129
1 1325 130
1 1371 139
1 1411 143
-3 1622 160
1 1714 170
1 1828 181
2 1861 186
-1 1964 198
2 2125 211
-2 2165 218
2 2226 223
-1 2264 228
-2 2323 232
-1 2476 249
-1 NULL 112
NULL NULL 158
NULL NULL 175
NULL NULL 236

statement query ITI
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3
from t1
where (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col1,col2;

----
-1 NULL 112
-3 1272 129
1 1325 130
1 1371 139
1 1411 143
NULL NULL 158
-3 1622 160
1 1714 170
NULL NULL 175
1 1828 181
2 1861 186
-1 1964 198
2 2125 211
-2 2165 218
2 2226 223
-1 2264 228
-2 2323 232
NULL NULL 236
-1 2476 249

statement query III
select a-b as col1,
       a+b*2 as col2,
       a as col3
from t1
where d>e
    or b>c
order by col2,col3,col1;

----
-3 369 121
-2 385 127
1 391 131
-1 416 138
-1 428 142
2 455 153
1 475 159
3 483 163
1 502 168
1 544 182
-3 579 191
1 595 199
2 635 213
-2 652 216
-3 666 220
1 685 229
2 698 234
3 711 239
-4 743 245
NULL NULL NULL

statement query III
select a-b as col1,
       a+b*2 as col2,
       a as col3
from t1
where d>e
    or b>c
order by col3,col1,col2;

----
-3 369 121
-2 385 127
1 391 131
-1 416 138
-1 428 142
2 455 153
1 475 159
3 483 163
1 502 168
1 544 182
-3 579 191
1 595 199
2 635 213
-2 652 216
-3 666 220
1 685 229
2 698 234
3 711 239
-4 743 245
NULL NULL NULL

statement query III
select a-b as col1,
       a+b*2 as col2,
       a as col3
from t1
where b>c
    or d>e
order by col2,col3,col1;

----
-3 369 121
-2 385 127
1 391 131
-1 416 138
-1 428 142
2 455 153
1 475 159
3 483 163
1 502 168
1 544 182
-3 579 191
1 595 199
2 635 213
-2 652 216
-3 666 220
1 685 229
2 698 234
3 711 239
-4 743 245
NULL NULL NULL

statement query III
select a-b as col1,
       a+b*2 as col2,
       a as col3
from t1
where b>c
    or d>e
order by col2,col3,col1;

----
-3 369 121
-2 385 127
1 391 131
-1 416 138
-1 428 142
2 455 153
1 475 159
3 483 163
1 502 168
1 544 182
-3 579 191
1 595 199
2 635 213
-2 652 216
-3 666 220
1 685 229
2 698 234
3 711 239
-4 743 245
NULL NULL NULL

statement query IIIIIF
select e as col1,
       b as col2,
       a+b*2+c*3 as col3,
       a+b*2 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and c>d
order by col6,col4,col5,col2,col3,col1;

----
132 130 793 391 1300 132.0
135 139 827 416 1390 137.0
144 143 851 428 1430 142.0
173 170 1030 514 1700 172.0
180 181 1096 544 364 182.0
189 186 1121 560 376 187.0
210 211 1277 635 426 212.0
221 223 1338 666 440 222.0
NULL 124 738 369 1240 NULL
NULL 206 NULL NULL NULL NULL

statement query IIIIIF
select e as col1,
       b as col2,
       a+b*2+c*3 as col3,
       a+b*2 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and c>d
order by col5,col4,col3,col6,col2,col1;

----
180 181 1096 544 364 182.0
189 186 1121 560 376 187.0
210 211 1277 635 426 212.0
221 223 1338 666 440 222.0
NULL 124 738 369 1240 NULL
132 130 793 391 1300 132.0
135 139 827 416 1390 137.0
144 143 851 428 1430 142.0
173 170 1030 514 1700 172.0
NULL 206 NULL NULL NULL NULL

statement query IIIIIF
select e as col1,
       b as col2,
       a+b*2+c*3 as col3,
       a+b*2 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
132 130 793 391 1300 132.0
135 139 827 416 1390 137.0
144 143 851 428 1430 142.0
173 170 1030 514 1700 172.0
180 181 1096 544 364 182.0
189 186 1121 560 376 187.0
210 211 1277 635 426 212.0
221 223 1338 666 440 222.0
NULL 124 738 369 1240 NULL
NULL 206 NULL NULL NULL NULL

statement query IIIIIF
select e as col1,
       b as col2,
       a+b*2+c*3 as col3,
       a+b*2 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and c between b-2 and d+2
order by col1,col2,col6,col4,col5,col3;

----
132 130 793 391 1300 132.0
135 139 827 416 1390 137.0
144 143 851 428 1430 142.0
173 170 1030 514 1700 172.0
180 181 1096 544 364 182.0
189 186 1121 560 376 187.0
210 211 1277 635 426 212.0
221 223 1338 666 440 222.0
NULL 124 738 369 1240 NULL
NULL 206 NULL NULL NULL NULL

statement query I
select a as col1
from t1
order by col1;

----
104
107
115
121
127
131
138
142
149
153
159
163
168
174
179
182
188
191
199
201
213
216
220
229
234
239
243
245
NULL
NULL

statement query I
select a as col1
from t1
order by col1;

----
104
107
115
121
127
131
138
142
149
153
159
163
168
174
179
182
188
191
199
201
213
216
220
229
234
239
243
245
NULL
NULL

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(b-c) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1;

----
121 0 1 1226
131 0 4 1325
138 0 2 1371
142 0 2 1411
174 0 2 1714
182 0 3 1828
188 0 1 1861
191 0 1 1918
213 0 3 2125
220 0 1 2226
NULL 0 2 NULL

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(b-c) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1,col4,col3;

----
121 0 1 1226
131 0 4 1325
138 0 2 1371
142 0 2 1411
174 0 2 1714
182 0 3 1828
188 0 1 1861
191 0 1 1918
213 0 3 2125
220 0 1 2226
NULL 0 2 NULL

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(b-c) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
order by col4,col2,col3,col1;

----
121 0 1 1226
131 0 4 1325
138 0 2 1371
142 0 2 1411
174 0 2 1714
182 0 3 1828
188 0 1 1861
191 0 1 1918
213 0 3 2125
220 0 1 2226
NULL 0 2 NULL

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(b-c) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
order by col4,col2,col3,col1;

----
121 0 1 1226
131 0 4 1325
138 0 2 1371
142 0 2 1411
174 0 2 1714
182 0 3 1828
188 0 1 1861
191 0 1 1918
213 0 3 2125
220 0 1 2226
NULL 0 2 NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
    or a>b
    or (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 109 105 106 1 1067 107.0
NULL NULL 124 123 1 1226 NULL
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
2 162 160 161 1 1622 162.0
-2 173 170 172 2 1714 172.0
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
2 246 249 247 2 2476 247.0
4 110 112 113 1 NULL NULL
NULL 146 145 147 2 NULL NULL
NULL NULL 151 150 1 NULL NULL
NULL 157 158 155 3 NULL NULL
NULL 165 167 166 1 NULL NULL
NULL 177 175 176 1 NULL NULL
-1 204 NULL 202 NULL NULL NULL
NULL NULL 240 244 4 NULL NULL
1 237 236 NULL NULL NULL NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
    or a>b
    or (e>c or e<d)
order by col2,col1,col6,col3,col7,col4,col5;

----
-1 109 105 106 1 1067 107.0
4 110 112 113 1 NULL NULL
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
NULL 146 145 147 2 NULL NULL
NULL 157 158 155 3 NULL NULL
2 162 160 161 1 1622 162.0
NULL 165 167 166 1 NULL NULL
-2 173 170 172 2 1714 172.0
NULL 177 175 176 1 NULL NULL
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
-1 204 NULL 202 NULL NULL NULL
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
1 237 236 NULL NULL NULL NULL
2 246 249 247 2 2476 247.0
NULL NULL 124 123 1 1226 NULL
NULL NULL 151 150 1 NULL NULL
NULL NULL 240 244 4 NULL NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
    or (e>c or e<d)
    or a>b
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 109 105 106 1 1067 107.0
NULL NULL 124 123 1 1226 NULL
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
2 162 160 161 1 1622 162.0
-2 173 170 172 2 1714 172.0
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
2 246 249 247 2 2476 247.0
4 110 112 113 1 NULL NULL
NULL 146 145 147 2 NULL NULL
NULL NULL 151 150 1 NULL NULL
NULL 157 158 155 3 NULL NULL
NULL 165 167 166 1 NULL NULL
NULL 177 175 176 1 NULL NULL
-1 204 NULL 202 NULL NULL NULL
NULL NULL 240 244 4 NULL NULL
1 237 236 NULL NULL NULL NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
    or (e>c or e<d)
    or a>b
order by col4,col7,col1,col2,col6,col5,col3;

----
-1 109 105 106 1 1067 107.0
4 110 112 113 1 NULL NULL
NULL NULL 124 123 1 1226 NULL
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
NULL 146 145 147 2 NULL NULL
NULL NULL 151 150 1 NULL NULL
NULL 157 158 155 3 NULL NULL
2 162 160 161 1 1622 162.0
NULL 165 167 166 1 NULL NULL
-2 173 170 172 2 1714 172.0
NULL 177 175 176 1 NULL NULL
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
-1 204 NULL 202 NULL NULL NULL
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
NULL NULL 240 244 4 NULL NULL
2 246 249 247 2 2476 247.0
1 237 236 NULL NULL NULL NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>c or e<d)
    or a>b
    or b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 109 105 106 1 1067 107.0
NULL NULL 124 123 1 1226 NULL
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
2 162 160 161 1 1622 162.0
-2 173 170 172 2 1714 172.0
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
2 246 249 247 2 2476 247.0
4 110 112 113 1 NULL NULL
NULL 146 145 147 2 NULL NULL
NULL NULL 151 150 1 NULL NULL
NULL 157 158 155 3 NULL NULL
NULL 165 167 166 1 NULL NULL
NULL 177 175 176 1 NULL NULL
-1 204 NULL 202 NULL NULL NULL
NULL NULL 240 244 4 NULL NULL
1 237 236 NULL NULL NULL NULL

statement query IIIIIIF
select d-e as col1,
       e as col2,
       b as col3,
       c as col4,
       abs(b-c) as col5,
       a+b*2+c*3+d*4 as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>c or e<d)
    or a>b
    or b>c
order by col7,col2,col6,col1,col5,col4,col3;

----
-1 109 105 106 1 1067 107.0
2 126 129 125 4 1272 127.0
1 132 130 134 4 1325 132.0
1 135 139 137 2 1371 137.0
-4 144 143 141 2 1411 142.0
2 162 160 161 1 1622 162.0
-2 173 170 172 2 1714 172.0
3 180 181 184 3 1828 182.0
-4 189 186 187 1 1861 187.0
-2 192 194 193 1 1918 192.0
-1 197 198 195 3 1964 197.0
2 210 211 214 3 2125 212.0
-2 219 218 215 3 2165 217.0
1 221 223 224 1 2226 222.0
-1 227 228 225 3 2264 227.0
3 230 232 231 1 2323 232.0
2 246 249 247 2 2476 247.0
4 110 112 113 1 NULL NULL
NULL 146 145 147 2 NULL NULL
NULL 157 158 155 3 NULL NULL
NULL 165 167 166 1 NULL NULL
NULL 177 175 176 1 NULL NULL
-1 204 NULL 202 NULL NULL NULL
1 237 236 NULL NULL NULL NULL
NULL NULL 124 123 1 1226 NULL
NULL NULL 151 150 1 NULL NULL
NULL NULL 240 244 4 NULL NULL

statement query skipped
elect c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d-e as col6
from t1
where c>d
   and e+d between a+b-10 and c+130
   and (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d-e as col6
from t1
where c>d
   and e+d between a+b-10 and c+130
   and (e>a and e<b)
order by col4,col5,col6,col2,col3,col1;

----

statement query skipped
elect c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d-e as col6
from t1
where (e>a and e<b)
   and c>d
   and e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2 as col5,
       d-e as col6
from t1
where (e>a and e<b)
   and c>d
   and e+d between a+b-10 and c+130
order by col4,col6,col2,col1,col5,col3;

----

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where d>e
order by col4,col2,col3,col1;

----
0 -1 1484 111
0 -3 760 222
0 1 827 222
0 2 1338 222
0 -2 1391 333
0 1 793 333
0 1 1096 333
0 2 1277 333
0 -3 966 444
0 -1 NULL 444
0 NULL NULL 444

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where d>e
order by col4,col2,col1,col3;

----
0 -1 1484 111
0 -3 760 222
0 1 827 222
0 2 1338 222
0 -2 1391 333
0 1 793 333
0 1 1096 333
0 2 1277 333
0 -3 966 444
0 -1 NULL 444
0 NULL NULL 444

statement query I
select b as col1
from t1
order by col1;

----
105
112
124
129
130
139
143
145
151
158
160
167
170
175
181
186
194
198
206
211
218
223
228
232
236
240
249
NULL
NULL
NULL

statement query I
select b as col1
from t1
order by col1;

----
105
112
124
129
130
139
143
145
151
158
160
167
170
175
181
186
194
198
206
211
218
223
228
232
236
240
249
NULL
NULL
NULL

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and d>e
   and c between b-2 and d+2
order by col2,col1;

----

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and d>e
   and c between b-2 and d+2
order by col1,col2;

----

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and c between b-2 and d+2
   and d>e
order by col2,col1;

----

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and c between b-2 and d+2
   and d>e
order by col2,col1;

----

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and d>e
order by col2,col1;

----

statement query skipped
elect d as col1,
       a+b*2 as col2
from t1
where c between b-2 and d+2
   and e+d between a+b-10 and c+130
   and d>e
order by col2,col1;

----

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where c between b-2 and d+2
    or (e>a and e<b)
    or b>c
order by col2,col1;

----
1067 107
1226 121
1272 127
1325 131
1371 138
1411 142
NULL 153
NULL 159
1622 163
NULL 168
1714 174
1828 182
1861 188
1918 191
1964 199
2125 213
2165 216
2226 220
2264 229
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where c between b-2 and d+2
    or (e>a and e<b)
    or b>c
order by col2,col1;

----
1067 107
1226 121
1272 127
1325 131
1371 138
1411 142
NULL 153
NULL 159
1622 163
NULL 168
1714 174
1828 182
1861 188
1918 191
1964 199
2125 213
2165 216
2226 220
2264 229
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where c between b-2 and d+2
    or b>c
    or (e>a and e<b)
order by col2,col1;

----
1067 107
1226 121
1272 127
1325 131
1371 138
1411 142
NULL 153
NULL 159
1622 163
NULL 168
1714 174
1828 182
1861 188
1918 191
1964 199
2125 213
2165 216
2226 220
2264 229
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where c between b-2 and d+2
    or b>c
    or (e>a and e<b)
order by col2,col1;

----
1067 107
1226 121
1272 127
1325 131
1371 138
1411 142
NULL 153
NULL 159
1622 163
NULL 168
1714 174
1828 182
1861 188
1918 191
1964 199
2125 213
2165 216
2226 220
2264 229
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2 as col1,
       abs(b-c) as col2
from t1
order by col2,col1;

----
317 1
369 1
455 1
483 1
502 1
529 1
560 1
579 1
666 1
698 1
NULL 1
416 2
428 2
439 2
514 2
743 2
NULL 2
475 3
544 3
595 3
635 3
652 3
685 3
385 4
391 4
723 4
711 NULL
NULL NULL
NULL NULL
NULL NULL

statement query II
select a+b*2 as col1,
       abs(b-c) as col2
from t1
order by col1,col2;

----
317 1
369 1
385 4
391 4
416 2
428 2
439 2
455 1
475 3
483 1
502 1
514 2
529 1
544 3
560 1
579 1
595 3
635 3
652 3
666 1
685 3
698 1
711 NULL
723 4
743 2
NULL 1
NULL 2
NULL NULL
NULL NULL
NULL NULL

statement query IIIII
select a+b*2+c*3+d*4 as col1,
       e as col2,
       abs(b-c) as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
order by col4,col5,col2,col3,col1;

----
1828 180 3 364 1
1861 189 1 376 2
1918 192 1 382 3
2125 210 3 426 2
2226 221 1 440 2
1226 NULL 1 1240 1
1325 132 4 1300 1
1371 135 2 1390 1
1411 144 2 1430 1
1714 173 2 1700 1
NULL NULL 2 NULL 1
NULL NULL NULL NULL 1
NULL 117 NULL NULL 3

statement query ITIII
select a+b*2+c*3+d*4 as col1,
       e as col2,
       abs(b-c) as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       c-d as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
order by col1,col2,col3,col5,col4;

----
1226 NULL 1 1240 1
1325 132 4 1300 1
1371 135 2 1390 1
1411 144 2 1430 1
1714 173 2 1700 1
1828 180 3 364 1
1861 189 1 376 2
1918 192 1 382 3
2125 210 3 426 2
2226 221 1 440 2
NULL 117 NULL NULL 3
NULL NULL 2 NULL 1
NULL NULL NULL NULL 1

statement query IIIF
select abs(b-c) as col1,
       d-e as col2,
       a+b*2+c*3+d*4 as col3,
       (a+b+c+d+e)/5 as col4
from t1
where a>b
   and (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
1 -1 1067 107.0
1 2 1622 162.0
1 -4 1861 187.0
3 2 2125 212.0
1 3 2323 232.0

statement query IIIF
select abs(b-c) as col1,
       d-e as col2,
       a+b*2+c*3+d*4 as col3,
       (a+b+c+d+e)/5 as col4
from t1
where a>b
   and (c<=d-2 or c>=d+2)
order by col1,col3,col4,col2;

----
1 -1 1067 107.0
1 2 1622 162.0
1 -4 1861 187.0
1 3 2323 232.0
3 2 2125 212.0

statement query IIIIIF
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4,
       abs(b-c) as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col6,col4,col5,col2,col3,col1;

----
1050 1067 2 -1 1 107.0
1290 1272 -2 4 4 127.0
1300 1325 1 -4 4 132.0
1390 1371 -1 2 2 137.0
1430 1411 -1 2 2 142.0
1600 1622 3 -1 1 162.0
1700 1714 4 -2 2 172.0
364 1828 1 -3 3 182.0
376 1861 2 -1 1 187.0
398 1964 1 3 3 197.0
426 2125 2 -3 3 212.0
432 2165 -2 3 3 217.0
440 2226 -3 -1 1 222.0
458 2264 1 3 3 227.0
468 2323 2 1 1 232.0
490 2476 -4 2 2 247.0
358 NULL 4 -1 1 NULL
1120 NULL NULL -1 1 NULL
1580 NULL 1 3 3 NULL
2360 NULL 3 NULL NULL NULL
402 NULL NULL NULL NULL NULL

statement query IIIIIF
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       a-b as col3,
       b-c as col4,
       abs(b-c) as col5,
       (a+b+c+d+e)/5 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col6,col1,col5,col4,col2,col3;

----
1050 1067 2 -1 1 107.0
1290 1272 -2 4 4 127.0
1300 1325 1 -4 4 132.0
1390 1371 -1 2 2 137.0
1430 1411 -1 2 2 142.0
1600 1622 3 -1 1 162.0
1700 1714 4 -2 2 172.0
364 1828 1 -3 3 182.0
376 1861 2 -1 1 187.0
398 1964 1 3 3 197.0
426 2125 2 -3 3 212.0
432 2165 -2 3 3 217.0
440 2226 -3 -1 1 222.0
458 2264 1 3 3 227.0
468 2323 2 1 1 232.0
490 2476 -4 2 2 247.0
358 NULL 4 -1 1 NULL
402 NULL NULL NULL NULL NULL
1120 NULL NULL -1 1 NULL
1580 NULL 1 3 3 NULL
2360 NULL 3 NULL NULL NULL

statement query I
select abs(b-c) as col1
from t1
where (e>a and e<b)
    or c between b-2 and d+2
order by col1;

----
1
1
1
1
1
1
1
1
2
2
2
2
2
3
3
4

statement query I
select abs(b-c) as col1
from t1
where (e>a and e<b)
    or c between b-2 and d+2
order by col1;

----
1
1
1
1
1
1
1
1
2
2
2
2
2
3
3
4

statement query I
select abs(b-c) as col1
from t1
where c between b-2 and d+2
    or (e>a and e<b)
order by col1;

----
1
1
1
1
1
1
1
1
2
2
2
2
2
3
3
4

statement query I
select abs(b-c) as col1
from t1
where c between b-2 and d+2
    or (e>a and e<b)
order by col1;

----
1
1
1
1
1
1
1
1
2
2
2
2
2
3
3
4

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       e as col4
from t1
where (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
333 4 1300 132
222 5 1390 135
222 6 1430 144
333 9 1580 157
333 11 1670 165
333 14 364 180
333 17 398 197
333 22 458 227

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       e as col4
from t1
where (a>b-2 and a<b+2)
order by col2,col1,col4,col3;

----
333 4 1300 132
222 5 1390 135
222 6 1430 144
333 9 1580 157
333 11 1670 165
333 14 364 180
333 17 398 197
333 22 458 227

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       c as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       c-d as col5
from t1
where b>c
    or (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
26 2 247 111 -1
3 4 125 222 -3
20 3 215 222 -2
2 1 123 222 1
5 2 137 222 1
6 2 141 222 1
21 1 224 222 2
16 1 193 222 3
0 1 106 333 -2
23 1 231 333 -2
17 3 195 333 -1
22 3 225 333 -1
15 1 187 333 2
19 3 214 333 2
8 1 150 333 NULL
11 1 166 333 NULL
9 3 155 333 NULL
10 1 161 444 -3
0 NULL 119 444 3

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       c as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       c-d as col5
from t1
where b>c
    or (c<=d-2 or c>=d+2)
order by col1,col5,col3,col4,col2;

----
0 1 106 333 -2
0 NULL 119 444 3
2 1 123 222 1
3 4 125 222 -3
5 2 137 222 1
6 2 141 222 1
8 1 150 333 NULL
9 3 155 333 NULL
10 1 161 444 -3
11 1 166 333 NULL
15 1 187 333 2
16 1 193 222 3
17 3 195 333 -1
19 3 214 333 2
20 3 215 222 -2
21 1 224 222 2
22 3 225 333 -1
23 1 231 333 -2
26 2 247 111 -1

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       c as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       c-d as col5
from t1
where (c<=d-2 or c>=d+2)
    or b>c
order by col4,col5,col2,col3,col1;

----
26 2 247 111 -1
3 4 125 222 -3
20 3 215 222 -2
2 1 123 222 1
5 2 137 222 1
6 2 141 222 1
21 1 224 222 2
16 1 193 222 3
0 1 106 333 -2
23 1 231 333 -2
17 3 195 333 -1
22 3 225 333 -1
15 1 187 333 2
19 3 214 333 2
8 1 150 333 NULL
11 1 166 333 NULL
9 3 155 333 NULL
10 1 161 444 -3
0 NULL 119 444 3

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       c as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       c-d as col5
from t1
where (c<=d-2 or c>=d+2)
    or b>c
order by col4,col2,col5,col3,col1;

----
26 2 247 111 -1
2 1 123 222 1
21 1 224 222 2
16 1 193 222 3
5 2 137 222 1
6 2 141 222 1
20 3 215 222 -2
3 4 125 222 -3
0 1 106 333 -2
23 1 231 333 -2
15 1 187 333 2
8 1 150 333 NULL
11 1 166 333 NULL
17 3 195 333 -1
22 3 225 333 -1
19 3 214 333 2
9 3 155 333 NULL
10 1 161 444 -3
0 NULL 119 444 3

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1;

----
1272 4 127.0 125
1918 1 192.0 193
2165 3 217.0 215
2323 1 232.0 231

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1,col4,col3;

----
1918 1 192.0 193
2323 1 232.0 231
2165 3 217.0 215
1272 4 127.0 125

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
   and b>c
order by col4,col2,col3,col1;

----
1272 4 127.0 125
1918 1 192.0 193
2165 3 217.0 215
2323 1 232.0 231

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
   and b>c
order by col4,col3,col2,col1;

----
1272 4 127.0 125
1918 1 192.0 193
2165 3 217.0 215
2323 1 232.0 231

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
   and (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
1272 4 127.0 125
1918 1 192.0 193
2165 3 217.0 215
2323 1 232.0 231

statement query IIFI
select a+b*2+c*3+d*4 as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
   and (c<=d-2 or c>=d+2)
order by col3,col1,col4,col2;

----
1272 4 127.0 125
1918 1 192.0 193
2165 3 217.0 215
2323 1 232.0 231

statement query IIIIF
select e as col1,
       d-e as col2,
       abs(a) as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col5,col2,col3,col1;

----
132 1 131 -4 132.0
NULL NULL 243 -4 NULL
180 3 182 -3 182.0
210 2 213 -3 212.0
173 -2 174 -2 172.0
146 NULL 149 -2 NULL
NULL NULL NULL -2 NULL
109 -1 107 -1 107.0
162 2 163 -1 162.0
189 -4 188 -1 187.0
221 1 220 -1 222.0
110 4 NULL -1 NULL
177 NULL 179 -1 NULL
192 -2 191 1 192.0
230 3 234 1 232.0
NULL NULL 121 1 NULL
NULL NULL 153 1 NULL
165 NULL 168 1 NULL
135 1 138 2 137.0
144 -4 142 2 142.0
246 2 245 2 247.0
197 -1 199 3 197.0
219 -2 216 3 217.0
227 -1 229 3 227.0
157 NULL 159 3 NULL
126 2 127 4 127.0
117 -1 115 NULL NULL
204 -1 201 NULL NULL
237 1 239 NULL NULL
NULL NULL 104 NULL NULL

statement query IIIIF
select e as col1,
       d-e as col2,
       abs(a) as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col5,col3,col4,col2,col1;

----
109 -1 107 -1 107.0
126 2 127 4 127.0
132 1 131 -4 132.0
135 1 138 2 137.0
144 -4 142 2 142.0
162 2 163 -1 162.0
173 -2 174 -2 172.0
180 3 182 -3 182.0
189 -4 188 -1 187.0
192 -2 191 1 192.0
197 -1 199 3 197.0
210 2 213 -3 212.0
219 -2 216 3 217.0
221 1 220 -1 222.0
227 -1 229 3 227.0
230 3 234 1 232.0
246 2 245 2 247.0
NULL NULL 104 NULL NULL
117 -1 115 NULL NULL
NULL NULL 121 1 NULL
146 NULL 149 -2 NULL
NULL NULL 153 1 NULL
157 NULL 159 3 NULL
165 NULL 168 1 NULL
177 NULL 179 -1 NULL
204 -1 201 NULL NULL
237 1 239 NULL NULL
NULL NULL 243 -4 NULL
NULL NULL NULL -2 NULL
110 4 NULL -1 NULL

statement query I
select a+b*2+c*3 as col1
from t1
where (a>b-2 and a<b+2)
order by col1;

----
793
827
851
940
1000
1096
1180
1360

statement query I
select a+b*2+c*3 as col1
from t1
where (a>b-2 and a<b+2)
order by col1;

----
793
827
851
940
1000
1096
1180
1360

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where a>b
    or d>e
    or (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
317 108 109 1612 1067
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
483 164 162 2432 1622
514 171 173 2579 1714
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
743 248 246 3706 2476
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL
711 238 237 NULL NULL
439 NULL 146 NULL NULL
475 NULL 157 NULL NULL
502 NULL 165 NULL NULL
529 NULL 177 NULL NULL
455 NULL NULL NULL NULL
723 NULL NULL NULL NULL

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where a>b
    or d>e
    or (c<=d-2 or c>=d+2)
order by col2,col4,col5,col3,col1;

----
317 108 109 1612 1067
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
483 164 162 2432 1622
514 171 173 2579 1714
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
711 238 237 NULL NULL
743 248 246 3706 2476
439 NULL 146 NULL NULL
475 NULL 157 NULL NULL
502 NULL 165 NULL NULL
529 NULL 177 NULL NULL
455 NULL NULL NULL NULL
723 NULL NULL NULL NULL

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (c<=d-2 or c>=d+2)
    or a>b
    or d>e
order by col4,col5,col2,col3,col1;

----
317 108 109 1612 1067
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
483 164 162 2432 1622
514 171 173 2579 1714
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
743 248 246 3706 2476
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL
711 238 237 NULL NULL
439 NULL 146 NULL NULL
475 NULL 157 NULL NULL
502 NULL 165 NULL NULL
529 NULL 177 NULL NULL
455 NULL NULL NULL NULL
723 NULL NULL NULL NULL

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (c<=d-2 or c>=d+2)
    or a>b
    or d>e
order by col1,col3,col2,col5,col4;

----
317 108 109 1612 1067
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
439 NULL 146 NULL NULL
455 NULL NULL NULL NULL
475 NULL 157 NULL NULL
483 164 162 2432 1622
502 NULL 165 NULL NULL
514 171 173 2579 1714
529 NULL 177 NULL NULL
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
711 238 237 NULL NULL
723 NULL NULL NULL NULL
743 248 246 3706 2476
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d>e
    or (c<=d-2 or c>=d+2)
    or a>b
order by col4,col5,col2,col3,col1;

----
317 108 109 1612 1067
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
483 164 162 2432 1622
514 171 173 2579 1714
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
743 248 246 3706 2476
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL
711 238 237 NULL NULL
439 NULL 146 NULL NULL
475 NULL 157 NULL NULL
502 NULL 165 NULL NULL
529 NULL 177 NULL NULL
455 NULL NULL NULL NULL
723 NULL NULL NULL NULL

statement query IIIII
select a+b*2 as col1,
       d as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d>e
    or (c<=d-2 or c>=d+2)
    or a>b
order by col1,col2,col5,col4,col3;

----
317 108 109 1612 1067
385 128 126 1902 1272
391 133 132 1985 1325
416 136 135 2046 1371
439 NULL 146 NULL NULL
455 NULL NULL NULL NULL
475 NULL 157 NULL NULL
483 164 162 2432 1622
502 NULL 165 NULL NULL
514 171 173 2579 1714
529 NULL 177 NULL NULL
544 183 180 2728 1828
560 185 189 2806 1861
579 190 192 2878 1918
595 196 197 2949 1964
635 212 210 3175 2125
652 217 219 3260 2165
666 222 221 3331 2226
685 226 227 3399 2264
698 233 230 3473 2323
711 238 237 NULL NULL
723 NULL NULL NULL NULL
743 248 246 3706 2476
NULL 114 110 NULL NULL
NULL 116 117 NULL NULL

statement query IFII
select b as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2+c*3+d*4 as col3,
       e as col4
from t1
where (e>c or e<d)
order by col4,col2,col3,col1;

----
105 107.0 1067 109
112 NULL NULL 110
129 127.0 1272 126
130 132.0 1325 132
139 137.0 1371 135
143 142.0 1411 144
158 NULL NULL 157
160 162.0 1622 162
170 172.0 1714 173
175 NULL NULL 177
181 182.0 1828 180
186 187.0 1861 189
198 197.0 1964 197
NULL NULL NULL 204
211 212.0 2125 210
218 217.0 2165 219
223 222.0 2226 221
228 227.0 2264 227
232 232.0 2323 230
236 NULL NULL 237
249 247.0 2476 246

