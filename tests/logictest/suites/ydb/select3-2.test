statement ok
drop table if exists t1 all;

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null);

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104);

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105);

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113);

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null);

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121);

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125);

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130);

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137);

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143);

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147);

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null);

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158);

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162);

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166);

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174);

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175);

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184);

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185);

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191);

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195);

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204);

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207);

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211);

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219);

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224);

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225);

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233);

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238);

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null);

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245);

statement query III
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and (e>a and e<b)
order by col3,col1,col2;

----
1 2878 579

statement query III
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and b>c
order by col2,col3,col1;

----
1 2878 579

statement query III
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and b>c
order by col2,col1,col3;

----
1 2878 579

statement query III
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3
from t1
where (c<=d-2 or c>=d+2)
   and (e>a and e<b)
   and b>c
order by col2,col3,col1;

----
1 2878 579

statement query III
select b-c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2 as col3
from t1
where (c<=d-2 or c>=d+2)
   and (e>a and e<b)
   and b>c
order by col1,col3,col2;

----
1 2878 579

statement query IFIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (a+b+c+d+e)/5 as col2,
       a-b as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       abs(b-c) as col6
from t1
where (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----
382 192.0 -3 16 222 1
440 222.0 -3 21 222 1
490 247.0 -4 26 111 2

statement query IFIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (a+b+c+d+e)/5 as col2,
       a-b as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       abs(b-c) as col6
from t1
where (e>a and e<b)
order by col2,col1,col5,col4,col6,col3;

----
382 192.0 -3 16 222 1
440 222.0 -3 21 222 1
490 247.0 -4 26 111 2

statement query II
select d as col1,
       c-d as col2
from t1
order by col2,col1;

----
128 -3
164 -3
108 -2
217 -2
233 -2
114 -1
196 -1
203 -1
226 -1
248 -1
101 1
122 1
133 1
136 1
140 1
171 1
183 1
207 1
185 2
212 2
222 2
116 3
190 3
238 NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL

statement query II
select d as col1,
       c-d as col2
from t1
order by col2,col1;

----
128 -3
164 -3
108 -2
217 -2
233 -2
114 -1
196 -1
203 -1
226 -1
248 -1
101 1
122 1
133 1
136 1
140 1
171 1
183 1
207 1
185 2
212 2
222 2
116 3
190 3
238 NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where b>c
   and c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
order by col1;

----
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where b>c
   and c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
order by col1;

----
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and c between b-2 and d+2
order by col1;

----
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and c between b-2 and d+2
order by col1;

----
0

statement query I
select e as col1
from t1
where b>c
   and d>e
order by col1;

----
126
135
230
246

statement query I
select e as col1
from t1
where b>c
   and d>e
order by col1;

----
126
135
230
246

statement query I
select abs(a) as col1
from t1
where c between b-2 and d+2
order by col1;

----
107
121
131
138
142
163
174
182
188
213
220
234
245
NULL
NULL

statement query I
select abs(a) as col1
from t1
where c between b-2 and d+2
order by col1;

----
107
121
131
138
142
163
174
182
188
213
220
234
245
NULL
NULL

statement error 1105
select d-e as col1
from t1
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
null
order by col1;

statement error 1105
select d-e as col1
from t1
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1
null;

statement error 1105
select d-e as col1
from t1
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
null
order by col1;

statement error 1105
select d-e as col1
from t1
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1
null;

statement error 1105
select d-e as col1
from t1
where (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
null
order by col1;

statement error 1105
select d-e as col1
from t1
where (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and (e>c or e<d)
order by col1
null;

statement error 1105
select d-e as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (a>b-2 and a<b+2)
   and (e>c or e<d)
null
order by col1;

statement error 1105
select d-e as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (a>b-2 and a<b+2)
   and (e>c or e<d)
order by col1
null;

statement query II
select e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col2,col1;

----
177 358
180 364
189 376
197 398
204 402
210 426
219 432
221 440
227 458
230 468
246 490
109 1050
110 1120
126 1290
132 1300
135 1390
144 1430
157 1580
162 1600
173 1700
237 2360

statement query II
select e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col1,col2;

----
109 1050
110 1120
126 1290
132 1300
135 1390
144 1430
157 1580
162 1600
173 1700
177 358
180 364
189 376
197 398
204 402
210 426
219 432
221 440
227 458
230 468
237 2360
246 490

statement query IITI
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3 as col3,
       b as col4
from t1
where d>e
   and (e>c or e<d)
order by col4,col2,col3,col1;

----
-1 1 NULL 112
-3 3 760 129
1 4 793 130
1 5 827 139
-3 10 966 160
1 14 1096 181
2 19 1277 211
2 21 1338 223
-2 23 1391 232
NULL 24 NULL 236
-1 26 1484 249

statement query IIII
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       a+b*2+c*3 as col3,
       b as col4
from t1
where d>e
   and (e>c or e<d)
order by col3,col1,col2,col4;

----
-3 3 760 129
1 4 793 130
1 5 827 139
-3 10 966 160
1 14 1096 181
2 19 1277 211
2 21 1338 223
-2 23 1391 232
-1 26 1484 249
-1 1 NULL 112
NULL 24 NULL 236

statement query IIIFII
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       e as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
1612 107 108 107.0 109 0
NULL 115 116 NULL 117 0
NULL 201 203 NULL 204 0
NULL 104 101 NULL NULL 0
NULL NULL 114 NULL 110 1
NULL 121 122 NULL NULL 2
1902 127 128 127.0 126 3
1985 131 133 132.0 132 4
2046 138 136 137.0 135 5
2131 142 140 142.0 144 6
NULL 149 NULL NULL 146 7
NULL 153 NULL NULL NULL 8
NULL 159 NULL NULL 157 9
2432 163 164 162.0 162 10
NULL 168 NULL NULL 165 11
2579 174 171 172.0 173 12
NULL 179 NULL NULL 177 13
2728 182 183 182.0 180 14
2806 188 185 187.0 189 15
2878 191 190 192.0 192 16
2949 199 196 197.0 197 17
NULL NULL 207 NULL NULL 18
3175 213 212 212.0 210 19
3260 216 217 217.0 219 20
3331 220 222 222.0 221 21
3399 229 226 227.0 227 22
3473 234 233 232.0 230 23
NULL 239 238 NULL 237 24
NULL 243 NULL NULL NULL 25
3706 245 248 247.0 246 26

statement query IIIFII
select a+b*2+c*3+d*4+e*5 as col1,
       a as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       e as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
order by col1,col2,col6,col4,col5,col3;

----
1612 107 108 107.0 109 0
1902 127 128 127.0 126 3
1985 131 133 132.0 132 4
2046 138 136 137.0 135 5
2131 142 140 142.0 144 6
2432 163 164 162.0 162 10
2579 174 171 172.0 173 12
2728 182 183 182.0 180 14
2806 188 185 187.0 189 15
2878 191 190 192.0 192 16
2949 199 196 197.0 197 17
3175 213 212 212.0 210 19
3260 216 217 217.0 219 20
3331 220 222 222.0 221 21
3399 229 226 227.0 227 22
3473 234 233 232.0 230 23
3706 245 248 247.0 246 26
NULL 104 101 NULL NULL 0
NULL 115 116 NULL 117 0
NULL 121 122 NULL NULL 2
NULL 149 NULL NULL 146 7
NULL 153 NULL NULL NULL 8
NULL 159 NULL NULL 157 9
NULL 168 NULL NULL 165 11
NULL 179 NULL NULL 177 13
NULL 201 203 NULL 204 0
NULL 239 238 NULL 237 24
NULL 243 NULL NULL NULL 25
NULL NULL 114 NULL 110 1
NULL NULL 207 NULL NULL 18

statement query IIIII
select a as col1,
       abs(b-c) as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or a>b
order by col4,col5,col2,col3,col1;

----
179 1 4 358 -1
182 3 1 364 -3
188 1 2 376 -1
191 1 -3 382 1
199 3 1 398 3
213 3 2 426 -3
220 1 -3 440 -1
229 3 1 458 3
234 1 2 468 1
243 4 3 486 -4
245 2 -4 490 2
107 1 2 1050 -1
131 4 1 1300 -4
149 2 4 1450 -2
153 1 2 1510 1
159 3 1 1580 3
163 1 3 1600 -1
168 1 1 1670 1
174 2 4 1700 -2
239 NULL 3 2360 NULL

statement query IIIII
select a as col1,
       abs(b-c) as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or a>b
order by col3,col1,col2,col4,col5;

----
245 2 -4 490 2
191 1 -3 382 1
220 1 -3 440 -1
131 4 1 1300 -4
159 3 1 1580 3
168 1 1 1670 1
182 3 1 364 -3
199 3 1 398 3
229 3 1 458 3
107 1 2 1050 -1
153 1 2 1510 1
188 1 2 376 -1
213 3 2 426 -3
234 1 2 468 1
163 1 3 1600 -1
239 NULL 3 2360 NULL
243 4 3 486 -4
149 2 4 1450 -2
174 2 4 1700 -2
179 1 4 358 -1

statement query IIIII
select a as col1,
       abs(b-c) as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
179 1 4 358 -1
182 3 1 364 -3
188 1 2 376 -1
191 1 -3 382 1
199 3 1 398 3
213 3 2 426 -3
220 1 -3 440 -1
229 3 1 458 3
234 1 2 468 1
243 4 3 486 -4
245 2 -4 490 2
107 1 2 1050 -1
131 4 1 1300 -4
149 2 4 1450 -2
153 1 2 1510 1
159 3 1 1580 3
163 1 3 1600 -1
168 1 1 1670 1
174 2 4 1700 -2
239 NULL 3 2360 NULL

statement query IIIII
select a as col1,
       abs(b-c) as col2,
       a-b as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or (e>a and e<b)
order by col2,col4,col5,col3,col1;

----
179 1 4 358 -1
188 1 2 376 -1
191 1 -3 382 1
220 1 -3 440 -1
234 1 2 468 1
107 1 2 1050 -1
153 1 2 1510 1
163 1 3 1600 -1
168 1 1 1670 1
245 2 -4 490 2
149 2 4 1450 -2
174 2 4 1700 -2
182 3 1 364 -3
199 3 1 398 3
213 3 2 426 -3
229 3 1 458 3
159 3 1 1580 3
243 4 3 486 -4
131 4 1 1300 -4
239 NULL 3 2360 NULL

statement query IIIIIIT
select abs(b-c) as col1,
       d-e as col2,
       c-d as col3,
       c as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where c between b-2 and d+2
   and d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
1 4 -1 113 1120 1 NULL
4 1 1 134 1300 4 132.0
2 1 1 137 1390 5 137.0
1 2 -3 161 1600 10 162.0
3 3 1 184 364 14 182.0
3 2 2 214 426 19 212.0
1 1 2 224 440 21 222.0
1 3 -2 231 468 23 232.0
2 2 -1 247 490 26 247.0

statement query IIIIIIF
select abs(b-c) as col1,
       d-e as col2,
       c-d as col3,
       c as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where c between b-2 and d+2
   and d>e
order by col1,col3,col7,col2,col5,col4,col6;

----
1 2 -3 161 1600 10 162.0
1 3 -2 231 468 23 232.0
1 4 -1 113 1120 1 NULL
1 1 2 224 440 21 222.0
2 2 -1 247 490 26 247.0
2 1 1 137 1390 5 137.0
3 3 1 184 364 14 182.0
3 2 2 214 426 19 212.0
4 1 1 134 1300 4 132.0

statement query IIIIIIT
select abs(b-c) as col1,
       d-e as col2,
       c-d as col3,
       c as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where d>e
   and c between b-2 and d+2
order by col6,col7,col4,col5,col2,col3,col1;

----
1 4 -1 113 1120 1 NULL
4 1 1 134 1300 4 132.0
2 1 1 137 1390 5 137.0
1 2 -3 161 1600 10 162.0
3 3 1 184 364 14 182.0
3 2 2 214 426 19 212.0
1 1 2 224 440 21 222.0
1 3 -2 231 468 23 232.0
2 2 -1 247 490 26 247.0

statement query IIIIIIF
select abs(b-c) as col1,
       d-e as col2,
       c-d as col3,
       c as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where d>e
   and c between b-2 and d+2
order by col7,col3,col4,col6,col2,col1,col5;

----
4 1 1 134 1300 4 132.0
2 1 1 137 1390 5 137.0
1 2 -3 161 1600 10 162.0
3 3 1 184 364 14 182.0
3 2 2 214 426 19 212.0
1 1 2 224 440 21 222.0
1 3 -2 231 468 23 232.0
2 2 -1 247 490 26 247.0
1 4 -1 113 1120 1 NULL

statement query II
select a-b as col1,
       a+b*2+c*3 as col2
from t1
where d not between 110 and 150
order by col2,col1;

----
2 635
3 966
4 1030
1 1096
2 1121
-3 1158
1 1180
2 1277
-2 1297
-3 1338
1 1360
2 1391
-4 1484
3 NULL
NULL NULL
NULL NULL
NULL NULL

statement query II
select a-b as col1,
       a+b*2+c*3 as col2
from t1
where d not between 110 and 150
order by col1,col2;

----
-4 1484
-3 1158
-3 1338
-2 1297
1 1096
1 1180
1 1360
2 635
2 1121
2 1277
2 1391
3 966
3 NULL
4 1030
NULL NULL
NULL NULL
NULL NULL

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a+b*2 as col3,
       d-e as col4,
       b as col5
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
444 1 391 1 130
111 -1 416 1 139
444 -3 666 1 223
555 3 711 1 236
333 -2 385 2 129
333 3 483 2 160
222 2 635 2 211
444 -4 743 2 249
333 1 544 3 181
555 2 698 3 232
555 NULL NULL 4 112

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a-b as col2,
       a+b*2 as col3,
       d-e as col4,
       b as col5
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col2,col1,col4,col5;

----
333 -2 385 2 129
444 1 391 1 130
111 -1 416 1 139
333 3 483 2 160
333 1 544 3 181
222 2 635 2 211
444 -3 666 1 223
555 2 698 3 232
555 3 711 1 236
444 -4 743 2 249
555 NULL NULL 4 112

statement query IITTTI
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       abs(a) as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
555 444 NULL NULL NULL 104
333 333 317 105 1067 107
333 444 NULL NULL NULL 115
333 222 369 124 1226 121
333 222 385 129 1272 127
444 333 391 130 1325 131
111 222 416 139 1371 138
111 222 428 143 1411 142
555 444 439 145 NULL 149
555 333 455 151 NULL 153
555 333 475 158 NULL 159
333 444 483 160 1622 163
555 333 502 167 NULL 168
555 444 514 170 1714 174
555 444 529 175 NULL 179
333 333 544 181 1828 182
444 333 560 186 1861 188
444 222 579 194 1918 191
555 333 595 198 1964 199
222 444 NULL NULL NULL 201
222 333 635 211 2125 213
333 222 652 218 2165 216
444 222 666 223 2226 220
555 333 685 228 2264 229
555 333 698 232 2323 234
555 444 711 236 NULL 239
222 444 723 240 NULL 243
444 111 743 249 2476 245
555 444 NULL 112 NULL NULL
555 444 NULL 206 NULL NULL

statement query IITTTI
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       abs(a) as col6
from t1
order by col6,col5,col4,col2,col3,col1;

----
555 444 NULL NULL NULL 104
333 333 317 105 1067 107
333 444 NULL NULL NULL 115
333 222 369 124 1226 121
333 222 385 129 1272 127
444 333 391 130 1325 131
111 222 416 139 1371 138
111 222 428 143 1411 142
555 444 439 145 NULL 149
555 333 455 151 NULL 153
555 333 475 158 NULL 159
333 444 483 160 1622 163
555 333 502 167 NULL 168
555 444 514 170 1714 174
555 444 529 175 NULL 179
333 333 544 181 1828 182
444 333 560 186 1861 188
444 222 579 194 1918 191
555 333 595 198 1964 199
222 444 NULL NULL NULL 201
222 333 635 211 2125 213
333 222 652 218 2165 216
444 222 666 223 2226 220
555 333 685 228 2264 229
555 333 698 232 2323 234
555 444 711 236 NULL 239
222 444 723 240 NULL 243
444 111 743 249 2476 245
555 444 NULL 112 NULL NULL
555 444 NULL 206 NULL NULL

statement query IIIII
select abs(a) as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       a-b as col4,
       e as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
138 1390 1371 -1 135
142 1430 1411 -1 144
131 1300 1325 1 132
159 1580 NULL 1 157
168 1670 NULL 1 165
182 364 1828 1 180
199 398 1964 1 197
229 458 2264 1 227

statement query IIIII
select abs(a) as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       a-b as col4,
       e as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
order by col3,col5,col4,col2,col1;

----
131 1300 1325 1 132
138 1390 1371 -1 135
142 1430 1411 -1 144
182 364 1828 1 180
199 398 1964 1 197
229 458 2264 1 227
159 1580 NULL 1 157
168 1670 NULL 1 165

statement query IIIII
select a+b*2 as col1,
       abs(a) as col2,
       e as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col2,col3,col1;

----
317 107 109 1067 1050
369 121 NULL 1226 1240
385 127 126 1272 1290
391 131 132 1325 1300
416 138 135 1371 1390
428 142 144 1411 1430
483 163 162 1622 1600
514 174 173 1714 1700
544 182 180 1828 364
560 188 189 1861 376
579 191 192 1918 382
595 199 197 1964 398
635 213 210 2125 426
652 216 219 2165 432
666 220 221 2226 440
685 229 227 2264 458
698 234 230 2323 468
743 245 246 2476 490
529 179 177 NULL 358
NULL 201 204 NULL 402
723 243 NULL NULL 486
NULL NULL 110 NULL 1120
439 149 146 NULL 1450
455 153 NULL NULL 1510
475 159 157 NULL 1580
502 168 165 NULL 1670
711 239 237 NULL 2360
NULL 104 NULL NULL NULL
NULL 115 117 NULL NULL
NULL NULL NULL NULL NULL

statement query IIITI
select a+b*2 as col1,
       abs(a) as col2,
       e as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col2,col4,col3,col1;

----
529 179 177 NULL 358
544 182 180 1828 364
560 188 189 1861 376
579 191 192 1918 382
595 199 197 1964 398
NULL 201 204 NULL 402
635 213 210 2125 426
652 216 219 2165 432
666 220 221 2226 440
685 229 227 2264 458
698 234 230 2323 468
723 243 NULL NULL 486
743 245 246 2476 490
317 107 109 1067 1050
NULL NULL 110 NULL 1120
369 121 NULL 1226 1240
385 127 126 1272 1290
391 131 132 1325 1300
416 138 135 1371 1390
428 142 144 1411 1430
439 149 146 NULL 1450
455 153 NULL NULL 1510
475 159 157 NULL 1580
483 163 162 1622 1600
502 168 165 NULL 1670
514 174 173 1714 1700
711 239 237 NULL 2360
NULL 104 NULL NULL NULL
NULL 115 117 NULL NULL
NULL NULL NULL NULL NULL

statement query IIIIIII
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       c as col5,
       e as col6,
       d as col7
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or a>b
order by col6,col7,col4,col5,col2,col3,col1;

----
1 1067 333 635 106 109 108
1 NULL 444 NULL 113 110 114
4 1325 333 793 134 132 133
2 1371 222 827 137 135 136
2 1411 222 851 141 144 140
2 NULL 444 880 147 146 NULL
3 NULL 333 940 155 157 NULL
1 1622 444 966 161 162 164
1 NULL 333 1000 166 165 NULL
2 1714 444 1030 172 173 171
1 NULL 444 1057 176 177 NULL
3 1828 333 1096 184 180 183
1 1861 333 1121 187 189 185
1 1918 222 1158 193 192 190
3 1964 333 1180 195 197 196
NULL NULL 444 NULL 202 204 203
3 2125 333 1277 214 210 212
3 2165 222 1297 215 219 217
1 2226 222 1338 224 221 222
3 2264 333 1360 225 227 226
1 2323 333 1391 231 230 233
NULL NULL 444 NULL NULL 237 238
2 2476 111 1484 247 246 248
NULL NULL 444 NULL 102 NULL 101
1 1226 222 738 123 NULL 122
2 NULL 444 NULL 208 NULL 207
1 NULL 333 905 150 NULL NULL
4 NULL 444 1455 244 NULL NULL

statement query IIIIIII
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       c as col5,
       e as col6,
       d as col7
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or a>b
order by col4,col2,col5,col6,col7,col3,col1;

----
1 1067 333 635 106 109 108
1 1226 222 738 123 NULL 122
4 1325 333 793 134 132 133
2 1371 222 827 137 135 136
2 1411 222 851 141 144 140
2 NULL 444 880 147 146 NULL
1 NULL 333 905 150 NULL NULL
3 NULL 333 940 155 157 NULL
1 1622 444 966 161 162 164
1 NULL 333 1000 166 165 NULL
2 1714 444 1030 172 173 171
1 NULL 444 1057 176 177 NULL
3 1828 333 1096 184 180 183
1 1861 333 1121 187 189 185
1 1918 222 1158 193 192 190
3 1964 333 1180 195 197 196
3 2125 333 1277 214 210 212
3 2165 222 1297 215 219 217
1 2226 222 1338 224 221 222
3 2264 333 1360 225 227 226
1 2323 333 1391 231 230 233
4 NULL 444 1455 244 NULL NULL
2 2476 111 1484 247 246 248
NULL NULL 444 NULL 102 NULL 101
1 NULL 444 NULL 113 110 114
NULL NULL 444 NULL 202 204 203
2 NULL 444 NULL 208 NULL 207
NULL NULL 444 NULL NULL 237 238

statement query IIIIIII
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       c as col5,
       e as col6,
       d as col7
from t1
where c between b-2 and d+2
    or a>b
    or d not between 110 and 150
order by col6,col7,col4,col5,col2,col3,col1;

----
1 1067 333 635 106 109 108
1 NULL 444 NULL 113 110 114
4 1325 333 793 134 132 133
2 1371 222 827 137 135 136
2 1411 222 851 141 144 140
2 NULL 444 880 147 146 NULL
3 NULL 333 940 155 157 NULL
1 1622 444 966 161 162 164
1 NULL 333 1000 166 165 NULL
2 1714 444 1030 172 173 171
1 NULL 444 1057 176 177 NULL
3 1828 333 1096 184 180 183
1 1861 333 1121 187 189 185
1 1918 222 1158 193 192 190
3 1964 333 1180 195 197 196
NULL NULL 444 NULL 202 204 203
3 2125 333 1277 214 210 212
3 2165 222 1297 215 219 217
1 2226 222 1338 224 221 222
3 2264 333 1360 225 227 226
1 2323 333 1391 231 230 233
NULL NULL 444 NULL NULL 237 238
2 2476 111 1484 247 246 248
NULL NULL 444 NULL 102 NULL 101
1 1226 222 738 123 NULL 122
2 NULL 444 NULL 208 NULL 207
1 NULL 333 905 150 NULL NULL
4 NULL 444 1455 244 NULL NULL

statement query IIIIIII
select abs(b-c) as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       c as col5,
       e as col6,
       d as col7
from t1
where c between b-2 and d+2
    or a>b
    or d not between 110 and 150
order by col1,col6,col7,col5,col3,col4,col2;

----
1 1067 333 635 106 109 108
1 NULL 444 NULL 113 110 114
1 1622 444 966 161 162 164
1 NULL 333 1000 166 165 NULL
1 NULL 444 1057 176 177 NULL
1 1861 333 1121 187 189 185
1 1918 222 1158 193 192 190
1 2226 222 1338 224 221 222
1 2323 333 1391 231 230 233
1 1226 222 738 123 NULL 122
1 NULL 333 905 150 NULL NULL
2 1371 222 827 137 135 136
2 1411 222 851 141 144 140
2 NULL 444 880 147 146 NULL
2 1714 444 1030 172 173 171
2 2476 111 1484 247 246 248
2 NULL 444 NULL 208 NULL 207
3 NULL 333 940 155 157 NULL
3 1828 333 1096 184 180 183
3 1964 333 1180 195 197 196
3 2125 333 1277 214 210 212
3 2165 222 1297 215 219 217
3 2264 333 1360 225 227 226
4 1325 333 793 134 132 133
4 NULL 444 1455 244 NULL NULL
NULL NULL 444 NULL 202 204 203
NULL NULL 444 NULL NULL 237 238
NULL NULL 444 NULL 102 NULL 101

statement query II
select c-d as col1,
       b-c as col2
from t1
where a>b
    or c>d
    or d>e
order by col2,col1;

----
1 -4
NULL -4
1 -3
2 -3
1 -2
1 -2
NULL -2
-3 -1
-2 -1
-1 -1
2 -1
2 -1
NULL -1
-2 1
1 1
3 1
NULL 1
NULL 1
-1 2
1 2
1 2
-1 3
-1 3
NULL 3
-3 4
1 NULL
3 NULL
NULL NULL

statement query II
select c-d as col1,
       b-c as col2
from t1
where a>b
    or c>d
    or d>e
order by col1,col2;

----
-3 -1
-3 4
-2 -1
-2 1
-1 -1
-1 2
-1 3
-1 3
1 -4
1 -3
1 -2
1 -2
1 1
1 2
1 2
1 NULL
2 -3
2 -1
2 -1
3 1
3 NULL
NULL -4
NULL -2
NULL -1
NULL 1
NULL 1
NULL 3
NULL NULL

statement query II
select c-d as col1,
       b-c as col2
from t1
where d>e
    or c>d
    or a>b
order by col2,col1;

----
1 -4
NULL -4
1 -3
2 -3
1 -2
1 -2
NULL -2
-3 -1
-2 -1
-1 -1
2 -1
2 -1
NULL -1
-2 1
1 1
3 1
NULL 1
NULL 1
-1 2
1 2
1 2
-1 3
-1 3
NULL 3
-3 4
1 NULL
3 NULL
NULL NULL

statement query II
select c-d as col1,
       b-c as col2
from t1
where d>e
    or c>d
    or a>b
order by col2,col1;

----
1 -4
NULL -4
1 -3
2 -3
1 -2
1 -2
NULL -2
-3 -1
-2 -1
-1 -1
2 -1
2 -1
NULL -1
-2 1
1 1
3 1
NULL 1
NULL 1
-1 2
1 2
1 2
-1 3
-1 3
NULL 3
-3 4
1 NULL
3 NULL
NULL NULL

statement query II
select c-d as col1,
       b-c as col2
from t1
where d>e
    or a>b
    or c>d
order by col2,col1;

----
1 -4
NULL -4
1 -3
2 -3
1 -2
1 -2
NULL -2
-3 -1
-2 -1
-1 -1
2 -1
2 -1
NULL -1
-2 1
1 1
3 1
NULL 1
NULL 1
-1 2
1 2
1 2
-1 3
-1 3
NULL 3
-3 4
1 NULL
3 NULL
NULL NULL

statement query II
select c-d as col1,
       b-c as col2
from t1
where d>e
    or a>b
    or c>d
order by col1,col2;

----
-3 -1
-3 4
-2 -1
-2 1
-1 -1
-1 2
-1 3
-1 3
1 -4
1 -3
1 -2
1 -2
1 1
1 2
1 2
1 NULL
2 -3
2 -1
2 -1
3 1
3 NULL
NULL -4
NULL -2
NULL -1
NULL 1
NULL 1
NULL 3
NULL NULL

statement query TI
select abs(b-c) as col1,
       a as col2
from t1
where c>d
order by col2,col1;

----
NULL 104
NULL 115
1 121
4 131
2 138
2 142
2 174
3 182
1 188
1 191
3 213
1 220
2 NULL

statement query II
select abs(b-c) as col1,
       a as col2
from t1
where c>d
order by col1,col2;

----
1 121
1 188
1 191
1 220
2 138
2 142
2 174
2 NULL
3 182
3 213
4 131
NULL 104
NULL 115

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and b>c
order by col4,col5,col2,col3,col1;

----
2 0 138 2046 137
2 0 142 2131 141
1 0 234 3473 231
2 0 245 3706 247

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and b>c
order by col3,col1,col5,col4,col2;

----
2 0 138 2046 137
2 0 142 2131 141
1 0 234 3473 231
2 0 245 3706 247

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where (e>c or e<d)
   and b>c
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
2 0 138 2046 137
2 0 142 2131 141
1 0 234 3473 231
2 0 245 3706 247

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where (e>c or e<d)
   and b>c
   and c between b-2 and d+2
order by col3,col5,col4,col2,col1;

----
2 0 138 2046 137
2 0 142 2131 141
1 0 234 3473 231
2 0 245 3706 247

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where b>c
   and (e>c or e<d)
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
2 0 138 2046 137
2 0 142 2131 141
1 0 234 3473 231
2 0 245 3706 247

statement query IIIII
select b-c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       c as col5
from t1
where b>c
   and (e>c or e<d)
   and c between b-2 and d+2
order by col1,col3,col4,col5,col2;

----
1 0 234 3473 231
2 0 138 2046 137
2 0 142 2131 141
2 0 245 3706 247

statement query III
select b-c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where e+d between a+b-10 and c+130
order by col2,col3,col1;

----
4 222 1902
-1 333 1612

statement query III
select b-c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where e+d between a+b-10 and c+130
order by col3,col1,col2;

----
-1 333 1612
4 222 1902

statement query FIIIIII
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a as col3,
       d as col4,
       a+b*2+c*3 as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col7,col4,col5,col2,col3,col1;

----
247.0 490 245 248 1484 111 -4
NULL 1240 121 122 738 222 -3
192.0 382 191 190 1158 222 -3
222.0 440 220 222 1338 222 -3
127.0 1290 127 128 760 222 -2
217.0 432 216 217 1297 222 -2
137.0 1390 138 136 827 222 -1
142.0 1430 142 140 851 222 -1
132.0 1300 131 133 793 333 1
182.0 364 182 183 1096 333 1
197.0 398 199 196 1180 333 1
227.0 458 229 226 1360 333 1
NULL 1580 159 NULL 940 333 1
NULL 1670 168 NULL 1000 333 1
107.0 1050 107 108 635 333 2
187.0 376 188 185 1121 333 2
212.0 426 213 212 1277 333 2
232.0 468 234 233 1391 333 2
NULL 1510 153 NULL 905 333 2
162.0 1600 163 164 966 444 3
NULL 2360 239 238 NULL 444 3
NULL 486 243 NULL 1455 444 3
172.0 1700 174 171 1030 444 4
NULL 1450 149 NULL 880 444 4
NULL 358 179 NULL 1057 444 4
NULL NULL 104 101 NULL 444 NULL
NULL 1120 NULL 114 NULL 444 NULL
NULL NULL 115 116 NULL 444 NULL
NULL 402 201 203 NULL 444 NULL
NULL NULL NULL 207 NULL 444 NULL

statement query TTIITIT
select (a+b+c+d+e)/5 as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a as col3,
       d as col4,
       a+b*2+c*3 as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a-b as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col3,col1,col5,col2,col6,col4,col7;

----
NULL NULL 104 101 NULL 444 NULL
107.0 1050 107 108 635 333 2
NULL NULL 115 116 NULL 444 NULL
NULL 1240 121 122 738 222 -3
127.0 1290 127 128 760 222 -2
132.0 1300 131 133 793 333 1
137.0 1390 138 136 827 222 -1
142.0 1430 142 140 851 222 -1
NULL 1450 149 NULL 880 444 4
NULL 1510 153 NULL 905 333 2
NULL 1580 159 NULL 940 333 1
162.0 1600 163 164 966 444 3
NULL 1670 168 NULL 1000 333 1
172.0 1700 174 171 1030 444 4
NULL 358 179 NULL 1057 444 4
182.0 364 182 183 1096 333 1
187.0 376 188 185 1121 333 2
192.0 382 191 190 1158 222 -3
197.0 398 199 196 1180 333 1
NULL 402 201 203 NULL 444 NULL
212.0 426 213 212 1277 333 2
217.0 432 216 217 1297 222 -2
222.0 440 220 222 1338 222 -3
227.0 458 229 226 1360 333 1
232.0 468 234 233 1391 333 2
NULL 2360 239 238 NULL 444 3
NULL 486 243 NULL 1455 444 3
247.0 490 245 248 1484 111 -4
NULL 1120 NULL 114 NULL 444 NULL
NULL NULL NULL 207 NULL 444 NULL

statement query ITITTI
select a as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2 as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       abs(a) as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
104 NULL 444 NULL NULL 104
107 1067 333 317 1612 107
115 NULL 444 NULL NULL 115
121 1226 222 369 NULL 121
127 1272 222 385 1902 127
131 1325 333 391 1985 131
138 1371 222 416 2046 138
142 1411 222 428 2131 142
149 NULL 444 439 NULL 149
153 NULL 333 455 NULL 153
159 NULL 333 475 NULL 159
163 1622 444 483 2432 163
168 NULL 333 502 NULL 168
174 1714 444 514 2579 174
179 NULL 444 529 NULL 179
182 1828 333 544 2728 182
188 1861 333 560 2806 188
191 1918 222 579 2878 191
199 1964 333 595 2949 199
201 NULL 444 NULL NULL 201
213 2125 333 635 3175 213
216 2165 222 652 3260 216
220 2226 222 666 3331 220
229 2264 333 685 3399 229
234 2323 333 698 3473 234
239 NULL 444 711 NULL 239
243 NULL 444 723 NULL 243
245 2476 111 743 3706 245
NULL NULL 444 NULL NULL NULL
NULL NULL 444 NULL NULL NULL

statement query IIIIII
select a as col1,
       a+b*2+c*3+d*4 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2 as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       abs(a) as col6
from t1
order by col2,col6,col1,col4,col3,col5;

----
107 1067 333 317 1612 107
121 1226 222 369 NULL 121
127 1272 222 385 1902 127
131 1325 333 391 1985 131
138 1371 222 416 2046 138
142 1411 222 428 2131 142
163 1622 444 483 2432 163
174 1714 444 514 2579 174
182 1828 333 544 2728 182
188 1861 333 560 2806 188
191 1918 222 579 2878 191
199 1964 333 595 2949 199
213 2125 333 635 3175 213
216 2165 222 652 3260 216
220 2226 222 666 3331 220
229 2264 333 685 3399 229
234 2323 333 698 3473 234
245 2476 111 743 3706 245
104 NULL 444 NULL NULL 104
115 NULL 444 NULL NULL 115
149 NULL 444 439 NULL 149
153 NULL 333 455 NULL 153
159 NULL 333 475 NULL 159
168 NULL 333 502 NULL 168
179 NULL 444 529 NULL 179
201 NULL 444 NULL NULL 201
239 NULL 444 711 NULL 239
243 NULL 444 723 NULL 243
NULL NULL 444 NULL NULL NULL
NULL NULL 444 NULL NULL NULL

statement query TITII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       (a+b+c+d+e)/5 as col3,
       d as col4,
       a as col5
from t1
order by col4,col5,col2,col3,col1;

----
NULL 0 NULL 101 104
635 0 107.0 108 107
NULL 0 NULL 114 NULL
NULL 0 NULL 116 115
738 0 NULL 122 121
760 0 127.0 128 127
793 0 132.0 133 131
827 0 137.0 136 138
851 0 142.0 140 142
966 0 162.0 164 163
1030 0 172.0 171 174
1096 0 182.0 183 182
1121 0 187.0 185 188
1158 0 192.0 190 191
1180 0 197.0 196 199
NULL 0 NULL 203 201
NULL 0 NULL 207 NULL
1277 0 212.0 212 213
1297 0 217.0 217 216
1338 0 222.0 222 220
1360 0 227.0 226 229
1391 0 232.0 233 234
NULL 0 NULL 238 239
1484 0 247.0 248 245
880 0 NULL NULL 149
905 0 NULL NULL 153
940 0 NULL NULL 159
1000 0 NULL NULL 168
1057 0 NULL NULL 179
1455 0 NULL NULL 243

statement query TITII
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       (a+b+c+d+e)/5 as col3,
       d as col4,
       a as col5
from t1
order by col5,col3,col2,col4,col1;

----
NULL 0 NULL 101 104
635 0 107.0 108 107
NULL 0 NULL 116 115
738 0 NULL 122 121
760 0 127.0 128 127
793 0 132.0 133 131
827 0 137.0 136 138
851 0 142.0 140 142
880 0 NULL NULL 149
905 0 NULL NULL 153
940 0 NULL NULL 159
966 0 162.0 164 163
1000 0 NULL NULL 168
1030 0 172.0 171 174
1057 0 NULL NULL 179
1096 0 182.0 183 182
1121 0 187.0 185 188
1158 0 192.0 190 191
1180 0 197.0 196 199
NULL 0 NULL 203 201
1277 0 212.0 212 213
1297 0 217.0 217 216
1338 0 222.0 222 220
1360 0 227.0 226 229
1391 0 232.0 233 234
NULL 0 NULL 238 239
1455 0 NULL NULL 243
1484 0 247.0 248 245
NULL 0 NULL 114 NULL
NULL 0 NULL 207 NULL

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a-b as col2
from t1
where d>e
order by col2,col1;

----
0 -4
0 -3
0 -2
0 -1
0 1
0 1
0 2
0 2
0 3
0 3
0 NULL

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a-b as col2
from t1
where d>e
order by col2,col1;

----
0 -4
0 -3
0 -2
0 -1
0 1
0 1
0 2
0 2
0 3
0 3
0 NULL

statement query IIIIIII
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c as col5,
       d-e as col6,
       abs(a) as col7
from t1
where (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
3 2878 1 0 193 -2 191
2 3331 -1 0 224 1 220
-1 3706 2 0 247 2 245

statement query IIIIIII
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       c as col5,
       d-e as col6,
       abs(a) as col7
from t1
where (e>a and e<b)
order by col7,col4,col1,col6,col5,col2,col3;

----
3 2878 1 0 193 -2 191
2 3331 -1 0 224 1 220
-1 3706 2 0 247 2 245

statement query IIIIII
select c as col1,
       b-c as col2,
       a+b*2+c*3 as col3,
       abs(a) as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----
134 -4 793 131 1300 131
137 2 827 138 1390 138
141 2 851 142 1430 142
155 3 940 159 1580 159
166 1 1000 168 1670 168
184 -3 1096 182 364 182
195 3 1180 199 398 199
225 3 1360 229 458 229

statement query IIIIII
select c as col1,
       b-c as col2,
       a+b*2+c*3 as col3,
       abs(a) as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
order by col4,col1,col2,col3,col6,col5;

----
134 -4 793 131 1300 131
137 2 827 138 1390 138
141 2 851 142 1430 142
155 3 940 159 1580 159
166 1 1000 168 1670 168
184 -3 1096 182 364 182
195 3 1180 199 398 199
225 3 1360 229 458 229

statement query IIIIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       abs(b-c) as col3,
       d as col4,
       abs(a) as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       d-e as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
0 142 2 140 142 111 -4
0 138 2 136 138 111 1
0 201 NULL 203 201 222 -1
0 213 3 212 213 222 2
0 243 4 NULL 243 222 NULL
0 216 3 217 216 333 -2
0 107 1 108 107 333 -1
0 115 NULL 116 115 333 -1
0 127 4 128 127 333 2
0 163 1 164 163 333 2
0 182 3 183 182 333 3
0 121 1 122 121 333 NULL
0 188 1 185 188 444 -4
0 191 1 190 191 444 -2
0 131 4 133 131 444 1
0 220 1 222 220 444 1
0 245 2 248 245 444 2
0 174 2 171 174 555 -2
0 199 3 196 199 555 -1
0 229 3 226 229 555 -1
0 239 NULL 238 239 555 1
0 234 1 233 234 555 3
0 NULL 1 114 NULL 555 4
0 104 NULL 101 104 555 NULL
0 NULL 2 207 NULL 555 NULL
0 149 2 NULL 149 555 NULL
0 153 1 NULL 153 555 NULL
0 159 3 NULL 159 555 NULL
0 168 1 NULL 168 555 NULL
0 179 1 NULL 179 555 NULL

statement query IIIIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       abs(b-c) as col3,
       d as col4,
       abs(a) as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       d-e as col7
from t1
order by col3,col1,col5,col6,col4,col7,col2;

----
0 107 1 108 107 333 -1
0 121 1 122 121 333 NULL
0 153 1 NULL 153 555 NULL
0 163 1 164 163 333 2
0 168 1 NULL 168 555 NULL
0 179 1 NULL 179 555 NULL
0 188 1 185 188 444 -4
0 191 1 190 191 444 -2
0 220 1 222 220 444 1
0 234 1 233 234 555 3
0 NULL 1 114 NULL 555 4
0 138 2 136 138 111 1
0 142 2 140 142 111 -4
0 149 2 NULL 149 555 NULL
0 174 2 171 174 555 -2
0 245 2 248 245 444 2
0 NULL 2 207 NULL 555 NULL
0 159 3 NULL 159 555 NULL
0 182 3 183 182 333 3
0 199 3 196 199 555 -1
0 213 3 212 213 222 2
0 216 3 217 216 333 -2
0 229 3 226 229 555 -1
0 127 4 128 127 333 2
0 131 4 133 131 444 1
0 243 4 NULL 243 222 NULL
0 104 NULL 101 104 555 NULL
0 115 NULL 116 115 333 -1
0 201 NULL 203 201 222 -1
0 239 NULL 238 239 555 1

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where b>c
    or a>b
    or (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
1 1371 2 111 138
1 1411 2 111 142
2 2125 3 222 213
NULL NULL 4 222 243
-2 1067 1 333 107
3 NULL NULL 333 115
1 1226 1 333 121
-3 1272 4 333 127
-3 1622 1 333 163
1 1828 3 333 182
-2 2165 3 333 216
1 1325 4 444 131
2 1861 1 444 188
3 1918 1 444 191
2 2226 1 444 220
-1 2476 2 444 245
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
1 1714 2 555 174
NULL NULL 1 555 179
-1 1964 3 555 199
-1 2264 3 555 229
-2 2323 1 555 234
NULL NULL NULL 555 239

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where b>c
    or a>b
    or (c<=d-2 or c>=d+2)
order by col2,col4,col5,col3,col1;

----
-2 1067 1 333 107
1 1226 1 333 121
-3 1272 4 333 127
1 1325 4 444 131
1 1371 2 111 138
1 1411 2 111 142
-3 1622 1 333 163
1 1714 2 555 174
1 1828 3 333 182
2 1861 1 444 188
3 1918 1 444 191
-1 1964 3 555 199
2 2125 3 222 213
-2 2165 3 333 216
2 2226 1 444 220
-1 2264 3 555 229
-2 2323 1 555 234
-1 2476 2 444 245
NULL NULL 4 222 243
3 NULL NULL 333 115
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
NULL NULL 1 555 179
NULL NULL NULL 555 239

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where (c<=d-2 or c>=d+2)
    or a>b
    or b>c
order by col4,col5,col2,col3,col1;

----
1 1371 2 111 138
1 1411 2 111 142
2 2125 3 222 213
NULL NULL 4 222 243
-2 1067 1 333 107
3 NULL NULL 333 115
1 1226 1 333 121
-3 1272 4 333 127
-3 1622 1 333 163
1 1828 3 333 182
-2 2165 3 333 216
1 1325 4 444 131
2 1861 1 444 188
3 1918 1 444 191
2 2226 1 444 220
-1 2476 2 444 245
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
1 1714 2 555 174
NULL NULL 1 555 179
-1 1964 3 555 199
-1 2264 3 555 229
-2 2323 1 555 234
NULL NULL NULL 555 239

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where (c<=d-2 or c>=d+2)
    or a>b
    or b>c
order by col4,col5,col1,col2,col3;

----
1 1371 2 111 138
1 1411 2 111 142
2 2125 3 222 213
NULL NULL 4 222 243
-2 1067 1 333 107
3 NULL NULL 333 115
1 1226 1 333 121
-3 1272 4 333 127
-3 1622 1 333 163
1 1828 3 333 182
-2 2165 3 333 216
1 1325 4 444 131
2 1861 1 444 188
3 1918 1 444 191
2 2226 1 444 220
-1 2476 2 444 245
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
1 1714 2 555 174
NULL NULL 1 555 179
-1 1964 3 555 199
-1 2264 3 555 229
-2 2323 1 555 234
NULL NULL NULL 555 239

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where a>b
    or (c<=d-2 or c>=d+2)
    or b>c
order by col4,col5,col2,col3,col1;

----
1 1371 2 111 138
1 1411 2 111 142
2 2125 3 222 213
NULL NULL 4 222 243
-2 1067 1 333 107
3 NULL NULL 333 115
1 1226 1 333 121
-3 1272 4 333 127
-3 1622 1 333 163
1 1828 3 333 182
-2 2165 3 333 216
1 1325 4 444 131
2 1861 1 444 188
3 1918 1 444 191
2 2226 1 444 220
-1 2476 2 444 245
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
1 1714 2 555 174
NULL NULL 1 555 179
-1 1964 3 555 199
-1 2264 3 555 229
-2 2323 1 555 234
NULL NULL NULL 555 239

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4 as col2,
       abs(b-c) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       abs(a) as col5
from t1
where a>b
    or (c<=d-2 or c>=d+2)
    or b>c
order by col1,col5,col3,col4,col2;

----
-3 1272 4 333 127
-3 1622 1 333 163
-2 1067 1 333 107
-2 2165 3 333 216
-2 2323 1 555 234
-1 1964 3 555 199
-1 2264 3 555 229
-1 2476 2 444 245
1 1226 1 333 121
1 1325 4 444 131
1 1371 2 111 138
1 1411 2 111 142
1 1714 2 555 174
1 1828 3 333 182
2 1861 1 444 188
2 2125 3 222 213
2 2226 1 444 220
3 NULL NULL 333 115
3 1918 1 444 191
NULL NULL 2 555 149
NULL NULL 1 555 153
NULL NULL 3 555 159
NULL NULL 1 555 168
NULL NULL 1 555 179
NULL NULL NULL 555 239
NULL NULL 4 222 243

statement query IIIIIII
select d-e as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       d as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a+b*2+c*3+d*4 as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
2 3706 1484 248 26 111 2476
NULL NULL 738 122 2 222 1226
2 1902 760 128 3 222 1272
1 2046 827 136 5 222 1371
-4 2131 851 140 6 222 1411
-2 2878 1158 190 16 222 1918
-2 3260 1297 217 20 222 2165
1 3331 1338 222 21 222 2226
-1 1612 635 108 0 333 1067
1 1985 793 133 4 333 1325
3 2728 1096 183 14 333 1828
-4 2806 1121 185 15 333 1861
-1 2949 1180 196 17 333 1964
2 3175 1277 212 19 333 2125
-1 3399 1360 226 22 333 2264
3 3473 1391 233 23 333 2323
NULL NULL 905 NULL 8 333 NULL
NULL NULL 940 NULL 9 333 NULL
NULL NULL 1000 NULL 11 333 NULL
2 2432 966 164 10 444 1622
-2 2579 1030 171 12 444 1714
NULL NULL NULL 101 0 444 NULL
4 NULL NULL 114 1 444 NULL
-1 NULL NULL 116 0 444 NULL
-1 NULL NULL 203 0 444 NULL
NULL NULL NULL 207 18 444 NULL
1 NULL NULL 238 24 444 NULL
NULL NULL 880 NULL 7 444 NULL
NULL NULL 1057 NULL 13 444 NULL
NULL NULL 1455 NULL 25 444 NULL

statement query TTTIIIT
select d-e as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3 as col3,
       d as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6,
       a+b*2+c*3+d*4 as col7
from t1
order by col4,col3,col6,col7,col5,col2,col1;

----
NULL NULL NULL 101 0 444 NULL
-1 1612 635 108 0 333 1067
4 NULL NULL 114 1 444 NULL
-1 NULL NULL 116 0 444 NULL
NULL NULL 738 122 2 222 1226
2 1902 760 128 3 222 1272
1 1985 793 133 4 333 1325
1 2046 827 136 5 222 1371
-4 2131 851 140 6 222 1411
2 2432 966 164 10 444 1622
-2 2579 1030 171 12 444 1714
3 2728 1096 183 14 333 1828
-4 2806 1121 185 15 333 1861
-2 2878 1158 190 16 222 1918
-1 2949 1180 196 17 333 1964
-1 NULL NULL 203 0 444 NULL
NULL NULL NULL 207 18 444 NULL
2 3175 1277 212 19 333 2125
-2 3260 1297 217 20 222 2165
1 3331 1338 222 21 222 2226
-1 3399 1360 226 22 333 2264
3 3473 1391 233 23 333 2323
1 NULL NULL 238 24 444 NULL
2 3706 1484 248 26 111 2476
NULL NULL 880 NULL 7 444 NULL
NULL NULL 905 NULL 8 333 NULL
NULL NULL 940 NULL 9 333 NULL
NULL NULL 1000 NULL 11 333 NULL
NULL NULL 1057 NULL 13 444 NULL
NULL NULL 1455 NULL 25 444 NULL

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d-e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4 as col4,
       e as col5
from t1
order by col4,col5,col2,col3,col1;

----
0 -1 333 1067 109
2 NULL 222 1226 NULL
3 2 222 1272 126
4 1 333 1325 132
5 1 222 1371 135
6 -4 222 1411 144
10 2 444 1622 162
12 -2 444 1714 173
14 3 333 1828 180
15 -4 333 1861 189
16 -2 222 1918 192
17 -1 333 1964 197
19 2 333 2125 210
20 -2 222 2165 219
21 1 222 2226 221
22 -1 333 2264 227
23 3 333 2323 230
26 2 111 2476 246
1 4 444 NULL 110
0 -1 444 NULL 117
7 NULL 444 NULL 146
9 NULL 333 NULL 157
11 NULL 333 NULL 165
13 NULL 444 NULL 177
0 -1 444 NULL 204
24 1 444 NULL 237
8 NULL 333 NULL NULL
0 NULL 444 NULL NULL
18 NULL 444 NULL NULL
25 NULL 444 NULL NULL

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       d-e as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4 as col4,
       e as col5
from t1
order by col3,col5,col4,col1,col2;

----
26 2 111 2476 246
3 2 222 1272 126
5 1 222 1371 135
6 -4 222 1411 144
16 -2 222 1918 192
20 -2 222 2165 219
21 1 222 2226 221
2 NULL 222 1226 NULL
0 -1 333 1067 109
4 1 333 1325 132
9 NULL 333 NULL 157
11 NULL 333 NULL 165
14 3 333 1828 180
15 -4 333 1861 189
17 -1 333 1964 197
19 2 333 2125 210
22 -1 333 2264 227
23 3 333 2323 230
8 NULL 333 NULL NULL
1 4 444 NULL 110
0 -1 444 NULL 117
7 NULL 444 NULL 146
10 2 444 1622 162
12 -2 444 1714 173
13 NULL 444 NULL 177
0 -1 444 NULL 204
24 1 444 NULL 237
0 NULL 444 NULL NULL
18 NULL 444 NULL NULL
25 NULL 444 NULL NULL

statement query IIIIFI
select a+b*2+c*3 as col1,
       b-c as col2,
       abs(a) as col3,
       d as col4,
       (a+b+c+d+e)/5 as col5,
       b as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
635 -1 107 108 107.0 105
NULL -1 NULL 114 NULL 112
738 1 121 122 NULL 124
760 4 127 128 127.0 129
793 -4 131 133 132.0 130
827 2 138 136 137.0 139
851 2 142 140 142.0 143
880 -2 149 NULL NULL 145
905 1 153 NULL NULL 151
940 3 159 NULL NULL 158
966 -1 163 164 162.0 160
1000 1 168 NULL NULL 167
1030 -2 174 171 172.0 170
1057 -1 179 NULL NULL 175
1096 -3 182 183 182.0 181
1121 -1 188 185 187.0 186
1158 1 191 190 192.0 194
1180 3 199 196 197.0 198
NULL -2 NULL 207 NULL 206
1277 -3 213 212 212.0 211
1297 3 216 217 217.0 218
1338 -1 220 222 222.0 223
1360 3 229 226 227.0 228
1391 1 234 233 232.0 232
NULL NULL 239 238 NULL 236
1455 -4 243 NULL NULL 240
1484 2 245 248 247.0 249
NULL NULL 104 101 NULL NULL
NULL NULL 115 116 NULL NULL
NULL NULL 201 203 NULL NULL

statement query IIIIFI
select a+b*2+c*3 as col1,
       b-c as col2,
       abs(a) as col3,
       d as col4,
       (a+b+c+d+e)/5 as col5,
       b as col6
from t1
order by col1,col5,col3,col6,col4,col2;

----
635 -1 107 108 107.0 105
738 1 121 122 NULL 124
760 4 127 128 127.0 129
793 -4 131 133 132.0 130
827 2 138 136 137.0 139
851 2 142 140 142.0 143
880 -2 149 NULL NULL 145
905 1 153 NULL NULL 151
940 3 159 NULL NULL 158
966 -1 163 164 162.0 160
1000 1 168 NULL NULL 167
1030 -2 174 171 172.0 170
1057 -1 179 NULL NULL 175
1096 -3 182 183 182.0 181
1121 -1 188 185 187.0 186
1158 1 191 190 192.0 194
1180 3 199 196 197.0 198
1277 -3 213 212 212.0 211
1297 3 216 217 217.0 218
1338 -1 220 222 222.0 223
1360 3 229 226 227.0 228
1391 1 234 233 232.0 232
1455 -4 243 NULL NULL 240
1484 2 245 248 247.0 249
NULL NULL 104 101 NULL NULL
NULL NULL 115 116 NULL NULL
NULL NULL 201 203 NULL NULL
NULL NULL 239 238 NULL 236
NULL -1 NULL 114 NULL 112
NULL -2 NULL 207 NULL 206

statement query IIIII
select d as col1,
       a as col2,
       a+b*2+c*3 as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col4,col5,col2,col3,col1;

----
108 107 635 1067 1050
122 121 738 1226 1240
128 127 760 1272 1290
133 131 793 1325 1300
136 138 827 1371 1390
140 142 851 1411 1430
164 163 966 1622 1600
171 174 1030 1714 1700
183 182 1096 1828 364
185 188 1121 1861 376
190 191 1158 1918 382
196 199 1180 1964 398
212 213 1277 2125 426
217 216 1297 2165 432
222 220 1338 2226 440
226 229 1360 2264 458
233 234 1391 2323 468
248 245 1484 2476 490
NULL 179 1057 NULL 358
203 201 NULL NULL 402
NULL 243 1455 NULL 486
114 NULL NULL NULL 1120
NULL 149 880 NULL 1450
NULL 153 905 NULL 1510
NULL 159 940 NULL 1580
NULL 168 1000 NULL 1670
238 239 NULL NULL 2360
101 104 NULL NULL NULL
116 115 NULL NULL NULL
207 NULL NULL NULL NULL

statement query TIITI
select d as col1,
       a as col2,
       a+b*2+c*3 as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col3,col1,col2,col4;

----
NULL 179 1057 NULL 358
183 182 1096 1828 364
185 188 1121 1861 376
190 191 1158 1918 382
196 199 1180 1964 398
203 201 NULL NULL 402
212 213 1277 2125 426
217 216 1297 2165 432
222 220 1338 2226 440
226 229 1360 2264 458
233 234 1391 2323 468
NULL 243 1455 NULL 486
248 245 1484 2476 490
108 107 635 1067 1050
114 NULL NULL NULL 1120
122 121 738 1226 1240
128 127 760 1272 1290
133 131 793 1325 1300
136 138 827 1371 1390
140 142 851 1411 1430
NULL 149 880 NULL 1450
NULL 153 905 NULL 1510
NULL 159 940 NULL 1580
164 163 966 1622 1600
NULL 168 1000 NULL 1670
171 174 1030 1714 1700
238 239 NULL NULL 2360
101 104 NULL NULL NULL
116 115 NULL NULL NULL
207 NULL NULL NULL NULL

statement query IIIII
select d-e as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
   and c>d
order by col4,col5,col2,col3,col1;

----
2 3 222 -3 3175
-4 1 444 -1 2806
1 1 444 -1 3331
-2 1 444 1 2878
-1 NULL 333 NULL NULL

statement query IIIII
select d-e as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
   and c>d
order by col5,col1,col4,col2,col3;

----
-4 1 444 -1 2806
-2 1 444 1 2878
2 3 222 -3 3175
1 1 444 -1 3331
-1 NULL 333 NULL NULL

statement query IIIII
select d-e as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c>d
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
2 3 222 -3 3175
-4 1 444 -1 2806
1 1 444 -1 3331
-2 1 444 1 2878
-1 NULL 333 NULL NULL

statement query IIIII
select d-e as col1,
       abs(b-c) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       b-c as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c>d
   and (c<=d-2 or c>=d+2)
order by col1,col4,col3,col5,col2;

----
-4 1 444 -1 2806
-2 1 444 1 2878
-1 NULL 333 NULL NULL
1 1 444 -1 3331
2 3 222 -3 3175

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
107.0 108 333 635 1612
NULL 122 222 738 NULL
132.0 133 333 793 1985
137.0 136 222 827 2046
142.0 140 222 851 2131
NULL NULL 333 940 NULL
162.0 164 444 966 2432
NULL NULL 333 1000 NULL
172.0 171 444 1030 2579
182.0 183 333 1096 2728
187.0 185 333 1121 2806
197.0 196 333 1180 2949
212.0 212 333 1277 3175
222.0 222 222 1338 3331
227.0 226 333 1360 3399
232.0 233 333 1391 3473
247.0 248 111 1484 3706
NULL 114 444 NULL NULL
NULL 207 444 NULL NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
order by col1,col2,col4,col5,col3;

----
107.0 108 333 635 1612
132.0 133 333 793 1985
137.0 136 222 827 2046
142.0 140 222 851 2131
162.0 164 444 966 2432
172.0 171 444 1030 2579
182.0 183 333 1096 2728
187.0 185 333 1121 2806
197.0 196 333 1180 2949
212.0 212 333 1277 3175
222.0 222 222 1338 3331
227.0 226 333 1360 3399
232.0 233 333 1391 3473
247.0 248 111 1484 3706
NULL 114 444 NULL NULL
NULL 122 222 738 NULL
NULL 207 444 NULL NULL
NULL NULL 333 940 NULL
NULL NULL 333 1000 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
107.0 108 333 635 1612
NULL 122 222 738 NULL
132.0 133 333 793 1985
137.0 136 222 827 2046
142.0 140 222 851 2131
NULL NULL 333 940 NULL
162.0 164 444 966 2432
NULL NULL 333 1000 NULL
172.0 171 444 1030 2579
182.0 183 333 1096 2728
187.0 185 333 1121 2806
197.0 196 333 1180 2949
212.0 212 333 1277 3175
222.0 222 222 1338 3331
227.0 226 333 1360 3399
232.0 233 333 1391 3473
247.0 248 111 1484 3706
NULL 114 444 NULL NULL
NULL 207 444 NULL NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
order by col2,col3,col4,col5,col1;

----
107.0 108 333 635 1612
NULL 114 444 NULL NULL
NULL 122 222 738 NULL
132.0 133 333 793 1985
137.0 136 222 827 2046
142.0 140 222 851 2131
162.0 164 444 966 2432
172.0 171 444 1030 2579
182.0 183 333 1096 2728
187.0 185 333 1121 2806
197.0 196 333 1180 2949
NULL 207 444 NULL NULL
212.0 212 333 1277 3175
222.0 222 222 1338 3331
227.0 226 333 1360 3399
232.0 233 333 1391 3473
247.0 248 111 1484 3706
NULL NULL 333 940 NULL
NULL NULL 333 1000 NULL

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a>b
order by col2,col3,col1;

----
1050 635 -2
1290 760 -3
1300 793 1
1450 880 NULL
1510 905 NULL
1580 940 NULL
1600 966 -3
1670 1000 NULL
1700 1030 1
358 1057 NULL
364 1096 1
376 1121 2
398 1180 -1
426 1277 2
458 1360 -1
468 1391 -2
486 1455 NULL
2360 NULL NULL

statement query IIT
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a>b
order by col1,col2,col3;

----
358 1057 NULL
364 1096 1
376 1121 2
398 1180 -1
426 1277 2
458 1360 -1
468 1391 -2
486 1455 NULL
1050 635 -2
1290 760 -3
1300 793 1
1450 880 NULL
1510 905 NULL
1580 940 NULL
1600 966 -3
1670 1000 NULL
1700 1030 1
2360 NULL NULL

statement query III
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or e+d between a+b-10 and c+130
order by col2,col3,col1;

----
1050 635 -2
1290 760 -3
1300 793 1
1450 880 NULL
1510 905 NULL
1580 940 NULL
1600 966 -3
1670 1000 NULL
1700 1030 1
358 1057 NULL
364 1096 1
376 1121 2
398 1180 -1
426 1277 2
458 1360 -1
468 1391 -2
486 1455 NULL
2360 NULL NULL

statement query IIT
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or e+d between a+b-10 and c+130
order by col1,col3,col2;

----
358 1057 NULL
364 1096 1
376 1121 2
398 1180 -1
426 1277 2
458 1360 -1
468 1391 -2
486 1455 NULL
1050 635 -2
1290 760 -3
1300 793 1
1450 880 NULL
1510 905 NULL
1580 940 NULL
1600 966 -3
1670 1000 NULL
1700 1030 1
2360 NULL NULL

statement query IIIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b-c as col3,
       d as col4,
       c as col5,
       a+b*2+c*3+d*4 as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
0 1050 -1 108 106 1067
2 1240 1 122 123 1226
3 1290 4 128 125 1272
4 1300 -4 133 134 1325
5 1390 2 136 137 1371
6 1430 2 140 141 1411
10 1600 -1 164 161 1622
12 1700 -2 171 172 1714
14 364 -3 183 184 1828
15 376 -1 185 187 1861
16 382 1 190 193 1918
17 398 3 196 195 1964
19 426 -3 212 214 2125
20 432 3 217 215 2165
21 440 -1 222 224 2226
22 458 3 226 225 2264
23 468 1 233 231 2323
26 490 2 248 247 2476
0 NULL NULL 101 102 NULL
1 1120 -1 114 113 NULL
0 NULL NULL 116 119 NULL
0 402 NULL 203 202 NULL
18 NULL -2 207 208 NULL
24 2360 NULL 238 NULL NULL
7 1450 -2 NULL 147 NULL
8 1510 1 NULL 150 NULL
9 1580 3 NULL 155 NULL
11 1670 1 NULL 166 NULL
13 358 -1 NULL 176 NULL
25 486 -4 NULL 244 NULL

statement query ITTIIT
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       b-c as col3,
       d as col4,
       c as col5,
       a+b*2+c*3+d*4 as col6
from t1
order by col4,col3,col5,col2,col6,col1;

----
0 NULL NULL 101 102 NULL
0 1050 -1 108 106 1067
1 1120 -1 114 113 NULL
0 NULL NULL 116 119 NULL
2 1240 1 122 123 1226
3 1290 4 128 125 1272
4 1300 -4 133 134 1325
5 1390 2 136 137 1371
6 1430 2 140 141 1411
10 1600 -1 164 161 1622
12 1700 -2 171 172 1714
14 364 -3 183 184 1828
15 376 -1 185 187 1861
16 382 1 190 193 1918
17 398 3 196 195 1964
0 402 NULL 203 202 NULL
18 NULL -2 207 208 NULL
19 426 -3 212 214 2125
20 432 3 217 215 2165
21 440 -1 222 224 2226
22 458 3 226 225 2264
23 468 1 233 231 2323
24 2360 NULL 238 NULL NULL
26 490 2 248 247 2476
25 486 -4 NULL 244 NULL
7 1450 -2 NULL 147 NULL
13 358 -1 NULL 176 NULL
8 1510 1 NULL 150 NULL
11 1670 1 NULL 166 NULL
9 1580 3 NULL 155 NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from t1
where (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1;

----
555 1180 1964 -1
555 1360 2264 -1
444 793 1325 1
111 827 1371 1
111 851 1411 1
333 1096 1828 1
555 940 NULL NULL
555 1000 NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from t1
where (a>b-2 and a<b+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col1,col4,col2;

----
444 793 1325 1
111 827 1371 1
111 851 1411 1
333 1096 1828 1
555 1180 1964 -1
555 1360 2264 -1
555 940 NULL NULL
555 1000 NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
555 1180 1964 -1
555 1360 2264 -1
444 793 1325 1
111 827 1371 1
111 851 1411 1
333 1096 1828 1
555 940 NULL NULL
555 1000 NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (a>b-2 and a<b+2)
order by col1,col2,col4,col3;

----
111 827 1371 1
111 851 1411 1
333 1096 1828 1
444 793 1325 1
555 940 NULL NULL
555 1000 NULL NULL
555 1180 1964 -1
555 1360 2264 -1

statement query IIIIF
select b-c as col1,
       abs(b-c) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col5,col2,col3,col1;

----
-1 1 333 1612 107.0
4 4 222 1902 127.0
-4 4 333 1985 132.0
2 2 222 2046 137.0
2 2 222 2131 142.0
-1 1 444 2432 162.0
-2 2 444 2579 172.0
-3 3 333 2728 182.0
-1 1 333 2806 187.0
1 1 222 2878 192.0
3 3 333 2949 197.0
-3 3 333 3175 212.0
3 3 222 3260 217.0
-1 1 222 3331 222.0
3 3 333 3399 227.0
1 1 333 3473 232.0
2 2 111 3706 247.0
1 1 222 NULL NULL
1 1 333 NULL NULL
1 1 333 NULL NULL
-1 1 444 NULL NULL
-1 1 444 NULL NULL
-2 2 444 NULL NULL
-2 2 444 NULL NULL
3 3 333 NULL NULL
-4 4 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL

statement query IIIIF
select b-c as col1,
       abs(b-c) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col2,col5,col1,col3;

----
-1 1 333 1612 107.0
4 4 222 1902 127.0
-4 4 333 1985 132.0
2 2 222 2046 137.0
2 2 222 2131 142.0
-1 1 444 2432 162.0
-2 2 444 2579 172.0
-3 3 333 2728 182.0
-1 1 333 2806 187.0
1 1 222 2878 192.0
3 3 333 2949 197.0
-3 3 333 3175 212.0
3 3 222 3260 217.0
-1 1 222 3331 222.0
3 3 333 3399 227.0
1 1 333 3473 232.0
2 2 111 3706 247.0
-1 1 444 NULL NULL
-1 1 444 NULL NULL
1 1 222 NULL NULL
1 1 333 NULL NULL
1 1 333 NULL NULL
-2 2 444 NULL NULL
-2 2 444 NULL NULL
3 3 333 NULL NULL
-4 4 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL
NULL NULL 444 NULL NULL

statement query IIIIIIF
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
   and (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
26 1484 3706 245 444 -1 247.0
16 1158 2878 191 444 3 192.0

statement query IIIIIIF
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
   and (e>a and e<b)
order by col2,col1,col3,col4,col5,col6,col7;

----
16 1158 2878 191 444 3 192.0
26 1484 3706 245 444 -1 247.0

statement query IIIIIIF
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>a and e<b)
   and b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
26 1484 3706 245 444 -1 247.0
16 1158 2878 191 444 3 192.0

statement query IIIIIIF
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5,
       c-d as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>a and e<b)
   and b>c
order by col2,col7,col3,col5,col4,col6,col1;

----
16 1158 2878 191 444 3 192.0
26 1484 3706 245 444 -1 247.0

statement query IIIFII
select a+b*2+c*3 as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5,
       d as col6
from t1
where c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
635 -1 333 107.0 -2 108
NULL -1 444 NULL -1 114
738 1 222 NULL 1 122
793 -4 333 132.0 1 133
827 2 222 137.0 1 136
851 2 222 142.0 1 140
966 -1 444 162.0 -3 164
1030 -2 444 172.0 1 171
1096 -3 333 182.0 1 183
1121 -1 333 187.0 2 185
NULL -2 444 NULL 1 207
1277 -3 333 212.0 2 212
1338 -1 222 222.0 2 222
1391 1 333 232.0 -2 233
1484 2 111 247.0 -1 248

statement query IIIFII
select a+b*2+c*3 as col1,
       b-c as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5,
       d as col6
from t1
where c between b-2 and d+2
order by col1,col2,col5,col3,col6,col4;

----
635 -1 333 107.0 -2 108
738 1 222 NULL 1 122
793 -4 333 132.0 1 133
827 2 222 137.0 1 136
851 2 222 142.0 1 140
966 -1 444 162.0 -3 164
1030 -2 444 172.0 1 171
1096 -3 333 182.0 1 183
1121 -1 333 187.0 2 185
1277 -3 333 212.0 2 212
1338 -1 222 222.0 2 222
1391 1 333 232.0 -2 233
1484 2 111 247.0 -1 248
NULL -2 444 NULL 1 207
NULL -1 444 NULL -1 114

statement query IIIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       b-c as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       c-d as col5,
       d-e as col6,
       case when c>avg_c then a*2 else b*10 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col6,col7,col4,col5,col2,col3,col1;

----
2806 -1 188 444 2 -4 376
2131 2 142 111 1 -4 1430
3260 3 216 333 -2 -2 432
2579 -2 174 555 1 -2 1700
2949 3 199 555 -1 -1 398
NULL NULL 201 222 -1 -1 402
3399 3 229 555 -1 -1 458
1612 -1 107 333 -2 -1 1050
3331 -1 220 444 2 1 440
1985 -4 131 444 1 1 1300
2046 2 138 111 1 1 1390
NULL NULL 239 555 NULL 1 2360
3175 -3 213 222 2 2 426
3706 2 245 444 -1 2 490
1902 4 127 333 -3 2 1290
2432 -1 163 333 -3 2 1600
2728 -3 182 333 1 3 364
3473 1 234 555 -2 3 468
NULL -1 NULL 555 -1 4 1120
NULL -1 179 555 NULL NULL 358
NULL 3 159 555 NULL NULL 1580

statement query IIIIIII
select a+b*2+c*3+d*4+e*5 as col1,
       b-c as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       c-d as col5,
       d-e as col6,
       case when c>avg_c then a*2 else b*10 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col4,col2,col6,col3,col5,col7,col1;

----
2131 2 142 111 1 -4 1430
2046 2 138 111 1 1 1390
3175 -3 213 222 2 2 426
NULL NULL 201 222 -1 -1 402
2728 -3 182 333 1 3 364
1612 -1 107 333 -2 -1 1050
2432 -1 163 333 -3 2 1600
3260 3 216 333 -2 -2 432
1902 4 127 333 -3 2 1290
1985 -4 131 444 1 1 1300
2806 -1 188 444 2 -4 376
3331 -1 220 444 2 1 440
3706 2 245 444 -1 2 490
2579 -2 174 555 1 -2 1700
NULL -1 NULL 555 -1 4 1120
NULL -1 179 555 NULL NULL 358
3473 1 234 555 -2 3 468
2949 3 199 555 -1 -1 398
3399 3 229 555 -1 -1 458
NULL 3 159 555 NULL NULL 1580
NULL NULL 239 555 NULL 1 2360

statement query II
select b-c as col1,
       a+b*2+c*3 as col2
from t1
order by col2,col1;

----
-1 635
1 738
4 760
-4 793
2 827
2 851
-2 880
1 905
3 940
-1 966
1 1000
-2 1030
-1 1057
-3 1096
-1 1121
1 1158
3 1180
-3 1277
3 1297
-1 1338
3 1360
1 1391
-4 1455
2 1484
-2 NULL
-1 NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL

statement query II
select b-c as col1,
       a+b*2+c*3 as col2
from t1
order by col2,col1;

----
-1 635
1 738
4 760
-4 793
2 827
2 851
-2 880
1 905
3 940
-1 966
1 1000
-2 1030
-1 1057
-3 1096
-1 1121
1 1158
3 1180
-3 1277
3 1297
-1 1338
3 1360
1 1391
-4 1455
2 1484
-2 NULL
-1 NULL
NULL NULL
NULL NULL
NULL NULL
NULL NULL

statement query TTTII
select d-e as col1,
       e as col2,
       a-b as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       d as col5
from t1
order by col4,col5,col2,col3,col1;

----
NULL NULL NULL 0 101
-1 109 2 0 108
-1 117 NULL 0 116
-1 204 NULL 0 203
4 110 NULL 1 114
NULL NULL -3 2 122
2 126 -2 3 128
1 132 1 4 133
1 135 -1 5 136
-4 144 -1 6 140
NULL 146 4 7 NULL
NULL NULL 2 8 NULL
NULL 157 1 9 NULL
2 162 3 10 164
NULL 165 1 11 NULL
-2 173 4 12 171
NULL 177 4 13 NULL
3 180 1 14 183
-4 189 2 15 185
-2 192 -3 16 190
-1 197 1 17 196
NULL NULL NULL 18 207
2 210 2 19 212
-2 219 -2 20 217
1 221 -3 21 222
-1 227 1 22 226
3 230 2 23 233
1 237 3 24 238
NULL NULL 3 25 NULL
2 246 -4 26 248

statement query IIIII
select d-e as col1,
       e as col2,
       a-b as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       d as col5
from t1
order by col2,col1,col4,col5,col3;

----
-1 109 2 0 108
4 110 NULL 1 114
-1 117 NULL 0 116
2 126 -2 3 128
1 132 1 4 133
1 135 -1 5 136
-4 144 -1 6 140
NULL 146 4 7 NULL
NULL 157 1 9 NULL
2 162 3 10 164
NULL 165 1 11 NULL
-2 173 4 12 171
NULL 177 4 13 NULL
3 180 1 14 183
-4 189 2 15 185
-2 192 -3 16 190
-1 197 1 17 196
-1 204 NULL 0 203
2 210 2 19 212
-2 219 -2 20 217
1 221 -3 21 222
-1 227 1 22 226
3 230 2 23 233
1 237 3 24 238
2 246 -4 26 248
NULL NULL NULL 0 101
NULL NULL -3 2 122
NULL NULL 2 8 NULL
NULL NULL NULL 18 207
NULL NULL 3 25 NULL

statement query IITI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3+d*4 as col3,
       b-c as col4
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1;

----
444 222 NULL -4
333 444 1325 -4
333 222 2125 -3
333 333 1828 -3
444 555 1714 -2
444 555 NULL -2
444 555 NULL -2
333 333 1067 -1
444 333 1622 -1
333 444 1861 -1
222 444 2226 -1
444 555 NULL -1
444 555 NULL -1
222 333 1226 1
222 444 1918 1
333 555 2323 1
333 555 NULL 1
333 555 NULL 1
222 111 1371 2
222 111 1411 2
111 444 2476 2
222 333 2165 3
333 555 1964 3
333 555 2264 3
333 555 NULL 3
222 333 1272 4
444 222 NULL NULL
444 555 NULL NULL
444 555 NULL NULL

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3+d*4 as col3,
       b-c as col4
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col4,col2,col3;

----
111 444 2476 2
222 444 2226 -1
222 333 1226 1
222 444 1918 1
222 111 1371 2
222 111 1411 2
222 333 2165 3
222 333 1272 4
333 444 1325 -4
333 222 2125 -3
333 333 1828 -3
333 333 1067 -1
333 444 1861 -1
333 555 2323 1
333 555 NULL 1
333 555 NULL 1
333 555 1964 3
333 555 2264 3
333 555 NULL 3
444 222 NULL -4
444 555 1714 -2
444 555 NULL -2
444 555 NULL -2
444 333 1622 -1
444 555 NULL -1
444 555 NULL -1
444 222 NULL NULL
444 555 NULL NULL
444 555 NULL NULL

statement query IFIII
select a-b as col1,
       (a+b+c+d+e)/5 as col2,
       b as col3,
       e as col4,
       b-c as col5
from t1
order by col4,col5,col2,col3,col1;

----
2 107.0 105 109 -1
NULL NULL 112 110 -1
NULL NULL NULL 117 NULL
-2 127.0 129 126 4
1 132.0 130 132 -4
-1 137.0 139 135 2
-1 142.0 143 144 2
4 NULL 145 146 -2
1 NULL 158 157 3
3 162.0 160 162 -1
1 NULL 167 165 1
4 172.0 170 173 -2
4 NULL 175 177 -1
1 182.0 181 180 -3
2 187.0 186 189 -1
-3 192.0 194 192 1
1 197.0 198 197 3
NULL NULL NULL 204 NULL
2 212.0 211 210 -3
-2 217.0 218 219 3
-3 222.0 223 221 -1
1 227.0 228 227 3
2 232.0 232 230 1
3 NULL 236 237 NULL
-4 247.0 249 246 2
3 NULL 240 NULL -4
NULL NULL 206 NULL -2
-3 NULL 124 NULL 1
2 NULL 151 NULL 1
NULL NULL NULL NULL NULL

statement query IFIII
select a-b as col1,
       (a+b+c+d+e)/5 as col2,
       b as col3,
       e as col4,
       b-c as col5
from t1
order by col3,col5,col4,col2,col1;

----
2 107.0 105 109 -1
NULL NULL 112 110 -1
-3 NULL 124 NULL 1
-2 127.0 129 126 4
1 132.0 130 132 -4
-1 137.0 139 135 2
-1 142.0 143 144 2
4 NULL 145 146 -2
2 NULL 151 NULL 1
1 NULL 158 157 3
3 162.0 160 162 -1
1 NULL 167 165 1
4 172.0 170 173 -2
4 NULL 175 177 -1
1 182.0 181 180 -3
2 187.0 186 189 -1
-3 192.0 194 192 1
1 197.0 198 197 3
NULL NULL 206 NULL -2
2 212.0 211 210 -3
-2 217.0 218 219 3
-3 222.0 223 221 -1
1 227.0 228 227 3
2 232.0 232 230 1
3 NULL 236 237 NULL
3 NULL 240 NULL -4
-4 247.0 249 246 2
NULL NULL NULL 117 NULL
NULL NULL NULL 204 NULL
NULL NULL NULL NULL NULL

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c between b-2 and d+2
   and d>e
   and c>d
order by col2,col3,col1;

----
222.0 1 2226
137.0 2 1371
182.0 3 1828
212.0 3 2125
132.0 4 1325

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c between b-2 and d+2
   and d>e
   and c>d
order by col2,col1,col3;

----
222.0 1 2226
137.0 2 1371
182.0 3 1828
212.0 3 2125
132.0 4 1325

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c>d
   and d>e
   and c between b-2 and d+2
order by col2,col3,col1;

----
222.0 1 2226
137.0 2 1371
182.0 3 1828
212.0 3 2125
132.0 4 1325

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c>d
   and d>e
   and c between b-2 and d+2
order by col1,col3,col2;

----
132.0 4 1325
137.0 2 1371
182.0 3 1828
212.0 3 2125
222.0 1 2226

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c>d
   and c between b-2 and d+2
   and d>e
order by col2,col3,col1;

----
222.0 1 2226
137.0 2 1371
182.0 3 1828
212.0 3 2125
132.0 4 1325

statement query FII
select (a+b+c+d+e)/5 as col1,
       abs(b-c) as col2,
       a+b*2+c*3+d*4 as col3
from t1
where c>d
   and c between b-2 and d+2
   and d>e
order by col1,col2,col3;

----
132.0 4 1325
137.0 2 1371
182.0 3 1828
212.0 3 2125
222.0 1 2226

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where c>d
   and c between b-2 and d+2
   and (e>c or e<d)
order by col2,col1;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where c>d
   and c between b-2 and d+2
   and (e>c or e<d)
order by col1,col2;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where (e>c or e<d)
   and c>d
   and c between b-2 and d+2
order by col2,col1;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where (e>c or e<d)
   and c>d
   and c between b-2 and d+2
order by col2,col1;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and c>d
order by col2,col1;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query II
select a+b*2+c*3+d*4 as col1,
       d as col2
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and c>d
order by col2,col1;

----
1325 133
1371 136
1411 140
1714 171
1828 183
1861 185
2125 212
2226 222

statement query IIIIII
select abs(a) as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
127 1272 3 222 1290 -3
107 1067 0 333 1050 -2

statement query IIIIII
select abs(a) as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
order by col1,col2,col4,col5,col3,col6;

----
107 1067 0 333 1050 -2
127 1272 3 222 1290 -3

statement query IFI
select a as col1,
       (a+b+c+d+e)/5 as col2,
       a-b as col3
from t1
where a>b
order by col2,col3,col1;

----
107 107.0 2
131 132.0 1
163 162.0 3
174 172.0 4
182 182.0 1
188 187.0 2
199 197.0 1
213 212.0 2
229 227.0 1
234 232.0 2
159 NULL 1
168 NULL 1
153 NULL 2
239 NULL 3
243 NULL 3
149 NULL 4
179 NULL 4

statement query IFI
select a as col1,
       (a+b+c+d+e)/5 as col2,
       a-b as col3
from t1
where a>b
order by col2,col3,col1;

----
107 107.0 2
131 132.0 1
163 162.0 3
174 172.0 4
182 182.0 1
188 187.0 2
199 197.0 1
213 212.0 2
229 227.0 1
234 232.0 2
159 NULL 1
168 NULL 1
153 NULL 2
239 NULL 3
243 NULL 3
149 NULL 4
179 NULL 4

statement query III
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b as col3
from t1
where (e>a and e<b)
   and d not between 110 and 150
order by col2,col3,col1;

----
3 444 194
2 444 223
-1 444 249

statement query III
select c-d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b as col3
from t1
where (e>a and e<b)
   and d not between 110 and 150
order by col1,col2,col3;

----
-1 444 249
2 444 223
3 444 194

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       c-d as col2
from t1
order by col2,col1;

----
3 -3
10 -3
0 -2
20 -2
23 -2
0 -1
1 -1
17 -1
22 -1
26 -1
0 1
2 1
4 1
5 1
6 1
12 1
14 1
18 1
15 2
19 2
21 2
0 3
16 3
7 NULL
8 NULL
9 NULL
11 NULL
13 NULL
24 NULL
25 NULL

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       c-d as col2
from t1
order by col2,col1;

----
3 -3
10 -3
0 -2
20 -2
23 -2
0 -1
1 -1
17 -1
22 -1
26 -1
0 1
2 1
4 1
5 1
6 1
12 1
14 1
18 1
15 2
19 2
21 2
0 3
16 3
7 NULL
8 NULL
9 NULL
11 NULL
13 NULL
24 NULL
25 NULL

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
333 444 0 132.0 1
222 111 0 137.0 1
222 111 0 142.0 1
444 555 0 172.0 1
333 333 0 182.0 1
333 444 0 187.0 2
333 222 0 212.0 2
222 444 0 222.0 2
222 333 0 NULL 1
444 555 0 NULL 1

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
order by col2,col3,col4,col5,col1;

----
222 111 0 137.0 1
222 111 0 142.0 1
333 222 0 212.0 2
333 333 0 182.0 1
222 333 0 NULL 1
333 444 0 132.0 1
333 444 0 187.0 2
222 444 0 222.0 2
444 555 0 172.0 1
444 555 0 NULL 1

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where c between b-2 and d+2
   and c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
333 444 0 132.0 1
222 111 0 137.0 1
222 111 0 142.0 1
444 555 0 172.0 1
333 333 0 182.0 1
333 444 0 187.0 2
333 222 0 212.0 2
222 444 0 222.0 2
222 333 0 NULL 1
444 555 0 NULL 1

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where c between b-2 and d+2
   and c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col4,col5,col3,col2;

----
222 111 0 137.0 1
222 111 0 142.0 1
222 444 0 222.0 2
222 333 0 NULL 1
333 444 0 132.0 1
333 333 0 182.0 1
333 444 0 187.0 2
333 222 0 212.0 2
444 555 0 172.0 1
444 555 0 NULL 1

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
   and c>d
order by col4,col5,col2,col3,col1;

----
333 444 0 132.0 1
222 111 0 137.0 1
222 111 0 142.0 1
444 555 0 172.0 1
333 333 0 182.0 1
333 444 0 187.0 2
333 222 0 212.0 2
222 444 0 222.0 2
222 333 0 NULL 1
444 555 0 NULL 1

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       c-d as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
   and c>d
order by col1,col2,col4,col5,col3;

----
222 111 0 137.0 1
222 111 0 142.0 1
222 333 0 NULL 1
222 444 0 222.0 2
333 222 0 212.0 2
333 333 0 182.0 1
333 444 0 132.0 1
333 444 0 187.0 2
444 555 0 172.0 1
444 555 0 NULL 1

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where d>e
    or c between b-2 and d+2
    or (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
1067 635 333 109 0 105 -1
NULL NULL 555 110 1 112 -1
1226 738 333 NULL 2 124 1
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
NULL NULL 555 NULL 18 206 -2
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
NULL NULL 555 237 24 236 NULL
2476 1484 444 246 26 249 2
NULL NULL 333 117 0 NULL NULL

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where d>e
    or c between b-2 and d+2
    or (c<=d-2 or c>=d+2)
order by col1,col5,col2,col3,col4,col6,col7;

----
1067 635 333 109 0 105 -1
1226 738 333 NULL 2 124 1
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
2476 1484 444 246 26 249 2
NULL NULL 333 117 0 NULL NULL
NULL NULL 555 110 1 112 -1
NULL NULL 555 NULL 18 206 -2
NULL NULL 555 237 24 236 NULL

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
    or c between b-2 and d+2
    or d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
1067 635 333 109 0 105 -1
NULL NULL 555 110 1 112 -1
1226 738 333 NULL 2 124 1
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
NULL NULL 555 NULL 18 206 -2
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
NULL NULL 555 237 24 236 NULL
2476 1484 444 246 26 249 2
NULL NULL 333 117 0 NULL NULL

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
    or c between b-2 and d+2
    or d>e
order by col4,col2,col5,col1,col3,col7,col6;

----
1067 635 333 109 0 105 -1
NULL NULL 555 110 1 112 -1
NULL NULL 333 117 0 NULL NULL
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
NULL NULL 555 237 24 236 NULL
2476 1484 444 246 26 249 2
1226 738 333 NULL 2 124 1
NULL NULL 555 NULL 18 206 -2

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where c between b-2 and d+2
    or (c<=d-2 or c>=d+2)
    or d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
1067 635 333 109 0 105 -1
NULL NULL 555 110 1 112 -1
1226 738 333 NULL 2 124 1
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
NULL NULL 555 NULL 18 206 -2
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
NULL NULL 555 237 24 236 NULL
2476 1484 444 246 26 249 2
NULL NULL 333 117 0 NULL NULL

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       e as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b as col6,
       b-c as col7
from t1
where c between b-2 and d+2
    or (c<=d-2 or c>=d+2)
    or d>e
order by col1,col6,col2,col4,col5,col7,col3;

----
1067 635 333 109 0 105 -1
1226 738 333 NULL 2 124 1
1272 760 333 126 3 129 4
1325 793 444 132 4 130 -4
1371 827 111 135 5 139 2
1411 851 111 144 6 143 2
1622 966 333 162 10 160 -1
1714 1030 555 173 12 170 -2
1828 1096 333 180 14 181 -3
1861 1121 444 189 15 186 -1
1918 1158 444 192 16 194 1
2125 1277 222 210 19 211 -3
2165 1297 333 219 20 218 3
2226 1338 444 221 21 223 -1
2323 1391 555 230 23 232 1
2476 1484 444 246 26 249 2
NULL NULL 555 110 1 112 -1
NULL NULL 555 NULL 18 206 -2
NULL NULL 555 237 24 236 NULL
NULL NULL 333 117 0 NULL NULL

statement query TI
select a+b*2+c*3+d*4 as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1;

----
NULL 358
1828 364
1861 376
1918 382
1964 398
NULL 402
2125 426
2165 432
2226 440
2264 458
2323 468
NULL 486
2476 490
1067 1050
NULL 1120
1226 1240
1272 1290
1325 1300
1371 1390
1411 1430
NULL 1450
NULL 1510
NULL 1580
1622 1600
NULL 1670
1714 1700
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1,col2;

----
1067 1050
1226 1240
1272 1290
1325 1300
1371 1390
1411 1430
1622 1600
1714 1700
1828 364
1861 376
1918 382
1964 398
2125 426
2165 432
2226 440
2264 458
2323 468
2476 490
NULL 358
NULL 402
NULL 486
NULL 1120
NULL 1450
NULL 1510
NULL 1580
NULL 1670
NULL 2360
NULL NULL
NULL NULL
NULL NULL

statement query II
select a+b*2 as col1,
       b as col2
from t1
order by col2,col1;

----
317 105
NULL 112
369 124
385 129
391 130
416 139
428 143
439 145
455 151
475 158
483 160
502 167
514 170
529 175
544 181
560 186
579 194
595 198
NULL 206
635 211
652 218
666 223
685 228
698 232
711 236
723 240
743 249
NULL NULL
NULL NULL
NULL NULL

statement query II
select a+b*2 as col1,
       b as col2
from t1
order by col2,col1;

----
317 105
NULL 112
369 124
385 129
391 130
416 139
428 143
439 145
455 151
475 158
483 160
502 167
514 170
529 175
544 181
560 186
579 194
595 198
NULL 206
635 211
652 218
666 223
685 228
698 232
711 236
723 240
743 249
NULL NULL
NULL NULL
NULL NULL

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col1;

----
0
0
0
0
0
0
0
0
0
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col1;

----
0
0
0
0
0
0
0
0
0
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col1;

----
0
0
0
0
0
0
0
0
0
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col1;

----
0
0
0
0
0
0
0
0
0
0

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
order by col1;

----
114
122
128
133
136
140
164
171
183
185
190
196
207
212
217
222
226
233
238
248
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
order by col1;

----
114
122
128
133
136
140
164
171
183
185
190
196
207
212
217
222
226
233
238
248
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIIIIII
select a+b*2 as col1,
       d as col2,
       abs(b-c) as col3,
       abs(a) as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       a-b as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where (e>a and e<b)
    or (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
743 248 2 245 0 -4 444
579 190 1 191 0 -3 444
666 222 1 220 0 -3 444
385 128 4 127 0 -2 333
652 217 3 216 0 -2 333
635 212 3 213 0 2 222
317 108 1 107 0 2 333
560 185 1 188 0 2 444
698 233 1 234 0 2 555
483 164 1 163 0 3 333
NULL 116 NULL 115 0 NULL 333

statement query IIIIIII
select a+b*2 as col1,
       d as col2,
       abs(b-c) as col3,
       abs(a) as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       a-b as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where (e>a and e<b)
    or (c<=d-2 or c>=d+2)
order by col6,col5,col4,col7,col2,col3,col1;

----
743 248 2 245 0 -4 444
579 190 1 191 0 -3 444
666 222 1 220 0 -3 444
385 128 4 127 0 -2 333
652 217 3 216 0 -2 333
317 108 1 107 0 2 333
560 185 1 188 0 2 444
635 212 3 213 0 2 222
698 233 1 234 0 2 555
483 164 1 163 0 3 333
NULL 116 NULL 115 0 NULL 333

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       a+b*2 as col4,
       abs(a) as col5,
       a as col6,
       a+b*2+c*3 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col6,col7,col4,col5,col2,col3,col1;

----
1050 1067 105 317 107 107 635
1290 1272 129 385 127 127 760
1300 1325 130 391 131 131 793
1390 1371 139 416 138 138 827
1430 1411 143 428 142 142 851
1580 NULL 158 475 159 159 940
1600 1622 160 483 163 163 966
1700 1714 170 514 174 174 1030
358 NULL 175 529 179 179 1057
364 1828 181 544 182 182 1096
376 1861 186 560 188 188 1121
398 1964 198 595 199 199 1180
402 NULL NULL NULL 201 201 NULL
426 2125 211 635 213 213 1277
432 2165 218 652 216 216 1297
440 2226 223 666 220 220 1338
458 2264 228 685 229 229 1360
468 2323 232 698 234 234 1391
2360 NULL 236 711 239 239 NULL
490 2476 249 743 245 245 1484
1120 NULL 112 NULL NULL NULL NULL

statement query ITIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       a+b*2 as col4,
       abs(a) as col5,
       a as col6,
       a+b*2+c*3 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col1,col7,col5,col6,col3,col4,col2;

----
358 NULL 175 529 179 179 1057
364 1828 181 544 182 182 1096
376 1861 186 560 188 188 1121
398 1964 198 595 199 199 1180
402 NULL NULL NULL 201 201 NULL
426 2125 211 635 213 213 1277
432 2165 218 652 216 216 1297
440 2226 223 666 220 220 1338
458 2264 228 685 229 229 1360
468 2323 232 698 234 234 1391
490 2476 249 743 245 245 1484
1050 1067 105 317 107 107 635
1120 NULL 112 NULL NULL NULL NULL
1290 1272 129 385 127 127 760
1300 1325 130 391 131 131 793
1390 1371 139 416 138 138 827
1430 1411 143 428 142 142 851
1580 NULL 158 475 159 159 940
1600 1622 160 483 163 163 966
1700 1714 170 514 174 174 1030
2360 NULL 236 711 239 239 NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       a+b*2 as col4,
       abs(a) as col5,
       a as col6,
       a+b*2+c*3 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1;

----
1050 1067 105 317 107 107 635
1290 1272 129 385 127 127 760
1300 1325 130 391 131 131 793
1390 1371 139 416 138 138 827
1430 1411 143 428 142 142 851
1580 NULL 158 475 159 159 940
1600 1622 160 483 163 163 966
1700 1714 170 514 174 174 1030
358 NULL 175 529 179 179 1057
364 1828 181 544 182 182 1096
376 1861 186 560 188 188 1121
398 1964 198 595 199 199 1180
402 NULL NULL NULL 201 201 NULL
426 2125 211 635 213 213 1277
432 2165 218 652 216 216 1297
440 2226 223 666 220 220 1338
458 2264 228 685 229 229 1360
468 2323 232 698 234 234 1391
2360 NULL 236 711 239 239 NULL
490 2476 249 743 245 245 1484
1120 NULL 112 NULL NULL NULL NULL

statement query IIIIIII
select case when c>avg_c then a*2 else b*10 end as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       a+b*2 as col4,
       abs(a) as col5,
       a as col6,
       a+b*2+c*3 as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or (e>c or e<d)
order by col6,col5,col7,col4,col2,col3,col1;

----
1050 1067 105 317 107 107 635
1290 1272 129 385 127 127 760
1300 1325 130 391 131 131 793
1390 1371 139 416 138 138 827
1430 1411 143 428 142 142 851
1580 NULL 158 475 159 159 940
1600 1622 160 483 163 163 966
1700 1714 170 514 174 174 1030
358 NULL 175 529 179 179 1057
364 1828 181 544 182 182 1096
376 1861 186 560 188 188 1121
398 1964 198 595 199 199 1180
402 NULL NULL NULL 201 201 NULL
426 2125 211 635 213 213 1277
432 2165 218 652 216 216 1297
440 2226 223 666 220 220 1338
458 2264 228 685 229 229 1360
468 2323 232 698 234 234 1391
2360 NULL 236 711 239 239 NULL
490 2476 249 743 245 245 1484
1120 NULL 112 NULL NULL NULL NULL

statement query III
select c as col1,
       a+b*2 as col2,
       abs(b-c) as col3
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col2,col3,col1;

----
123 369 1
125 385 4
134 391 4
137 416 2
141 428 2
150 455 1
155 475 3
166 502 1
184 544 3
193 579 1
195 595 3
215 652 3
225 685 3
231 698 1
247 743 2

statement query III
select c as col1,
       a+b*2 as col2,
       abs(b-c) as col3
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col1,col3,col2;

----
123 369 1
125 385 4
134 391 4
137 416 2
141 428 2
150 455 1
155 475 3
166 502 1
184 544 3
193 579 1
195 595 3
215 652 3
225 685 3
231 698 1
247 743 2

statement query III
select c as col1,
       a+b*2 as col2,
       abs(b-c) as col3
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col3,col1;

----
123 369 1
125 385 4
134 391 4
137 416 2
141 428 2
150 455 1
155 475 3
166 502 1
184 544 3
193 579 1
195 595 3
215 652 3
225 685 3
231 698 1
247 743 2

statement query III
select c as col1,
       a+b*2 as col2,
       abs(b-c) as col3
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col3,col1;

----
123 369 1
125 385 4
134 391 4
137 416 2
141 428 2
150 455 1
155 475 3
166 502 1
184 544 3
193 579 1
195 595 3
215 652 3
225 685 3
231 698 1
247 743 2

statement query II
select b-c as col1,
       b as col2
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or d>e
order by col2,col1;

----
-1 105
-1 112
4 129
-4 130
2 139
2 143
3 158
-1 160
-2 170
-1 175
-3 181
-1 186
1 194
3 198
-3 211
3 218
-1 223
3 228
1 232
NULL 236
2 249
NULL NULL

statement query II
select b-c as col1,
       b as col2
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or d>e
order by col1,col2;

----
-4 130
-3 181
-3 211
-2 170
-1 105
-1 112
-1 160
-1 175
-1 186
-1 223
1 194
1 232
2 139
2 143
2 249
3 158
3 198
3 218
3 228
4 129
NULL 236
NULL NULL

statement query II
select b-c as col1,
       b as col2
from t1
where (e>c or e<d)
    or d>e
    or (e>a and e<b)
order by col2,col1;

----
-1 105
-1 112
4 129
-4 130
2 139
2 143
3 158
-1 160
-2 170
-1 175
-3 181
-1 186
1 194
3 198
-3 211
3 218
-1 223
3 228
1 232
NULL 236
2 249
NULL NULL

statement query II
select b-c as col1,
       b as col2
from t1
where (e>c or e<d)
    or d>e
    or (e>a and e<b)
order by col2,col1;

----
-1 105
-1 112
4 129
-4 130
2 139
2 143
3 158
-1 160
-2 170
-1 175
-3 181
-1 186
1 194
3 198
-3 211
3 218
-1 223
3 228
1 232
NULL 236
2 249
NULL NULL

statement query II
select b-c as col1,
       b as col2
from t1
where (e>a and e<b)
    or d>e
    or (e>c or e<d)
order by col2,col1;

----
-1 105
-1 112
4 129
-4 130
2 139
2 143
3 158
-1 160
-2 170
-1 175
-3 181
-1 186
1 194
3 198
-3 211
3 218
-1 223
3 228
1 232
NULL 236
2 249
NULL NULL

statement query II
select b-c as col1,
       b as col2
from t1
where (e>a and e<b)
    or d>e
    or (e>c or e<d)
order by col2,col1;

----
-1 105
-1 112
4 129
-4 130
2 139
2 143
3 158
-1 160
-2 170
-1 175
-3 181
-1 186
1 194
3 198
-3 211
3 218
-1 223
3 228
1 232
NULL 236
2 249
NULL NULL

statement query FI
select (a+b+c+d+e)/5 as col1,
       b as col2
from t1
where e+d between a+b-10 and c+130
order by col2,col1;

----
107.0 105
127.0 129

statement query FI
select (a+b+c+d+e)/5 as col1,
       b as col2
from t1
where e+d between a+b-10 and c+130
order by col2,col1;

----
107.0 105
127.0 129

statement query IIIFI
select abs(a) as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       abs(b-c) as col5
from t1
where c>d
order by col4,col5,col2,col3,col1;

----
131 4 133 132.0 4
138 5 136 137.0 2
142 6 140 142.0 2
174 12 171 172.0 2
182 14 183 182.0 3
188 15 185 187.0 1
191 16 190 192.0 1
213 19 212 212.0 3
220 21 222 222.0 1
121 2 122 NULL 1
NULL 18 207 NULL 2
104 0 101 NULL NULL
115 0 116 NULL NULL

statement query IIITT
select abs(a) as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       abs(b-c) as col5
from t1
where c>d
order by col3,col4,col5,col2,col1;

----
104 0 101 NULL NULL
115 0 116 NULL NULL
121 2 122 NULL 1
131 4 133 132.0 4
138 5 136 137.0 2
142 6 140 142.0 2
174 12 171 172.0 2
182 14 183 182.0 3
188 15 185 187.0 1
191 16 190 192.0 1
NULL 18 207 NULL 2
213 19 212 212.0 3
220 21 222 222.0 1

statement query I
select a+b*2+c*3 as col1
from t1
where c between b-2 and d+2
order by col1;

----
635
738
793
827
851
966
1030
1096
1121
1277
1338
1391
1484
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where c between b-2 and d+2
order by col1;

----
635
738
793
827
851
966
1030
1096
1121
1277
1338
1391
1484
NULL
NULL

statement query F
select (a+b+c+d+e)/5 as col1
from t1
order by col1;

----
107.0
127.0
132.0
137.0
142.0
162.0
172.0
182.0
187.0
192.0
197.0
212.0
217.0
222.0
227.0
232.0
247.0
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query F
select (a+b+c+d+e)/5 as col1
from t1
order by col1;

----
107.0
127.0
132.0
137.0
142.0
162.0
172.0
182.0
187.0
192.0
197.0
212.0
217.0
222.0
227.0
232.0
247.0
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       abs(a) as col2
from t1
where c between b-2 and d+2
order by col2,col1;

----
1067 107
1226 121
1325 131
1371 138
1411 142
1622 163
1714 174
1828 182
1861 188
2125 213
2226 220
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       abs(a) as col2
from t1
where c between b-2 and d+2
order by col1,col2;

----
1067 107
1226 121
1325 131
1371 138
1411 142
1622 163
1714 174
1828 182
1861 188
2125 213
2226 220
2323 234
2476 245
NULL NULL
NULL NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (e>c or e<d)
    or (e>a and e<b)
order by col2,col1;

----
1371 111
1411 111
2125 222
NULL 222
1067 333
1272 333
1622 333
1828 333
2165 333
1325 444
1861 444
1918 444
2226 444
2476 444
1714 555
1964 555
2264 555
2323 555
NULL 555
NULL 555
NULL 555
NULL 555

statement query II
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (e>c or e<d)
    or (e>a and e<b)
order by col1,col2;

----
1067 333
1272 333
1325 444
1371 111
1411 111
1622 333
1714 555
1828 333
1861 444
1918 444
1964 555
2125 222
2165 333
2226 444
2264 555
2323 555
2476 444
NULL 222
NULL 555
NULL 555
NULL 555
NULL 555

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col2,col3,col1;

----
333 2728 181
555 2949 198
555 3399 228

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3
from t1
where (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col1,col3,col2;

----
333 2728 181
555 2949 198
555 3399 228

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col2,col3,col1;

----
333 2728 181
555 2949 198
555 3399 228

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b as col3
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
order by col2,col3,col1;

----
333 2728 181
555 2949 198
555 3399 228

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d>e
   and (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
333 129 -2 1272
333 160 3 1622
222 211 2 2125
444 223 -3 2226
555 232 2 2323

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d>e
   and (c<=d-2 or c>=d+2)
order by col1,col4,col2,col3;

----
222 211 2 2125
333 129 -2 1272
333 160 3 1622
444 223 -3 2226
555 232 2 2323

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (c<=d-2 or c>=d+2)
   and d>e
order by col4,col2,col3,col1;

----
333 129 -2 1272
333 160 3 1622
222 211 2 2125
444 223 -3 2226
555 232 2 2323

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       b as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (c<=d-2 or c>=d+2)
   and d>e
order by col2,col1,col4,col3;

----
333 129 -2 1272
333 160 3 1622
222 211 2 2125
444 223 -3 2226
555 232 2 2323

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where c between b-2 and d+2
   and b>c
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where c between b-2 and d+2
   and b>c
   and e+d between a+b-10 and c+130
order by col2,col3,col4,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where e+d between a+b-10 and c+130
   and c between b-2 and d+2
   and b>c
order by col4,col2,col3,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where e+d between a+b-10 and c+130
   and c between b-2 and d+2
   and b>c
order by col2,col3,col4,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where b>c
   and e+d between a+b-10 and c+130
   and c between b-2 and d+2
order by col4,col2,col3,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b-c as col3,
       d as col4
from t1
where b>c
   and e+d between a+b-10 and c+130
   and c between b-2 and d+2
order by col2,col4,col1,col3;

----

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3
from t1
where (e>a and e<b)
order by col2,col3,col1;

----
111 -1 247
222 2 224
222 3 193

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       c-d as col2,
       c as col3
from t1
where (e>a and e<b)
order by col3,col1,col2;

----
222 3 193
222 2 224
111 -1 247

statement query III
select c-d as col1,
       a+b*2+c*3 as col2,
       d as col3
from t1
where a>b
order by col2,col3,col1;

----
-2 635 108
1 793 133
NULL 880 NULL
NULL 905 NULL
NULL 940 NULL
-3 966 164
NULL 1000 NULL
1 1030 171
NULL 1057 NULL
1 1096 183
2 1121 185
-1 1180 196
2 1277 212
-1 1360 226
-2 1391 233
NULL 1455 NULL
NULL NULL 238

statement query III
select c-d as col1,
       a+b*2+c*3 as col2,
       d as col3
from t1
where a>b
order by col3,col2,col1;

----
-2 635 108
1 793 133
-3 966 164
1 1030 171
1 1096 183
2 1121 185
-1 1180 196
2 1277 212
-1 1360 226
-2 1391 233
NULL NULL 238
NULL 880 NULL
NULL 905 NULL
NULL 940 NULL
NULL 1000 NULL
NULL 1057 NULL
NULL 1455 NULL

statement query FIIIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       abs(a) as col3,
       b-c as col4,
       c as col5,
       a-b as col6,
       case when c>avg_c then a*2 else b*10 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1;

----
247.0 3706 245 2 247 -4 490
222.0 3331 220 -1 224 -3 440
217.0 3260 216 3 215 -2 432
127.0 1902 127 4 125 -2 1290
137.0 2046 138 2 137 -1 1390
142.0 2131 142 2 141 -1 1430
182.0 2728 182 -3 184 1 364
197.0 2949 199 3 195 1 398
227.0 3399 229 3 225 1 458
132.0 1985 131 -4 134 1 1300
NULL NULL 159 3 155 1 1580
187.0 2806 188 -1 187 2 376
212.0 3175 213 -3 214 2 426
232.0 3473 234 1 231 2 468
107.0 1612 107 -1 106 2 1050
162.0 2432 163 -1 161 3 1600
NULL NULL 239 NULL NULL 3 2360
NULL NULL 179 -1 176 4 358
172.0 2579 174 -2 172 4 1700
NULL NULL 201 NULL 202 NULL 402
NULL NULL NULL -1 113 NULL 1120

statement query FIIIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       abs(a) as col3,
       b-c as col4,
       c as col5,
       a-b as col6,
       case when c>avg_c then a*2 else b*10 end as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
order by col4,col3,col5,col1,col2,col7,col6;

----
132.0 1985 131 -4 134 1 1300
182.0 2728 182 -3 184 1 364
212.0 3175 213 -3 214 2 426
172.0 2579 174 -2 172 4 1700
107.0 1612 107 -1 106 2 1050
162.0 2432 163 -1 161 3 1600
NULL NULL 179 -1 176 4 358
187.0 2806 188 -1 187 2 376
222.0 3331 220 -1 224 -3 440
NULL NULL NULL -1 113 NULL 1120
232.0 3473 234 1 231 2 468
137.0 2046 138 2 137 -1 1390
142.0 2131 142 2 141 -1 1430
247.0 3706 245 2 247 -4 490
NULL NULL 159 3 155 1 1580
197.0 2949 199 3 195 1 398
217.0 3260 216 3 215 -2 432
227.0 3399 229 3 225 1 458
127.0 1902 127 4 125 -2 1290
NULL NULL 201 NULL 202 NULL 402
NULL NULL 239 NULL NULL 3 2360

statement query II
select a+b*2+c*3 as col1,
       a+b*2 as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
635 317
760 385
966 483
1121 560
1158 579
1277 635
1297 652
1338 666
1391 698
NULL NULL

statement query II
select a+b*2+c*3 as col1,
       a+b*2 as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
635 317
760 385
966 483
1121 560
1158 579
1277 635
1297 652
1338 666
1391 698
NULL NULL

statement query IIIIIFI
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       b as col4,
       d-e as col5,
       (a+b+c+d+e)/5 as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
1067 635 106 105 -1 107.0 -1
1272 760 125 129 2 127.0 4
1622 966 161 160 2 162.0 -1
1861 1121 187 186 -4 187.0 -1
1918 1158 193 194 -2 192.0 1
2125 1277 214 211 2 212.0 -3
2165 1297 215 218 -2 217.0 3
2226 1338 224 223 1 222.0 -1
2323 1391 231 232 3 232.0 1
NULL NULL 119 NULL -1 NULL NULL

statement query IIIIIFI
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       b as col4,
       d-e as col5,
       (a+b+c+d+e)/5 as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
order by col1,col2,col4,col6,col7,col5,col3;

----
1067 635 106 105 -1 107.0 -1
1272 760 125 129 2 127.0 4
1622 966 161 160 2 162.0 -1
1861 1121 187 186 -4 187.0 -1
1918 1158 193 194 -2 192.0 1
2125 1277 214 211 2 212.0 -3
2165 1297 215 218 -2 217.0 3
2226 1338 224 223 1 222.0 -1
2323 1391 231 232 3 232.0 1
NULL NULL 119 NULL -1 NULL NULL

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d not between 110 and 150
   and (e>c or e<d)
   and d>e
order by col2,col3,col1;

----
10 2432 444
14 2728 333
19 3175 333
21 3331 222
23 3473 333
26 3706 111
24 NULL 444

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where d not between 110 and 150
   and (e>c or e<d)
   and d>e
order by col2,col3,col1;

----
10 2432 444
14 2728 333
19 3175 333
21 3331 222
23 3473 333
26 3706 111
24 NULL 444

