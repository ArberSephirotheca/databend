statement ok
drop table if exists t1 all;

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null);

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104);

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105);

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113);

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null);

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121);

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125);

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130);

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137);

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143);

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147);

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null);

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158);

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162);

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166);

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174);

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175);

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184);

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185);

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191);

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195);

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204);

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207);

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211);

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219);

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224);

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225);

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233);

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238);

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null);

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245);

statement query IIIIIII
select abs(a) as col1,
       b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a-b as col4,
       e as col5,
       c-d as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where a>b
    or (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
163 160 1600 3 162 -3 0
107 105 1050 2 109 -2 0
234 232 468 2 230 -2 0
245 249 490 -4 246 -1 0
199 198 398 1 197 -1 0
229 228 458 1 227 -1 0
131 130 1300 1 132 1 0
182 181 364 1 180 1 0
174 170 1700 4 173 1 0
220 223 440 -3 221 2 0
188 186 376 2 189 2 0
213 211 426 2 210 2 0
191 194 382 -3 192 3 0
159 158 1580 1 157 NULL 0
168 167 1670 1 165 NULL 0
153 151 1510 2 NULL NULL 0
239 236 2360 3 237 NULL 0
243 240 486 3 NULL NULL 0
149 145 1450 4 146 NULL 0
179 175 358 4 177 NULL 0

statement query IIIIIII
select abs(a) as col1,
       b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a-b as col4,
       e as col5,
       c-d as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where a>b
    or (e>a and e<b)
order by col7,col2,col6,col4,col5,col3,col1;

----
107 105 1050 2 109 -2 0
131 130 1300 1 132 1 0
149 145 1450 4 146 NULL 0
153 151 1510 2 NULL NULL 0
159 158 1580 1 157 NULL 0
163 160 1600 3 162 -3 0
168 167 1670 1 165 NULL 0
174 170 1700 4 173 1 0
179 175 358 4 177 NULL 0
182 181 364 1 180 1 0
188 186 376 2 189 2 0
191 194 382 -3 192 3 0
199 198 398 1 197 -1 0
213 211 426 2 210 2 0
220 223 440 -3 221 2 0
229 228 458 1 227 -1 0
234 232 468 2 230 -2 0
239 236 2360 3 237 NULL 0
243 240 486 3 NULL NULL 0
245 249 490 -4 246 -1 0

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where d not between 110 and 150
   and a>b
   and (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where d not between 110 and 150
   and a>b
   and (a>b-2 and a<b+2)
order by col1,col5,col6,col7,col4,col2,col3;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where a>b
   and (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col6,col7,col4,col5,col2,col3,col1;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where a>b
   and (a>b-2 and a<b+2)
   and d not between 110 and 150
order by col6,col4,col7,col5,col2,col3,col1;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
   and a>b
order by col6,col7,col4,col5,col2,col3,col1;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query IIIIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(a) as col2,
       a+b*2+c*3 as col3,
       b-c as col4,
       (a+b+c+d+e)/5 as col5,
       abs(b-c) as col6,
       c as col7
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
   and a>b
order by col1,col3,col4,col5,col6,col2,col7;

----
14 182 1096 -3 182.0 3 184
17 199 1180 3 197.0 3 195
22 229 1360 3 227.0 3 225

statement query III
select b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3
from t1
order by col2,col3,col1;

----
249 111 245
124 222 121
129 222 127
139 222 138
143 222 142
194 222 191
218 222 216
223 222 220
105 333 107
130 333 131
151 333 153
158 333 159
167 333 168
181 333 182
186 333 188
198 333 199
211 333 213
228 333 229
232 333 234
NULL 444 104
NULL 444 115
145 444 149
160 444 163
170 444 174
175 444 179
NULL 444 201
236 444 239
240 444 243
112 444 NULL
206 444 NULL

statement query III
select b as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       abs(a) as col3
from t1
order by col2,col1,col3;

----
249 111 245
124 222 121
129 222 127
139 222 138
143 222 142
194 222 191
218 222 216
223 222 220
105 333 107
130 333 131
151 333 153
158 333 159
167 333 168
181 333 182
186 333 188
198 333 199
211 333 213
228 333 229
232 333 234
112 444 NULL
145 444 149
160 444 163
170 444 174
175 444 179
206 444 NULL
236 444 239
240 444 243
NULL 444 104
NULL 444 115
NULL 444 201

statement query IIIIIII
select b-c as col1,
       a-b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       d-e as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
2 -1 1430 143 1411 0 -4
-1 2 376 186 1861 0 -4
-2 4 1700 170 1714 0 -2
1 -3 382 194 1918 0 -2
3 -2 432 218 2165 0 -2
-1 2 1050 105 1067 0 -1
3 1 398 198 1964 0 -1
3 1 458 228 2264 0 -1
NULL NULL 402 NULL NULL 0 -1
NULL NULL NULL NULL NULL 0 -1
-4 1 1300 130 1325 0 1
2 -1 1390 139 1371 0 1
-1 -3 440 223 2226 0 1
NULL 3 2360 236 NULL 0 1
4 -2 1290 129 1272 0 2
-1 3 1600 160 1622 0 2
-3 2 426 211 2125 0 2
2 -4 490 249 2476 0 2
-3 1 364 181 1828 0 3
1 2 468 232 2323 0 3
-1 NULL 1120 112 NULL 0 4
1 -3 1240 124 1226 0 NULL
-2 4 1450 145 NULL 0 NULL
1 2 1510 151 NULL 0 NULL
3 1 1580 158 NULL 0 NULL
1 1 1670 167 NULL 0 NULL
-1 4 358 175 NULL 0 NULL
-2 NULL NULL 206 NULL 0 NULL
-4 3 486 240 NULL 0 NULL
NULL NULL NULL NULL NULL 0 NULL

statement query IIIIIII
select b-c as col1,
       a-b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       d-e as col7
from t1
order by col2,col7,col3,col4,col1,col5,col6;

----
2 -4 490 249 2476 0 2
1 -3 382 194 1918 0 -2
-1 -3 440 223 2226 0 1
1 -3 1240 124 1226 0 NULL
3 -2 432 218 2165 0 -2
4 -2 1290 129 1272 0 2
2 -1 1430 143 1411 0 -4
2 -1 1390 139 1371 0 1
3 1 398 198 1964 0 -1
3 1 458 228 2264 0 -1
-4 1 1300 130 1325 0 1
-3 1 364 181 1828 0 3
3 1 1580 158 NULL 0 NULL
1 1 1670 167 NULL 0 NULL
-1 2 376 186 1861 0 -4
-1 2 1050 105 1067 0 -1
-3 2 426 211 2125 0 2
1 2 468 232 2323 0 3
1 2 1510 151 NULL 0 NULL
NULL 3 2360 236 NULL 0 1
-1 3 1600 160 1622 0 2
-4 3 486 240 NULL 0 NULL
-2 4 1700 170 1714 0 -2
-1 4 358 175 NULL 0 NULL
-2 4 1450 145 NULL 0 NULL
NULL NULL 402 NULL NULL 0 -1
NULL NULL NULL NULL NULL 0 -1
-1 NULL 1120 112 NULL 0 4
-2 NULL NULL 206 NULL 0 NULL
NULL NULL NULL NULL NULL 0 NULL

statement query TITIT
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       b as col5
from t1
order by col4,col5,col2,col3,col1;

----
NULL 0 NULL 104 NULL
1612 0 -1 107 105
NULL 0 -1 115 NULL
NULL 2 NULL 121 124
1902 3 2 127 129
1985 4 1 131 130
2046 5 1 138 139
2131 6 -4 142 143
NULL 7 NULL 149 145
NULL 8 NULL 153 151
NULL 9 NULL 159 158
2432 10 2 163 160
NULL 11 NULL 168 167
2579 12 -2 174 170
NULL 13 NULL 179 175
2728 14 3 182 181
2806 15 -4 188 186
2878 16 -2 191 194
2949 17 -1 199 198
NULL 0 -1 201 NULL
3175 19 2 213 211
3260 20 -2 216 218
3331 21 1 220 223
3399 22 -1 229 228
3473 23 3 234 232
NULL 24 1 239 236
NULL 25 NULL 243 240
3706 26 2 245 249
NULL 1 4 NULL 112
NULL 18 NULL NULL 206

statement query TITIT
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       b as col5
from t1
order by col4,col1,col3,col2,col5;

----
NULL 0 NULL 104 NULL
1612 0 -1 107 105
NULL 0 -1 115 NULL
NULL 2 NULL 121 124
1902 3 2 127 129
1985 4 1 131 130
2046 5 1 138 139
2131 6 -4 142 143
NULL 7 NULL 149 145
NULL 8 NULL 153 151
NULL 9 NULL 159 158
2432 10 2 163 160
NULL 11 NULL 168 167
2579 12 -2 174 170
NULL 13 NULL 179 175
2728 14 3 182 181
2806 15 -4 188 186
2878 16 -2 191 194
2949 17 -1 199 198
NULL 0 -1 201 NULL
3175 19 2 213 211
3260 20 -2 216 218
3331 21 1 220 223
3399 22 -1 229 228
3473 23 3 234 232
NULL 24 1 239 236
NULL 25 NULL 243 240
3706 26 2 245 249
NULL 1 4 NULL 112
NULL 18 NULL NULL 206

statement query IIIII
select b as col1,
       d-e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       c-d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col4,col5,col2,col3,col1;

----
129 2 333 -3 1902
160 2 333 -3 2432
105 -1 333 -2 1612
218 -2 333 -2 3260
232 3 555 -2 3473
198 -1 555 -1 2949
228 -1 555 -1 3399
249 2 444 -1 3706
NULL -1 222 -1 NULL
112 4 555 -1 NULL
130 1 444 1 1985
139 1 111 1 2046
143 -4 111 1 2131
170 -2 555 1 2579
181 3 333 1 2728
124 NULL 333 1 NULL
206 NULL 555 1 NULL
NULL NULL 555 1 NULL
186 -4 444 2 2806
211 2 222 2 3175
223 1 444 2 3331
194 -2 444 3 2878
NULL -1 333 3 NULL
236 1 555 NULL NULL
240 NULL 222 NULL NULL
145 NULL 555 NULL NULL
151 NULL 555 NULL NULL
158 NULL 555 NULL NULL
167 NULL 555 NULL NULL
175 NULL 555 NULL NULL

statement query IIIII
select b as col1,
       d-e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       c-d as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
order by col2,col5,col4,col1,col3;

----
143 -4 111 1 2131
186 -4 444 2 2806
170 -2 555 1 2579
194 -2 444 3 2878
218 -2 333 -2 3260
105 -1 333 -2 1612
198 -1 555 -1 2949
228 -1 555 -1 3399
NULL -1 222 -1 NULL
NULL -1 333 3 NULL
130 1 444 1 1985
139 1 111 1 2046
223 1 444 2 3331
236 1 555 NULL NULL
129 2 333 -3 1902
160 2 333 -3 2432
211 2 222 2 3175
249 2 444 -1 3706
181 3 333 1 2728
232 3 555 -2 3473
112 4 555 -1 NULL
124 NULL 333 1 NULL
206 NULL 555 1 NULL
NULL NULL 555 1 NULL
145 NULL 555 NULL NULL
151 NULL 555 NULL NULL
158 NULL 555 NULL NULL
167 NULL 555 NULL NULL
175 NULL 555 NULL NULL
240 NULL 222 NULL NULL

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
   and (a>b-2 and a<b+2)
   and d>e
order by col2,col1;

----
138 222
131 333
182 333

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
   and (a>b-2 and a<b+2)
   and d>e
order by col1,col2;

----
131 333
138 222
182 333

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and c>d
order by col2,col1;

----
138 222
131 333
182 333

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and c>d
order by col1,col2;

----
131 333
138 222
182 333

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
   and d>e
   and (a>b-2 and a<b+2)
order by col2,col1;

----
138 222
131 333
182 333

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where c>d
   and d>e
   and (a>b-2 and a<b+2)
order by col2,col1;

----
138 222
131 333
182 333

statement query IFIII
select e as col1,
       (a+b+c+d+e)/5 as col2,
       abs(a) as col3,
       c-d as col4,
       a+b*2+c*3 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
126 127.0 127 -3 760
162 162.0 163 -3 966
109 107.0 107 -2 635
219 217.0 216 -2 1297
230 232.0 234 -2 1391
197 197.0 199 -1 1180
227 227.0 229 -1 1360
246 247.0 245 -1 1484
204 NULL 201 -1 NULL
110 NULL NULL -1 NULL
NULL NULL 121 1 738
132 132.0 131 1 793
135 137.0 138 1 827
144 142.0 142 1 851
173 172.0 174 1 1030
180 182.0 182 1 1096
NULL NULL 104 1 NULL
NULL NULL NULL 1 NULL
189 187.0 188 2 1121
210 212.0 213 2 1277
221 222.0 220 2 1338
192 192.0 191 3 1158
146 NULL 149 NULL 880
NULL NULL 153 NULL 905
157 NULL 159 NULL 940
165 NULL 168 NULL 1000
177 NULL 179 NULL 1057
NULL NULL 243 NULL 1455
237 NULL 239 NULL NULL

statement query TTIIT
select e as col1,
       (a+b+c+d+e)/5 as col2,
       abs(a) as col3,
       c-d as col4,
       a+b*2+c*3 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
order by col3,col4,col2,col5,col1;

----
NULL NULL 104 1 NULL
109 107.0 107 -2 635
NULL NULL 121 1 738
126 127.0 127 -3 760
132 132.0 131 1 793
135 137.0 138 1 827
144 142.0 142 1 851
146 NULL 149 NULL 880
NULL NULL 153 NULL 905
157 NULL 159 NULL 940
162 162.0 163 -3 966
165 NULL 168 NULL 1000
173 172.0 174 1 1030
177 NULL 179 NULL 1057
180 182.0 182 1 1096
189 187.0 188 2 1121
192 192.0 191 3 1158
197 197.0 199 -1 1180
204 NULL 201 -1 NULL
210 212.0 213 2 1277
219 217.0 216 -2 1297
221 222.0 220 2 1338
227 227.0 229 -1 1360
230 232.0 234 -2 1391
237 NULL 239 NULL NULL
NULL NULL 243 NULL 1455
246 247.0 245 -1 1484
110 NULL NULL -1 NULL
NULL NULL NULL 1 NULL

statement query IIIII
select d as col1,
       a+b*2+c*3 as col2,
       c as col3,
       a+b*2+c*3+d*4 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
order by col4,col5,col2,col3,col1;

----
108 635 106 1067 333
122 738 123 1226 222
128 760 125 1272 222
133 793 134 1325 333
136 827 137 1371 222
140 851 141 1411 222
164 966 161 1622 444
171 1030 172 1714 444
183 1096 184 1828 333
185 1121 187 1861 333
190 1158 193 1918 222
196 1180 195 1964 333
212 1277 214 2125 333
217 1297 215 2165 222
222 1338 224 2226 222
226 1360 225 2264 333
233 1391 231 2323 333
248 1484 247 2476 111
NULL 905 150 NULL 333
NULL 940 155 NULL 333
NULL 1000 166 NULL 333
NULL 880 147 NULL 444
NULL 1057 176 NULL 444
NULL 1455 244 NULL 444
101 NULL 102 NULL 444
114 NULL 113 NULL 444
116 NULL 119 NULL 444
203 NULL 202 NULL 444
207 NULL 208 NULL 444
238 NULL NULL NULL 444

statement query ITITI
select d as col1,
       a+b*2+c*3 as col2,
       c as col3,
       a+b*2+c*3+d*4 as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
order by col3,col2,col5,col4,col1;

----
101 NULL 102 NULL 444
108 635 106 1067 333
114 NULL 113 NULL 444
116 NULL 119 NULL 444
122 738 123 1226 222
128 760 125 1272 222
133 793 134 1325 333
136 827 137 1371 222
140 851 141 1411 222
NULL 880 147 NULL 444
NULL 905 150 NULL 333
NULL 940 155 NULL 333
164 966 161 1622 444
NULL 1000 166 NULL 333
171 1030 172 1714 444
NULL 1057 176 NULL 444
183 1096 184 1828 333
185 1121 187 1861 333
190 1158 193 1918 222
196 1180 195 1964 333
203 NULL 202 NULL 444
207 NULL 208 NULL 444
212 1277 214 2125 333
217 1297 215 2165 222
222 1338 224 2226 222
226 1360 225 2264 333
233 1391 231 2323 333
NULL 1455 244 NULL 444
248 1484 247 2476 111
238 NULL NULL NULL 444

statement query II
select c-d as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
2 376
3 382
2 426
-2 432
2 440
-2 468
-2 1050
-3 1290
-3 1600
3 NULL

statement query II
select c-d as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
2 376
3 382
2 426
-2 432
2 440
-2 468
-2 1050
-3 1290
-3 1600
3 NULL

statement query IIIIIIF
select d as col1,
       d-e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       e as col6,
       (a+b+c+d+e)/5 as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
108 -1 333 0 1612 109 107.0
114 4 555 0 NULL 110 NULL
116 -1 333 0 NULL 117 NULL
128 2 333 0 1902 126 127.0
133 1 444 0 1985 132 132.0
136 1 111 0 2046 135 137.0
140 -4 111 0 2131 144 142.0
NULL NULL 555 0 NULL 146 NULL
NULL NULL 555 0 NULL 157 NULL
164 2 333 0 2432 162 162.0
NULL NULL 555 0 NULL 165 NULL
171 -2 555 0 2579 173 172.0
NULL NULL 555 0 NULL 177 NULL
183 3 333 0 2728 180 182.0
185 -4 444 0 2806 189 187.0
190 -2 444 0 2878 192 192.0
196 -1 555 0 2949 197 197.0
203 -1 222 0 NULL 204 NULL
212 2 222 0 3175 210 212.0
217 -2 333 0 3260 219 217.0
222 1 444 0 3331 221 222.0
226 -1 555 0 3399 227 227.0
233 3 555 0 3473 230 232.0
238 1 555 0 NULL 237 NULL
248 2 444 0 3706 246 247.0
NULL NULL 222 0 NULL NULL NULL
122 NULL 333 0 NULL NULL NULL
101 NULL 555 0 NULL NULL NULL
207 NULL 555 0 NULL NULL NULL
NULL NULL 555 0 NULL NULL NULL

statement query IIIIIIF
select d as col1,
       d-e as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       e as col6,
       (a+b+c+d+e)/5 as col7
from t1
order by col7,col5,col4,col6,col1,col2,col3;

----
108 -1 333 0 1612 109 107.0
128 2 333 0 1902 126 127.0
133 1 444 0 1985 132 132.0
136 1 111 0 2046 135 137.0
140 -4 111 0 2131 144 142.0
164 2 333 0 2432 162 162.0
171 -2 555 0 2579 173 172.0
183 3 333 0 2728 180 182.0
185 -4 444 0 2806 189 187.0
190 -2 444 0 2878 192 192.0
196 -1 555 0 2949 197 197.0
212 2 222 0 3175 210 212.0
217 -2 333 0 3260 219 217.0
222 1 444 0 3331 221 222.0
226 -1 555 0 3399 227 227.0
233 3 555 0 3473 230 232.0
248 2 444 0 3706 246 247.0
114 4 555 0 NULL 110 NULL
116 -1 333 0 NULL 117 NULL
NULL NULL 555 0 NULL 146 NULL
NULL NULL 555 0 NULL 157 NULL
NULL NULL 555 0 NULL 165 NULL
NULL NULL 555 0 NULL 177 NULL
203 -1 222 0 NULL 204 NULL
238 1 555 0 NULL 237 NULL
101 NULL 555 0 NULL NULL NULL
122 NULL 333 0 NULL NULL NULL
207 NULL 555 0 NULL NULL NULL
NULL NULL 222 0 NULL NULL NULL
NULL NULL 555 0 NULL NULL NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d not between 110 and 150
    or (e>c or e<d)
    or b>c
order by col4,col2,col3,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d not between 110 and 150
    or (e>c or e<d)
    or b>c
order by col4,col2,col3,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
    or d not between 110 and 150
    or (e>c or e<d)
order by col4,col2,col3,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query IITT
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
    or d not between 110 and 150
    or (e>c or e<d)
order by col2,col1,col4,col3;

----
102 0 NULL NULL
106 0 1050 1067
113 0 1120 NULL
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
150 0 1510 NULL
155 0 1580 NULL
161 0 1600 1622
166 0 1670 NULL
172 0 1700 1714
176 0 358 NULL
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
202 0 402 NULL
208 0 NULL NULL
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
NULL 0 2360 NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
    or d not between 110 and 150
    or b>c
order by col4,col2,col3,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query IITT
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
    or d not between 110 and 150
    or b>c
order by col2,col1,col4,col3;

----
102 0 NULL NULL
106 0 1050 1067
113 0 1120 NULL
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
150 0 1510 NULL
155 0 1580 NULL
161 0 1600 1622
166 0 1670 NULL
172 0 1700 1714
176 0 358 NULL
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
202 0 402 NULL
208 0 NULL NULL
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
NULL 0 2360 NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
    or b>c
    or d not between 110 and 150
order by col4,col2,col3,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query IIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
    or b>c
    or d not between 110 and 150
order by col4,col3,col2,col1;

----
106 0 1050 1067
123 0 1240 1226
125 0 1290 1272
134 0 1300 1325
137 0 1390 1371
141 0 1430 1411
161 0 1600 1622
172 0 1700 1714
184 0 364 1828
187 0 376 1861
193 0 382 1918
195 0 398 1964
214 0 426 2125
215 0 432 2165
224 0 440 2226
225 0 458 2264
231 0 468 2323
247 0 490 2476
176 0 358 NULL
202 0 402 NULL
113 0 1120 NULL
150 0 1510 NULL
155 0 1580 NULL
166 0 1670 NULL
NULL 0 2360 NULL
102 0 NULL NULL
208 0 NULL NULL

statement query II
select e as col1,
       a-b as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col2,col1;

----
246 -4
192 -3
NULL -3
126 -2
219 -2
135 -1
144 -1
132 1
157 1
165 1
180 1
197 1
227 1
230 2
NULL 2

statement query II
select e as col1,
       a-b as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col2,col1;

----
246 -4
192 -3
NULL -3
126 -2
219 -2
135 -1
144 -1
132 1
157 1
165 1
180 1
197 1
227 1
230 2
NULL 2

statement query II
select e as col1,
       a-b as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col1;

----
246 -4
192 -3
NULL -3
126 -2
219 -2
135 -1
144 -1
132 1
157 1
165 1
180 1
197 1
227 1
230 2
NULL 2

statement query II
select e as col1,
       a-b as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col1;

----
246 -4
192 -3
NULL -3
126 -2
219 -2
135 -1
144 -1
132 1
157 1
165 1
180 1
197 1
227 1
230 2
NULL 2

statement query IIII
select c as col1,
       d-e as col2,
       abs(a) as col3,
       e as col4
from t1
order by col4,col2,col3,col1;

----
106 -1 107 109
113 4 NULL 110
119 -1 115 117
125 2 127 126
134 1 131 132
137 1 138 135
141 -4 142 144
147 NULL 149 146
155 NULL 159 157
161 2 163 162
166 NULL 168 165
172 -2 174 173
176 NULL 179 177
184 3 182 180
187 -4 188 189
193 -2 191 192
195 -1 199 197
202 -1 201 204
214 2 213 210
215 -2 216 219
224 1 220 221
225 -1 229 227
231 3 234 230
NULL 1 239 237
247 2 245 246
102 NULL 104 NULL
123 NULL 121 NULL
150 NULL 153 NULL
244 NULL 243 NULL
208 NULL NULL NULL

statement query ITIT
select c as col1,
       d-e as col2,
       abs(a) as col3,
       e as col4
from t1
order by col1,col2,col4,col3;

----
102 NULL 104 NULL
106 -1 107 109
113 4 NULL 110
119 -1 115 117
123 NULL 121 NULL
125 2 127 126
134 1 131 132
137 1 138 135
141 -4 142 144
147 NULL 149 146
150 NULL 153 NULL
155 NULL 159 157
161 2 163 162
166 NULL 168 165
172 -2 174 173
176 NULL 179 177
184 3 182 180
187 -4 188 189
193 -2 191 192
195 -1 199 197
202 -1 201 204
208 NULL NULL NULL
214 2 213 210
215 -2 216 219
224 1 220 221
225 -1 229 227
231 3 234 230
244 NULL 243 NULL
247 2 245 246
NULL 1 239 237

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where c>d
order by col4,col2,col3,col1;

----
121 2 0 1226
131 4 0 1325
138 5 0 1371
142 6 0 1411
174 12 0 1714
182 14 0 1828
188 15 0 1861
191 16 0 1918
213 19 0 2125
220 21 0 2226
104 0 0 NULL
115 0 0 NULL
NULL 18 0 NULL

statement query IIII
select a as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4 as col4
from t1
where c>d
order by col4,col3,col2,col1;

----
121 2 0 1226
131 4 0 1325
138 5 0 1371
142 6 0 1411
174 12 0 1714
182 14 0 1828
188 15 0 1861
191 16 0 1918
213 19 0 2125
220 21 0 2226
104 0 0 NULL
115 0 0 NULL
NULL 18 0 NULL

statement query TITITI
select a-b as col1,
       abs(a) as col2,
       e as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       d-e as col5,
       c as col6
from t1
where d not between 110 and 150
order by col6,col4,col5,col2,col3,col1;

----
NULL 104 NULL 0 NULL 102
2 107 109 0 -1 106
3 163 162 10 2 161
4 174 173 12 -2 172
1 182 180 14 3 184
2 188 189 15 -4 187
-3 191 192 16 -2 193
1 199 197 17 -1 195
NULL 201 204 0 -1 202
NULL NULL NULL 18 NULL 208
2 213 210 19 2 214
-2 216 219 20 -2 215
-3 220 221 21 1 224
1 229 227 22 -1 225
2 234 230 23 3 231
-4 245 246 26 2 247
3 239 237 24 1 NULL

statement query IIIIII
select a-b as col1,
       abs(a) as col2,
       e as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       d-e as col5,
       c as col6
from t1
where d not between 110 and 150
order by col4,col3,col1,col2,col6,col5;

----
2 107 109 0 -1 106
NULL 201 204 0 -1 202
NULL 104 NULL 0 NULL 102
3 163 162 10 2 161
4 174 173 12 -2 172
1 182 180 14 3 184
2 188 189 15 -4 187
-3 191 192 16 -2 193
1 199 197 17 -1 195
NULL NULL NULL 18 NULL 208
2 213 210 19 2 214
-2 216 219 20 -2 215
-3 220 221 21 1 224
1 229 227 22 -1 225
2 234 230 23 3 231
3 239 237 24 1 NULL
-4 245 246 26 2 247

statement query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
order by col1;

----
358
364
376
398
426
458
468
486
1050
1300
1450
1510
1580
1600
1670
1700
2360

statement query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
order by col1;

----
358
364
376
398
426
458
468
486
1050
1300
1450
1510
1580
1600
1670
1700
2360

statement query IIII
select c-d as col1,
       d as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
order by col4,col2,col3,col1;

----
1 140 111 -4
2 185 444 -4
1 171 555 -2
3 190 444 -2
-2 217 333 -2
-2 108 333 -1
3 116 333 -1
-1 196 555 -1
-1 203 222 -1
-1 226 555 -1
1 133 444 1
1 136 111 1
2 222 444 1
NULL 238 555 1
-3 128 333 2
-3 164 333 2
2 212 222 2
-1 248 444 2
1 183 333 3
-2 233 555 3
-1 114 555 4
1 101 555 NULL
1 122 333 NULL
1 207 555 NULL
NULL NULL 222 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL

statement query IIII
select c-d as col1,
       d as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
order by col4,col2,col1,col3;

----
1 140 111 -4
2 185 444 -4
1 171 555 -2
3 190 444 -2
-2 217 333 -2
-2 108 333 -1
3 116 333 -1
-1 196 555 -1
-1 203 222 -1
-1 226 555 -1
1 133 444 1
1 136 111 1
2 222 444 1
NULL 238 555 1
-3 128 333 2
-3 164 333 2
2 212 222 2
-1 248 444 2
1 183 333 3
-2 233 555 3
-1 114 555 4
1 101 555 NULL
1 122 333 NULL
1 207 555 NULL
NULL NULL 222 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL
NULL NULL 555 NULL

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b as col3,
       a-b as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1
where d>e
   and (e>a and e<b)
   and (e>c or e<d)
order by col4,col5,col2,col3,col1;

----
444 247 249 -4 0
444 224 223 -3 0

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b as col3,
       a-b as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1
where d>e
   and (e>a and e<b)
   and (e>c or e<d)
order by col5,col1,col4,col2,col3;

----
444 247 249 -4 0
444 224 223 -3 0

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b as col3,
       a-b as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1
where (e>c or e<d)
   and d>e
   and (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
444 247 249 -4 0
444 224 223 -3 0

statement query IIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       c as col2,
       b as col3,
       a-b as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5
from t1
where (e>c or e<d)
   and d>e
   and (e>a and e<b)
order by col2,col5,col1,col3,col4;

----
444 224 223 -3 0
444 247 249 -4 0

statement query TTTI
select b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       abs(a) as col4
from t1
order by col4,col2,col3,col1;

----
NULL NULL NULL 104
105 1612 107.0 107
NULL NULL NULL 115
124 NULL NULL 121
129 1902 127.0 127
130 1985 132.0 131
139 2046 137.0 138
143 2131 142.0 142
145 NULL NULL 149
151 NULL NULL 153
158 NULL NULL 159
160 2432 162.0 163
167 NULL NULL 168
170 2579 172.0 174
175 NULL NULL 179
181 2728 182.0 182
186 2806 187.0 188
194 2878 192.0 191
198 2949 197.0 199
NULL NULL NULL 201
211 3175 212.0 213
218 3260 217.0 216
223 3331 222.0 220
228 3399 227.0 229
232 3473 232.0 234
236 NULL NULL 239
240 NULL NULL 243
249 3706 247.0 245
112 NULL NULL NULL
206 NULL NULL NULL

statement query IIFI
select b as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       abs(a) as col4
from t1
order by col1,col2,col4,col3;

----
105 1612 107.0 107
112 NULL NULL NULL
124 NULL NULL 121
129 1902 127.0 127
130 1985 132.0 131
139 2046 137.0 138
143 2131 142.0 142
145 NULL NULL 149
151 NULL NULL 153
158 NULL NULL 159
160 2432 162.0 163
167 NULL NULL 168
170 2579 172.0 174
175 NULL NULL 179
181 2728 182.0 182
186 2806 187.0 188
194 2878 192.0 191
198 2949 197.0 199
206 NULL NULL NULL
211 3175 212.0 213
218 3260 217.0 216
223 3331 222.0 220
228 3399 227.0 229
232 3473 232.0 234
236 NULL NULL 239
240 NULL NULL 243
249 3706 247.0 245
NULL NULL NULL 104
NULL NULL NULL 115
NULL NULL NULL 201

statement query IIITTI
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (a+b+c+d+e)/5 as col4,
       d-e as col5,
       a+b*2 as col6
from t1
where c>d
order by col6,col4,col5,col2,col3,col1;

----
0 122 222 NULL NULL 369
0 133 333 132.0 1 391
0 136 222 137.0 1 416
0 140 222 142.0 -4 428
0 171 444 172.0 -2 514
0 183 333 182.0 3 544
0 185 333 187.0 -4 560
0 190 222 192.0 -2 579
0 212 333 212.0 2 635
0 222 222 222.0 1 666
0 116 444 NULL -1 NULL
0 101 444 NULL NULL NULL
0 207 444 NULL NULL NULL

statement query IIIFII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (a+b+c+d+e)/5 as col4,
       d-e as col5,
       a+b*2 as col6
from t1
where c>d
order by col4,col5,col6,col3,col2,col1;

----
0 133 333 132.0 1 391
0 136 222 137.0 1 416
0 140 222 142.0 -4 428
0 171 444 172.0 -2 514
0 183 333 182.0 3 544
0 185 333 187.0 -4 560
0 190 222 192.0 -2 579
0 212 333 212.0 2 635
0 222 222 222.0 1 666
0 116 444 NULL -1 NULL
0 122 222 NULL NULL 369
0 101 444 NULL NULL NULL
0 207 444 NULL NULL NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
order by col4,col2,col3,col1;

----
1371 111 827 0
1411 111 851 0
2125 222 1277 0
NULL 222 1455 0
NULL 222 NULL 0
1067 333 635 0
1226 333 738 0
1272 333 760 0
1622 333 966 0
1828 333 1096 0
2165 333 1297 0
NULL 333 NULL 0
1325 444 793 0
1861 444 1121 0
1918 444 1158 0
2226 444 1338 0
2476 444 1484 0
NULL 555 880 0
NULL 555 905 0
NULL 555 940 0
NULL 555 1000 0
1714 555 1030 0
NULL 555 1057 0
1964 555 1180 0
2264 555 1360 0
2323 555 1391 0
NULL 555 NULL 0
NULL 555 NULL 0
NULL 555 NULL 0
NULL 555 NULL 0

statement query IIII
select a+b*2+c*3+d*4 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
order by col4,col2,col3,col1;

----
1371 111 827 0
1411 111 851 0
2125 222 1277 0
NULL 222 1455 0
NULL 222 NULL 0
1067 333 635 0
1226 333 738 0
1272 333 760 0
1622 333 966 0
1828 333 1096 0
2165 333 1297 0
NULL 333 NULL 0
1325 444 793 0
1861 444 1121 0
1918 444 1158 0
2226 444 1338 0
2476 444 1484 0
NULL 555 880 0
NULL 555 905 0
NULL 555 940 0
NULL 555 1000 0
1714 555 1030 0
NULL 555 1057 0
1964 555 1180 0
2264 555 1360 0
2323 555 1391 0
NULL 555 NULL 0
NULL 555 NULL 0
NULL 555 NULL 0
NULL 555 NULL 0

statement query IIIIII
select a-b as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       d-e as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       e as col5,
       a+b*2+c*3 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col4,col5,col2,col3,col1;

----
2 1050 -1 333 109 635
-3 1240 NULL 333 NULL 738
-2 1290 2 333 126 760
1 1300 1 444 132 793
-1 1390 1 111 135 827
-1 1430 -4 111 144 851
4 1450 NULL 555 146 880
2 1510 NULL 555 NULL 905
1 1580 NULL 555 157 940
3 1600 2 333 162 966
1 1670 NULL 555 165 1000
4 1700 -2 555 173 1030
4 358 NULL 555 177 1057
1 364 3 333 180 1096
2 376 -4 444 189 1121
-3 382 -2 444 192 1158
1 398 -1 555 197 1180
2 426 2 222 210 1277
-2 432 -2 333 219 1297
-3 440 1 444 221 1338
1 458 -1 555 227 1360
2 468 3 555 230 1391
3 486 NULL 222 NULL 1455
-4 490 2 444 246 1484
NULL 402 -1 222 204 NULL
NULL NULL -1 333 117 NULL
NULL 1120 4 555 110 NULL
3 2360 1 555 237 NULL
NULL NULL NULL 555 NULL NULL
NULL NULL NULL 555 NULL NULL

statement query IIIIII
select a-b as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       d-e as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       e as col5,
       a+b*2+c*3 as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col1,col4,col5,col2,col3;

----
2 1050 -1 333 109 635
-3 1240 NULL 333 NULL 738
-2 1290 2 333 126 760
1 1300 1 444 132 793
-1 1390 1 111 135 827
-1 1430 -4 111 144 851
4 1450 NULL 555 146 880
2 1510 NULL 555 NULL 905
1 1580 NULL 555 157 940
3 1600 2 333 162 966
1 1670 NULL 555 165 1000
4 1700 -2 555 173 1030
4 358 NULL 555 177 1057
1 364 3 333 180 1096
2 376 -4 444 189 1121
-3 382 -2 444 192 1158
1 398 -1 555 197 1180
2 426 2 222 210 1277
-2 432 -2 333 219 1297
-3 440 1 444 221 1338
1 458 -1 555 227 1360
2 468 3 555 230 1391
3 486 NULL 222 NULL 1455
-4 490 2 444 246 1484
3 2360 1 555 237 NULL
NULL 402 -1 222 204 NULL
NULL NULL -1 333 117 NULL
NULL 1120 4 555 110 NULL
NULL NULL NULL 555 NULL NULL
NULL NULL NULL 555 NULL NULL

statement query III
select a-b as col1,
       a+b*2 as col2,
       c as col3
from t1
order by col2,col3,col1;

----
2 317 106
-3 369 123
-2 385 125
1 391 134
-1 416 137
-1 428 141
4 439 147
2 455 150
1 475 155
3 483 161
1 502 166
4 514 172
4 529 176
1 544 184
2 560 187
-3 579 193
1 595 195
2 635 214
-2 652 215
-3 666 224
1 685 225
2 698 231
3 711 NULL
3 723 244
-4 743 247
NULL NULL 102
NULL NULL 113
NULL NULL 119
NULL NULL 202
NULL NULL 208

statement query TTI
select a-b as col1,
       a+b*2 as col2,
       c as col3
from t1
order by col3,col1,col2;

----
NULL NULL 102
2 317 106
NULL NULL 113
NULL NULL 119
-3 369 123
-2 385 125
1 391 134
-1 416 137
-1 428 141
4 439 147
2 455 150
1 475 155
3 483 161
1 502 166
4 514 172
4 529 176
1 544 184
2 560 187
-3 579 193
1 595 195
NULL NULL 202
NULL NULL 208
2 635 214
-2 652 215
-3 666 224
1 685 225
2 698 231
3 723 244
-4 743 247
3 711 NULL

statement query IFI
select d-e as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2 as col3
from t1
where c between b-2 and d+2
   and a>b
order by col2,col3,col1;

----
-1 107.0 317
1 132.0 391
2 162.0 483
-2 172.0 514
3 182.0 544
-4 187.0 560
2 212.0 635
3 232.0 698

statement query IFI
select d-e as col1,
       (a+b+c+d+e)/5 as col2,
       a+b*2 as col3
from t1
where c between b-2 and d+2
   and a>b
order by col3,col2,col1;

----
-1 107.0 317
1 132.0 391
2 162.0 483
-2 172.0 514
3 182.0 544
-4 187.0 560
2 212.0 635
3 232.0 698

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where b>c
   and d>e
   and d not between 110 and 150
order by col2,col3,col1;

----
23 0 233
26 0 248

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where b>c
   and d>e
   and d not between 110 and 150
order by col3,col2,col1;

----
23 0 233
26 0 248

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where d not between 110 and 150
   and d>e
   and b>c
order by col2,col3,col1;

----
23 0 233
26 0 248

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where d not between 110 and 150
   and d>e
   and b>c
order by col3,col2,col1;

----
23 0 233
26 0 248

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where b>c
   and d not between 110 and 150
   and d>e
order by col2,col3,col1;

----
23 0 233
26 0 248

statement query III
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       d as col3
from t1
where b>c
   and d not between 110 and 150
   and d>e
order by col3,col1,col2;

----
23 0 233
26 0 248

statement query TI
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or (c<=d-2 or c>=d+2)
order by col2,col1;

----
NULL 104
635 107
NULL 115
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
NULL 201
1277 213
1297 216
1338 220
1360 229
1391 234
NULL 239
1484 245
NULL NULL

statement query II
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or (c<=d-2 or c>=d+2)
order by col1,col2;

----
635 107
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
1277 213
1297 216
1338 220
1360 229
1391 234
1484 245
NULL 104
NULL 115
NULL 201
NULL 239
NULL NULL

statement query TI
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where d not between 110 and 150
    or (c<=d-2 or c>=d+2)
    or e+d between a+b-10 and c+130
order by col2,col1;

----
NULL 104
635 107
NULL 115
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
NULL 201
1277 213
1297 216
1338 220
1360 229
1391 234
NULL 239
1484 245
NULL NULL

statement query II
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where d not between 110 and 150
    or (c<=d-2 or c>=d+2)
    or e+d between a+b-10 and c+130
order by col1,col2;

----
635 107
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
1277 213
1297 216
1338 220
1360 229
1391 234
1484 245
NULL 104
NULL 115
NULL 201
NULL 239
NULL NULL

statement query TI
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where (c<=d-2 or c>=d+2)
    or e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col2,col1;

----
NULL 104
635 107
NULL 115
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
NULL 201
1277 213
1297 216
1338 220
1360 229
1391 234
NULL 239
1484 245
NULL NULL

statement query TI
select a+b*2+c*3 as col1,
       abs(a) as col2
from t1
where (c<=d-2 or c>=d+2)
    or e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col2,col1;

----
NULL 104
635 107
NULL 115
760 127
966 163
1030 174
1096 182
1121 188
1158 191
1180 199
NULL 201
1277 213
1297 216
1338 220
1360 229
1391 234
NULL 239
1484 245
NULL NULL

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or b>c
order by col6,col4,col5,col2,col3,col1;

----
-1 0 -1 107 2 109
4 3 2 127 -2 126
2 5 1 138 -1 135
2 6 -4 142 -1 144
3 9 NULL 159 1 157
-1 10 2 163 3 162
1 11 NULL 168 1 165
-2 12 -2 174 4 173
-3 14 3 182 1 180
-1 15 -4 188 2 189
1 16 -2 191 -3 192
3 17 -1 199 1 197
NULL 0 -1 201 NULL 204
-3 19 2 213 2 210
3 20 -2 216 -2 219
-1 21 1 220 -3 221
3 22 -1 229 1 227
1 23 3 234 2 230
NULL 24 1 239 3 237
2 26 2 245 -4 246
NULL 0 NULL 104 NULL NULL
1 2 NULL 121 -3 NULL
1 8 NULL 153 2 NULL
-2 18 NULL NULL NULL NULL

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or b>c
order by col5,col3,col4,col1,col6,col2;

----
2 26 2 245 -4 246
1 16 -2 191 -3 192
-1 21 1 220 -3 221
1 2 NULL 121 -3 NULL
3 20 -2 216 -2 219
4 3 2 127 -2 126
2 6 -4 142 -1 144
2 5 1 138 -1 135
3 17 -1 199 1 197
3 22 -1 229 1 227
-3 14 3 182 1 180
3 9 NULL 159 1 157
1 11 NULL 168 1 165
-1 15 -4 188 2 189
-1 0 -1 107 2 109
-3 19 2 213 2 210
1 23 3 234 2 230
1 8 NULL 153 2 NULL
NULL 24 1 239 3 237
-1 10 2 163 3 162
-2 12 -2 174 4 173
NULL 0 -1 201 NULL 204
NULL 0 NULL 104 NULL NULL
-2 18 NULL NULL NULL NULL

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where b>c
    or e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1;

----
-1 0 -1 107 2 109
4 3 2 127 -2 126
2 5 1 138 -1 135
2 6 -4 142 -1 144
3 9 NULL 159 1 157
-1 10 2 163 3 162
1 11 NULL 168 1 165
-2 12 -2 174 4 173
-3 14 3 182 1 180
-1 15 -4 188 2 189
1 16 -2 191 -3 192
3 17 -1 199 1 197
NULL 0 -1 201 NULL 204
-3 19 2 213 2 210
3 20 -2 216 -2 219
-1 21 1 220 -3 221
3 22 -1 229 1 227
1 23 3 234 2 230
NULL 24 1 239 3 237
2 26 2 245 -4 246
NULL 0 NULL 104 NULL NULL
1 2 NULL 121 -3 NULL
1 8 NULL 153 2 NULL
-2 18 NULL NULL NULL NULL

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where b>c
    or e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col2,col6,col5,col1,col3,col4;

----
-1 0 -1 107 2 109
NULL 0 -1 201 NULL 204
NULL 0 NULL 104 NULL NULL
1 2 NULL 121 -3 NULL
4 3 2 127 -2 126
2 5 1 138 -1 135
2 6 -4 142 -1 144
1 8 NULL 153 2 NULL
3 9 NULL 159 1 157
-1 10 2 163 3 162
1 11 NULL 168 1 165
-2 12 -2 174 4 173
-3 14 3 182 1 180
-1 15 -4 188 2 189
1 16 -2 191 -3 192
3 17 -1 199 1 197
-2 18 NULL NULL NULL NULL
-3 19 2 213 2 210
3 20 -2 216 -2 219
-1 21 1 220 -3 221
3 22 -1 229 1 227
1 23 3 234 2 230
NULL 24 1 239 3 237
2 26 2 245 -4 246

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where d not between 110 and 150
    or b>c
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
-1 0 -1 107 2 109
4 3 2 127 -2 126
2 5 1 138 -1 135
2 6 -4 142 -1 144
3 9 NULL 159 1 157
-1 10 2 163 3 162
1 11 NULL 168 1 165
-2 12 -2 174 4 173
-3 14 3 182 1 180
-1 15 -4 188 2 189
1 16 -2 191 -3 192
3 17 -1 199 1 197
NULL 0 -1 201 NULL 204
-3 19 2 213 2 210
3 20 -2 216 -2 219
-1 21 1 220 -3 221
3 22 -1 229 1 227
1 23 3 234 2 230
NULL 24 1 239 3 237
2 26 2 245 -4 246
NULL 0 NULL 104 NULL NULL
1 2 NULL 121 -3 NULL
1 8 NULL 153 2 NULL
-2 18 NULL NULL NULL NULL

statement query IIIIII
select b-c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       d-e as col3,
       abs(a) as col4,
       a-b as col5,
       e as col6
from t1
where d not between 110 and 150
    or b>c
    or e+d between a+b-10 and c+130
order by col5,col6,col1,col4,col2,col3;

----
2 26 2 245 -4 246
1 16 -2 191 -3 192
-1 21 1 220 -3 221
1 2 NULL 121 -3 NULL
4 3 2 127 -2 126
3 20 -2 216 -2 219
2 5 1 138 -1 135
2 6 -4 142 -1 144
3 9 NULL 159 1 157
1 11 NULL 168 1 165
-3 14 3 182 1 180
3 17 -1 199 1 197
3 22 -1 229 1 227
-1 0 -1 107 2 109
-1 15 -4 188 2 189
-3 19 2 213 2 210
1 23 3 234 2 230
1 8 NULL 153 2 NULL
-1 10 2 163 3 162
NULL 24 1 239 3 237
-2 12 -2 174 4 173
NULL 0 -1 201 NULL 204
-2 18 NULL NULL NULL NULL
NULL 0 NULL 104 NULL NULL

statement query FIII
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4
from t1
where (a>b-2 and a<b+2)
   and c>d
order by col4,col2,col3,col1;

----
132.0 1 333 130
137.0 1 222 139
142.0 1 222 143
182.0 1 333 181

statement query FIII
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4
from t1
where (a>b-2 and a<b+2)
   and c>d
order by col3,col2,col1,col4;

----
137.0 1 222 139
142.0 1 222 143
132.0 1 333 130
182.0 1 333 181

statement query FIII
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4
from t1
where c>d
   and (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
132.0 1 333 130
137.0 1 222 139
142.0 1 222 143
182.0 1 333 181

statement query FIII
select (a+b+c+d+e)/5 as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       b as col4
from t1
where c>d
   and (a>b-2 and a<b+2)
order by col1,col4,col2,col3;

----
132.0 1 333 130
137.0 1 222 139
142.0 1 222 143
182.0 1 333 181

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (c<=d-2 or c>=d+2)
   and c>d
   and (e>a and e<b)
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (c<=d-2 or c>=d+2)
   and c>d
   and (e>a and e<b)
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (c<=d-2 or c>=d+2)
   and (e>a and e<b)
   and c>d
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (c<=d-2 or c>=d+2)
   and (e>a and e<b)
   and c>d
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and c>d
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and c>d
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where c>d
   and (c<=d-2 or c>=d+2)
   and (e>a and e<b)
order by col2,col1;

----
0 444
0 444

statement query II
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2
from t1
where c>d
   and (c<=d-2 or c>=d+2)
   and (e>a and e<b)
order by col1,col2;

----
0 444
0 444

statement query IIIIF
select abs(b-c) as col1,
       a-b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       (a+b+c+d+e)/5 as col5
from t1
where d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
1 2 1050 0 107.0
NULL NULL 402 0 NULL
NULL NULL NULL 0 NULL
1 3 1600 10 162.0
2 4 1700 12 172.0
3 1 364 14 182.0
1 2 376 15 187.0
1 -3 382 16 192.0
3 1 398 17 197.0
2 NULL NULL 18 NULL
3 2 426 19 212.0
3 -2 432 20 217.0
1 -3 440 21 222.0
3 1 458 22 227.0
1 2 468 23 232.0
NULL 3 2360 24 NULL
2 -4 490 26 247.0

statement query IIIIF
select abs(b-c) as col1,
       a-b as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       (a+b+c+d+e)/5 as col5
from t1
where d not between 110 and 150
order by col5,col3,col2,col4,col1;

----
1 2 1050 0 107.0
1 3 1600 10 162.0
2 4 1700 12 172.0
3 1 364 14 182.0
1 2 376 15 187.0
1 -3 382 16 192.0
3 1 398 17 197.0
3 2 426 19 212.0
3 -2 432 20 217.0
1 -3 440 21 222.0
3 1 458 22 227.0
1 2 468 23 232.0
2 -4 490 26 247.0
NULL NULL 402 0 NULL
NULL 3 2360 24 NULL
NULL NULL NULL 0 NULL
2 NULL NULL 18 NULL

statement query III
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(a) as col2,
       abs(b-c) as col3
from t1
where e+d between a+b-10 and c+130
   and b>c
order by col2,col3,col1;

----
0 127 4

statement query III
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(a) as col2,
       abs(b-c) as col3
from t1
where e+d between a+b-10 and c+130
   and b>c
order by col3,col1,col2;

----
0 127 4

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
1067 107
NULL 115
1272 127
1622 163
1861 188
1918 191
2125 213
2165 216
2226 220
2323 234

statement query II
select a+b*2+c*3+d*4 as col1,
       a as col2
from t1
where (c<=d-2 or c>=d+2)
order by col2,col1;

----
1067 107
NULL 115
1272 127
1622 163
1861 188
1918 191
2125 213
2165 216
2226 220
2323 234

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       b as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c between b-2 and d+2
    or (e>c or e<d)
    or c>d
order by col4,col2,col3,col1;

----
333 109 105 0
444 110 112 0
444 117 NULL 0
222 126 129 0
333 132 130 0
222 135 139 0
222 144 143 0
333 157 158 0
444 162 160 0
444 173 170 0
444 177 175 0
333 180 181 0
333 189 186 0
222 192 194 0
333 197 198 0
444 204 NULL 0
333 210 211 0
222 219 218 0
222 221 223 0
333 227 228 0
333 230 232 0
444 237 236 0
111 246 249 0
222 NULL 124 0
444 NULL 206 0
444 NULL NULL 0

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       b as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c between b-2 and d+2
    or (e>c or e<d)
    or c>d
order by col3,col4,col2,col1;

----
333 109 105 0
444 110 112 0
222 NULL 124 0
222 126 129 0
333 132 130 0
222 135 139 0
222 144 143 0
333 157 158 0
444 162 160 0
444 173 170 0
444 177 175 0
333 180 181 0
333 189 186 0
222 192 194 0
333 197 198 0
444 NULL 206 0
333 210 211 0
222 219 218 0
222 221 223 0
333 227 228 0
333 230 232 0
444 237 236 0
111 246 249 0
444 117 NULL 0
444 204 NULL 0
444 NULL NULL 0

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       b as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c>d
    or (e>c or e<d)
    or c between b-2 and d+2
order by col4,col2,col3,col1;

----
333 109 105 0
444 110 112 0
444 117 NULL 0
222 126 129 0
333 132 130 0
222 135 139 0
222 144 143 0
333 157 158 0
444 162 160 0
444 173 170 0
444 177 175 0
333 180 181 0
333 189 186 0
222 192 194 0
333 197 198 0
444 204 NULL 0
333 210 211 0
222 219 218 0
222 221 223 0
333 227 228 0
333 230 232 0
444 237 236 0
111 246 249 0
222 NULL 124 0
444 NULL 206 0
444 NULL NULL 0

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       b as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4
from t1
where c>d
    or (e>c or e<d)
    or c between b-2 and d+2
order by col3,col1,col2,col4;

----
333 109 105 0
444 110 112 0
222 NULL 124 0
222 126 129 0
333 132 130 0
222 135 139 0
222 144 143 0
333 157 158 0
444 162 160 0
444 173 170 0
444 177 175 0
333 180 181 0
333 189 186 0
222 192 194 0
333 197 198 0
444 NULL 206 0
333 210 211 0
222 219 218 0
222 221 223 0
333 227 228 0
333 230 232 0
444 237 236 0
111 246 249 0
444 117 NULL 0
444 204 NULL 0
444 NULL NULL 0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where a>b
order by col1;

----
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

statement query I
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1
from t1
where a>b
order by col1;

----
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0

statement query II
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
order by col2,col1;

----
1612 0
NULL 0
NULL 0
NULL 0
NULL 1
NULL 2
1902 3
1985 4
2046 5
2131 6
NULL 7
NULL 8
NULL 9
2432 10
NULL 11
2579 12
NULL 13
2728 14
2806 15
2878 16
2949 17
NULL 18
3175 19
3260 20
3331 21
3399 22
3473 23
NULL 24
NULL 25
3706 26

statement query II
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2
from t1
order by col2,col1;

----
1612 0
NULL 0
NULL 0
NULL 0
NULL 1
NULL 2
1902 3
1985 4
2046 5
2131 6
NULL 7
NULL 8
NULL 9
2432 10
NULL 11
2579 12
NULL 13
2728 14
2806 15
2878 16
2949 17
NULL 18
3175 19
3260 20
3331 21
3399 22
3473 23
NULL 24
NULL 25
3706 26

statement query IIIIIIF
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       d-e as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
126 3 222 333 2 0 127.0
135 5 222 111 1 0 137.0
144 6 222 111 -4 0 142.0
192 16 222 444 -2 0 192.0
197 17 333 555 -1 0 197.0
219 20 222 333 -2 0 217.0
227 22 333 555 -1 0 227.0
230 23 333 555 3 0 232.0
246 26 111 444 2 0 247.0
NULL 2 222 333 NULL 0 NULL
NULL 8 333 555 NULL 0 NULL
157 9 333 555 NULL 0 NULL
165 11 333 555 NULL 0 NULL

statement query IIIIIIF
select e as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       d-e as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
order by col5,col1,col3,col6,col7,col4,col2;

----
144 6 222 111 -4 0 142.0
192 16 222 444 -2 0 192.0
219 20 222 333 -2 0 217.0
197 17 333 555 -1 0 197.0
227 22 333 555 -1 0 227.0
135 5 222 111 1 0 137.0
126 3 222 333 2 0 127.0
246 26 111 444 2 0 247.0
230 23 333 555 3 0 232.0
157 9 333 555 NULL 0 NULL
165 11 333 555 NULL 0 NULL
NULL 2 222 333 NULL 0 NULL
NULL 8 333 555 NULL 0 NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c between b-2 and d+2
    or c>d
    or (e>a and e<b)
order by col4,col2,col3,col1;

----
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
122 738 121 NULL
101 NULL 104 NULL
207 NULL NULL NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c between b-2 and d+2
    or c>d
    or (e>a and e<b)
order by col4,col2,col3,col1;

----
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
122 738 121 NULL
101 NULL 104 NULL
207 NULL NULL NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where (e>a and e<b)
    or c>d
    or c between b-2 and d+2
order by col4,col2,col3,col1;

----
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
122 738 121 NULL
101 NULL 104 NULL
207 NULL NULL NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where (e>a and e<b)
    or c>d
    or c between b-2 and d+2
order by col2,col1,col4,col3;

----
108 635 107 109
122 738 121 NULL
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
101 NULL 104 NULL
114 NULL NULL 110
116 NULL 115 117
207 NULL NULL NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c>d
    or (e>a and e<b)
    or c between b-2 and d+2
order by col4,col2,col3,col1;

----
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
122 738 121 NULL
101 NULL 104 NULL
207 NULL NULL NULL

statement query ITIT
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c>d
    or (e>a and e<b)
    or c between b-2 and d+2
order by col3,col4,col2,col1;

----
101 NULL 104 NULL
108 635 107 109
116 NULL 115 117
122 738 121 NULL
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
114 NULL NULL 110
207 NULL NULL NULL

statement query IIII
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c between b-2 and d+2
    or (e>a and e<b)
    or c>d
order by col4,col2,col3,col1;

----
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246
122 738 121 NULL
101 NULL 104 NULL
207 NULL NULL NULL

statement query ITIT
select d as col1,
       a+b*2+c*3 as col2,
       a as col3,
       e as col4
from t1
where c between b-2 and d+2
    or (e>a and e<b)
    or c>d
order by col1,col3,col2,col4;

----
101 NULL 104 NULL
108 635 107 109
114 NULL NULL 110
116 NULL 115 117
122 738 121 NULL
133 793 131 132
136 827 138 135
140 851 142 144
164 966 163 162
171 1030 174 173
183 1096 182 180
185 1121 188 189
190 1158 191 192
207 NULL NULL NULL
212 1277 213 210
222 1338 220 221
233 1391 234 230
248 1484 245 246

statement query IIIFI
select b-c as col1,
       b as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       c as col5
from t1
order by col4,col5,col2,col3,col1;

----
-1 105 -1 107.0 106
4 129 2 127.0 125
-4 130 1 132.0 134
2 139 1 137.0 137
2 143 -4 142.0 141
-1 160 2 162.0 161
-2 170 -2 172.0 172
-3 181 3 182.0 184
-1 186 -4 187.0 187
1 194 -2 192.0 193
3 198 -1 197.0 195
-3 211 2 212.0 214
3 218 -2 217.0 215
-1 223 1 222.0 224
3 228 -1 227.0 225
1 232 3 232.0 231
2 249 2 247.0 247
NULL NULL NULL NULL 102
-1 112 4 NULL 113
NULL NULL -1 NULL 119
1 124 NULL NULL 123
-2 145 NULL NULL 147
1 151 NULL NULL 150
3 158 NULL NULL 155
1 167 NULL NULL 166
-1 175 NULL NULL 176
NULL NULL -1 NULL 202
-2 206 NULL NULL 208
-4 240 NULL NULL 244
NULL 236 1 NULL NULL

statement query TTTTI
select b-c as col1,
       b as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4,
       c as col5
from t1
order by col5,col1,col2,col4,col3;

----
NULL NULL NULL NULL 102
-1 105 -1 107.0 106
-1 112 4 NULL 113
NULL NULL -1 NULL 119
1 124 NULL NULL 123
4 129 2 127.0 125
-4 130 1 132.0 134
2 139 1 137.0 137
2 143 -4 142.0 141
-2 145 NULL NULL 147
1 151 NULL NULL 150
3 158 NULL NULL 155
-1 160 2 162.0 161
1 167 NULL NULL 166
-2 170 -2 172.0 172
-1 175 NULL NULL 176
-3 181 3 182.0 184
-1 186 -4 187.0 187
1 194 -2 192.0 193
3 198 -1 197.0 195
NULL NULL -1 NULL 202
-2 206 NULL NULL 208
-3 211 2 212.0 214
3 218 -2 217.0 215
-1 223 1 222.0 224
3 228 -1 227.0 225
1 232 3 232.0 231
-4 240 NULL NULL 244
2 249 2 247.0 247
NULL 236 1 NULL NULL

statement query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1;

----
358
364
376
382
398
402
426
432
440
458
468
486
490
1050
1120
1240
1290
1300
1390
1430
1450
1510
1580
1600
1670
1700
2360
NULL
NULL
NULL

statement query I
select case when c>avg_c then a*2 else b*10 end as col1
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1;

----
358
364
376
382
398
402
426
432
440
458
468
486
490
1050
1120
1240
1290
1300
1390
1430
1450
1510
1580
1600
1670
1700
2360
NULL
NULL
NULL

statement query I
select a+b*2 as col1
from t1
where d>e
order by col1;

----
385
391
416
483
544
635
666
698
711
743
NULL

statement query I
select a+b*2 as col1
from t1
where d>e
order by col1;

----
385
391
416
483
544
635
666
698
711
743
NULL

statement query TTIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where c between b-2 and d+2
    or d not between 110 and 150
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 0 104 444 101
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
2 NULL 0 NULL 444 207
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
NULL 2360 0 239 444 238
2 490 0 245 111 248

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where c between b-2 and d+2
    or d not between 110 and 150
    or e+d between a+b-10 and c+130
order by col1,col4,col6,col3,col2,col5;

----
1 1050 0 107 333 108
1 1240 0 121 222 122
1 1600 0 163 444 164
1 376 0 188 333 185
1 382 0 191 222 190
1 440 0 220 222 222
1 468 0 234 333 233
1 1120 0 NULL 444 114
2 1390 0 138 222 136
2 1430 0 142 222 140
2 1700 0 174 444 171
2 490 0 245 111 248
2 NULL 0 NULL 444 207
3 364 0 182 333 183
3 398 0 199 333 196
3 426 0 213 333 212
3 432 0 216 222 217
3 458 0 229 333 226
4 1290 0 127 222 128
4 1300 0 131 333 133
NULL NULL 0 104 444 101
NULL 402 0 201 444 203
NULL 2360 0 239 444 238

statement query TTIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
    or c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 0 104 444 101
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
2 NULL 0 NULL 444 207
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
NULL 2360 0 239 444 238
2 490 0 245 111 248

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
    or c between b-2 and d+2
order by col1,col3,col6,col4,col2,col5;

----
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
1 1600 0 163 444 164
1 376 0 188 333 185
1 382 0 191 222 190
1 440 0 220 222 222
1 468 0 234 333 233
2 1390 0 138 222 136
2 1430 0 142 222 140
2 1700 0 174 444 171
2 NULL 0 NULL 444 207
2 490 0 245 111 248
3 364 0 182 333 183
3 398 0 199 333 196
3 426 0 213 333 212
3 432 0 216 222 217
3 458 0 229 333 226
4 1290 0 127 222 128
4 1300 0 131 333 133
NULL NULL 0 104 444 101
NULL 402 0 201 444 203
NULL 2360 0 239 444 238

statement query TTIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 0 104 444 101
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
2 NULL 0 NULL 444 207
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
NULL 2360 0 239 444 238
2 490 0 245 111 248

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
    or c between b-2 and d+2
order by col2,col5,col3,col6,col4,col1;

----
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
2 490 0 245 111 248
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
NULL 2360 0 239 444 238
NULL NULL 0 104 444 101
2 NULL 0 NULL 444 207

statement query TTIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
NULL NULL 0 104 444 101
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
2 NULL 0 NULL 444 207
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
NULL 2360 0 239 444 238
2 490 0 245 111 248

statement query TTIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(a) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       d as col6
from t1
where d not between 110 and 150
    or c between b-2 and d+2
    or e+d between a+b-10 and c+130
order by col6,col5,col2,col3,col4,col1;

----
NULL NULL 0 104 444 101
1 1050 0 107 333 108
1 1120 0 NULL 444 114
1 1240 0 121 222 122
4 1290 0 127 222 128
4 1300 0 131 333 133
2 1390 0 138 222 136
2 1430 0 142 222 140
1 1600 0 163 444 164
2 1700 0 174 444 171
3 364 0 182 333 183
1 376 0 188 333 185
1 382 0 191 222 190
3 398 0 199 333 196
NULL 402 0 201 444 203
2 NULL 0 NULL 444 207
3 426 0 213 333 212
3 432 0 216 222 217
1 440 0 220 222 222
3 458 0 229 333 226
1 468 0 234 333 233
NULL 2360 0 239 444 238
2 490 0 245 111 248

statement query II
select d-e as col1,
       b-c as col2
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col2,col1;

----
1 -4
3 -3
-1 -1
NULL 1
-4 2
1 2
-1 3
-1 3
NULL 3
2 4

statement query II
select d-e as col1,
       b-c as col2
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col2,col1;

----
1 -4
3 -3
-1 -1
NULL 1
-4 2
1 2
-1 3
-1 3
NULL 3
2 4

statement query II
select d-e as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col2,col1;

----
1 -4
3 -3
-1 -1
NULL 1
-4 2
1 2
-1 3
-1 3
NULL 3
2 4

statement query II
select d-e as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
order by col2,col1;

----
1 -4
3 -3
-1 -1
NULL 1
-4 2
1 2
-1 3
-1 3
NULL 3
2 4

statement query II
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2
from t1
where (e>c or e<d)
order by col2,col1;

----
1612 105
NULL 112
1902 129
1985 130
2046 139
2131 143
NULL 158
2432 160
2579 170
NULL 175
2728 181
2806 186
2949 198
3175 211
3260 218
3331 223
3399 228
3473 232
NULL 236
3706 249
NULL NULL

statement query II
select a+b*2+c*3+d*4+e*5 as col1,
       b as col2
from t1
where (e>c or e<d)
order by col2,col1;

----
1612 105
NULL 112
1902 129
1985 130
2046 139
2131 143
NULL 158
2432 160
2579 170
NULL 175
2728 181
2806 186
2949 198
3175 211
3260 218
3331 223
3399 228
3473 232
NULL 236
3706 249
NULL NULL

statement query III
select e as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
order by col2,col3,col1;

----
126 -3 222
162 -3 444
219 -2 222
109 -2 333
230 -2 333
246 -1 111
197 -1 333
227 -1 333
110 -1 444
204 -1 444
135 1 222
144 1 222
NULL 1 222
132 1 333
180 1 333
173 1 444
NULL 1 444
NULL 1 444
221 2 222
189 2 333
210 2 333
192 3 222
117 3 444
157 NULL 333
165 NULL 333
NULL NULL 333
146 NULL 444
177 NULL 444
237 NULL 444
NULL NULL 444

statement query III
select e as col1,
       c-d as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
order by col1,col3,col2;

----
109 -2 333
110 -1 444
117 3 444
126 -3 222
132 1 333
135 1 222
144 1 222
146 NULL 444
157 NULL 333
162 -3 444
165 NULL 333
173 1 444
177 NULL 444
180 1 333
189 2 333
192 3 222
197 -1 333
204 -1 444
210 2 333
219 -2 222
221 2 222
227 -1 333
230 -2 333
237 NULL 444
246 -1 111
NULL 1 222
NULL NULL 333
NULL 1 444
NULL 1 444
NULL NULL 444

statement query I
select a-b as col1
from t1
order by col1;

----
-4
-3
-3
-3
-2
-2
-1
-1
1
1
1
1
1
1
2
2
2
2
2
3
3
3
4
4
4
NULL
NULL
NULL
NULL
NULL

statement query I
select a-b as col1
from t1
order by col1;

----
-4
-3
-3
-3
-2
-2
-1
-1
1
1
1
1
1
1
2
2
2
2
2
3
3
3
4
4
4
NULL
NULL
NULL
NULL
NULL

statement query IIIII
select d as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       d-e as col3,
       a+b*2 as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
190 222 -2 579 444
222 222 1 666 444
248 111 2 743 444

statement query IIIII
select d as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       d-e as col3,
       a+b*2 as col4,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col5
from t1
where (e>a and e<b)
order by col1,col5,col3,col4,col2;

----
190 222 -2 579 444
222 222 1 666 444
248 111 2 743 444

statement query IIIIII
select a as col1,
       a+b*2+c*3+d*4 as col2,
       e as col3,
       a-b as col4,
       abs(b-c) as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----
138 1371 135 -1 2 222
142 1411 144 -1 2 222
168 NULL 165 1 1 333
182 1828 180 1 3 333
199 1964 197 1 3 333
229 2264 227 1 3 333
159 NULL 157 1 3 333
131 1325 132 1 4 333

statement query ITIIII
select a as col1,
       a+b*2+c*3+d*4 as col2,
       e as col3,
       a-b as col4,
       abs(b-c) as col5,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col6
from t1
where (a>b-2 and a<b+2)
order by col5,col2,col6,col4,col3,col1;

----
168 NULL 165 1 1 333
138 1371 135 -1 2 222
142 1411 144 -1 2 222
182 1828 180 1 3 333
199 1964 197 1 3 333
229 2264 227 1 3 333
159 NULL 157 1 3 333
131 1325 132 1 4 333

statement query II
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
order by col2,col1;

----
125 1902
134 1985
137 2046
141 2131
161 2432
172 2579
184 2728
187 2806
193 2878
195 2949
214 3175
215 3260
224 3331
225 3399
231 3473
247 3706
113 NULL
123 NULL
147 NULL
150 NULL
155 NULL
166 NULL
176 NULL
208 NULL
244 NULL
NULL NULL

statement query II
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
order by col2,col1;

----
125 1902
134 1985
137 2046
141 2131
161 2432
172 2579
184 2728
187 2806
193 2878
195 2949
214 3175
215 3260
224 3331
225 3399
231 3473
247 3706
113 NULL
123 NULL
147 NULL
150 NULL
155 NULL
166 NULL
176 NULL
208 NULL
244 NULL
NULL NULL

statement query II
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2
from t1
where b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
125 1902
134 1985
137 2046
141 2131
161 2432
172 2579
184 2728
187 2806
193 2878
195 2949
214 3175
215 3260
224 3331
225 3399
231 3473
247 3706
113 NULL
123 NULL
147 NULL
150 NULL
155 NULL
166 NULL
176 NULL
208 NULL
244 NULL
NULL NULL

statement query IT
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2
from t1
where b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
113 NULL
123 NULL
125 1902
134 1985
137 2046
141 2131
147 NULL
150 NULL
155 NULL
161 2432
166 NULL
172 2579
176 NULL
184 2728
187 2806
193 2878
195 2949
208 NULL
214 3175
215 3260
224 3331
225 3399
231 3473
244 NULL
247 3706
NULL NULL

statement query TIT
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
    or a>b
order by col2,col3,col1;

----
NULL 101 NULL
107.0 108 1
NULL 114 1
NULL 116 NULL
NULL 122 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
NULL 203 NULL
NULL 207 2
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
NULL 238 NULL
247.0 248 2
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL NULL 2
NULL NULL 3
NULL NULL 4

statement query FII
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
    or a>b
order by col1,col3,col2;

----
107.0 108 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
247.0 248 2
NULL 114 1
NULL 122 1
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL 207 2
NULL NULL 2
NULL NULL 3
NULL NULL 4
NULL 101 NULL
NULL 116 NULL
NULL 203 NULL
NULL 238 NULL

statement query TIT
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
order by col2,col3,col1;

----
NULL 101 NULL
107.0 108 1
NULL 114 1
NULL 116 NULL
NULL 122 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
NULL 203 NULL
NULL 207 2
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
NULL 238 NULL
247.0 248 2
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL NULL 2
NULL NULL 3
NULL NULL 4

statement query TIT
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
order by col2,col3,col1;

----
NULL 101 NULL
107.0 108 1
NULL 114 1
NULL 116 NULL
NULL 122 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
NULL 203 NULL
NULL 207 2
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
NULL 238 NULL
247.0 248 2
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL NULL 2
NULL NULL 3
NULL NULL 4

statement query TIT
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where a>b
    or (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1;

----
NULL 101 NULL
107.0 108 1
NULL 114 1
NULL 116 NULL
NULL 122 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
NULL 203 NULL
NULL 207 2
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
NULL 238 NULL
247.0 248 2
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL NULL 2
NULL NULL 3
NULL NULL 4

statement query TIT
select (a+b+c+d+e)/5 as col1,
       d as col2,
       abs(b-c) as col3
from t1
where a>b
    or (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1,col3;

----
NULL 101 NULL
107.0 108 1
NULL 114 1
NULL 116 NULL
NULL 122 1
127.0 128 4
132.0 133 4
137.0 136 2
142.0 140 2
162.0 164 1
172.0 171 2
182.0 183 3
187.0 185 1
192.0 190 1
197.0 196 3
NULL 203 NULL
NULL 207 2
212.0 212 3
217.0 217 3
222.0 222 1
227.0 226 3
232.0 233 1
NULL 238 NULL
247.0 248 2
NULL NULL 1
NULL NULL 1
NULL NULL 1
NULL NULL 2
NULL NULL 3
NULL NULL 4

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where a>b
    or b>c
    or (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
131 133 132.0 444 1325 4
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
163 164 162.0 333 1622 10
168 NULL NULL 555 NULL 11
174 171 172.0 555 1714 12
179 NULL NULL 555 NULL 13
182 183 182.0 333 1828 14
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
199 196 197.0 555 1964 17
213 212 212.0 222 2125 19
216 217 217.0 333 2165 20
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
239 238 NULL 555 NULL 24
243 NULL NULL 222 NULL 25
245 248 247.0 444 2476 26

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where a>b
    or b>c
    or (a>b-2 and a<b+2)
order by col4,col2,col5,col1,col6,col3;

----
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
213 212 212.0 222 2125 19
243 NULL NULL 222 NULL 25
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
163 164 162.0 333 1622 10
182 183 182.0 333 1828 14
216 217 217.0 333 2165 20
131 133 132.0 444 1325 4
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
245 248 247.0 444 2476 26
174 171 172.0 555 1714 12
199 196 197.0 555 1964 17
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
239 238 NULL 555 NULL 24
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
168 NULL NULL 555 NULL 11
179 NULL NULL 555 NULL 13

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where b>c
    or a>b
    or (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
131 133 132.0 444 1325 4
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
163 164 162.0 333 1622 10
168 NULL NULL 555 NULL 11
174 171 172.0 555 1714 12
179 NULL NULL 555 NULL 13
182 183 182.0 333 1828 14
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
199 196 197.0 555 1964 17
213 212 212.0 222 2125 19
216 217 217.0 333 2165 20
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
239 238 NULL 555 NULL 24
243 NULL NULL 222 NULL 25
245 248 247.0 444 2476 26

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where b>c
    or a>b
    or (a>b-2 and a<b+2)
order by col4,col6,col5,col3,col2,col1;

----
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
213 212 212.0 222 2125 19
243 NULL NULL 222 NULL 25
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
163 164 162.0 333 1622 10
182 183 182.0 333 1828 14
216 217 217.0 333 2165 20
131 133 132.0 444 1325 4
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
245 248 247.0 444 2476 26
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
168 NULL NULL 555 NULL 11
174 171 172.0 555 1714 12
179 NULL NULL 555 NULL 13
199 196 197.0 555 1964 17
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
239 238 NULL 555 NULL 24

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where (a>b-2 and a<b+2)
    or a>b
    or b>c
order by col6,col4,col5,col2,col3,col1;

----
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
131 133 132.0 444 1325 4
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
163 164 162.0 333 1622 10
168 NULL NULL 555 NULL 11
174 171 172.0 555 1714 12
179 NULL NULL 555 NULL 13
182 183 182.0 333 1828 14
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
199 196 197.0 555 1964 17
213 212 212.0 222 2125 19
216 217 217.0 333 2165 20
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
239 238 NULL 555 NULL 24
243 NULL NULL 222 NULL 25
245 248 247.0 444 2476 26

statement query IIFIII
select abs(a) as col1,
       d as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       a+b*2+c*3+d*4 as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where (a>b-2 and a<b+2)
    or a>b
    or b>c
order by col5,col1,col2,col6,col3,col4;

----
107 108 107.0 333 1067 0
121 122 NULL 333 1226 2
127 128 127.0 333 1272 3
131 133 132.0 444 1325 4
138 136 137.0 111 1371 5
142 140 142.0 111 1411 6
163 164 162.0 333 1622 10
174 171 172.0 555 1714 12
182 183 182.0 333 1828 14
188 185 187.0 444 1861 15
191 190 192.0 444 1918 16
199 196 197.0 555 1964 17
213 212 212.0 222 2125 19
216 217 217.0 333 2165 20
229 226 227.0 555 2264 22
234 233 232.0 555 2323 23
245 248 247.0 444 2476 26
149 NULL NULL 555 NULL 7
153 NULL NULL 555 NULL 8
159 NULL NULL 555 NULL 9
168 NULL NULL 555 NULL 11
179 NULL NULL 555 NULL 13
239 238 NULL 555 NULL 24
243 NULL NULL 222 NULL 25

statement query II
select abs(a) as col1,
       a+b*2+c*3 as col2
from t1
where d>e
order by col2,col1;

----
127 760
131 793
138 827
163 966
182 1096
213 1277
220 1338
234 1391
245 1484
239 NULL
NULL NULL

statement query II
select abs(a) as col1,
       a+b*2+c*3 as col2
from t1
where d>e
order by col1,col2;

----
127 760
131 793
138 827
163 966
182 1096
213 1277
220 1338
234 1391
239 NULL
245 1484
NULL NULL

statement query IIIIII
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a-b as col3,
       a as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where b>c
order by col6,col4,col5,col2,col3,col1;

----
738 333 -3 121 1 0
760 333 -2 127 4 0
827 111 -1 138 2 0
851 111 -1 142 2 0
905 555 2 153 1 0
940 555 1 159 3 0
1000 555 1 168 1 0
1158 444 -3 191 1 0
1180 555 1 199 3 0
1297 333 -2 216 3 0
1360 555 1 229 3 0
1391 555 2 234 1 0
1484 444 -4 245 2 0

statement query IIIIII
select a+b*2+c*3 as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a-b as col3,
       a as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where b>c
order by col1,col6,col4,col5,col2,col3;

----
738 333 -3 121 1 0
760 333 -2 127 4 0
827 111 -1 138 2 0
851 111 -1 142 2 0
905 555 2 153 1 0
940 555 1 159 3 0
1000 555 1 168 1 0
1158 444 -3 191 1 0
1180 555 1 199 3 0
1297 333 -2 216 3 0
1360 555 1 229 3 0
1391 555 2 234 1 0
1484 444 -4 245 2 0

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (e>a and e<b)
   and e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (e>a and e<b)
   and e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col2,col5,col4,col3,col1;

----

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (a>b-2 and a<b+2)
   and (e>a and e<b)
   and e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1;

----

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (a>b-2 and a<b+2)
   and (e>a and e<b)
   and e+d between a+b-10 and c+130
order by col4,col1,col2,col5,col3;

----

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
   and (e>a and e<b)
order by col4,col5,col2,col3,col1;

----

statement query skipped
elect b as col1,
       b-c as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       a+b*2+c*3+d*4 as col5
from t1
where e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
   and (e>a and e<b)
order by col4,col1,col3,col5,col2;

----

statement query IIIIII
select a+b*2 as col1,
       abs(b-c) as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       e as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where b>c
    or d not between 110 and 150
order by col6,col4,col5,col2,col3,col1;

----
317 1 107 1067 1050 109
385 4 127 1272 1290 126
416 2 138 1371 1390 135
428 2 142 1411 1430 144
475 3 159 NULL 1580 157
483 1 163 1622 1600 162
502 1 168 NULL 1670 165
514 2 174 1714 1700 173
544 3 182 1828 364 180
560 1 188 1861 376 189
579 1 191 1918 382 192
595 3 199 1964 398 197
NULL NULL 201 NULL 402 204
635 3 213 2125 426 210
652 3 216 2165 432 219
666 1 220 2226 440 221
685 3 229 2264 458 227
698 1 234 2323 468 230
711 NULL 239 NULL 2360 237
743 2 245 2476 490 246
369 1 121 1226 1240 NULL
455 1 153 NULL 1510 NULL
NULL 2 NULL NULL NULL NULL
NULL NULL 104 NULL NULL NULL

statement query IIIIII
select a+b*2 as col1,
       abs(b-c) as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4 as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       e as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where b>c
    or d not between 110 and 150
order by col2,col4,col3,col6,col5,col1;

----
317 1 107 1067 1050 109
369 1 121 1226 1240 NULL
483 1 163 1622 1600 162
560 1 188 1861 376 189
579 1 191 1918 382 192
666 1 220 2226 440 221
698 1 234 2323 468 230
455 1 153 NULL 1510 NULL
502 1 168 NULL 1670 165
416 2 138 1371 1390 135
428 2 142 1411 1430 144
514 2 174 1714 1700 173
743 2 245 2476 490 246
NULL 2 NULL NULL NULL NULL
544 3 182 1828 364 180
595 3 199 1964 398 197
635 3 213 2125 426 210
652 3 216 2165 432 219
685 3 229 2264 458 227
475 3 159 NULL 1580 157
385 4 127 1272 1290 126
NULL NULL 104 NULL NULL NULL
NULL NULL 201 NULL 402 204
711 NULL 239 NULL 2360 237

statement query IIIFII
select d-e as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (a+b+c+d+e)/5 as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3+d*4 as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
-1 107 333 107.0 0 1067
NULL 121 333 NULL 2 1226
2 127 333 127.0 3 1272
1 131 444 132.0 4 1325
1 138 111 137.0 5 1371
-4 142 111 142.0 6 1411
2 163 333 162.0 10 1622
-2 174 555 172.0 12 1714
3 182 333 182.0 14 1828
-4 188 444 187.0 15 1861
-2 191 444 192.0 16 1918
-1 199 555 197.0 17 1964
2 213 222 212.0 19 2125
-2 216 333 217.0 20 2165
1 220 444 222.0 21 2226
-1 229 555 227.0 22 2264
3 234 555 232.0 23 2323
2 245 444 247.0 26 2476
NULL 104 555 NULL 0 NULL
-1 115 333 NULL 0 NULL
-1 201 222 NULL 0 NULL
4 NULL 555 NULL 1 NULL
NULL 149 555 NULL 7 NULL
NULL 153 555 NULL 8 NULL
NULL 159 555 NULL 9 NULL
NULL 168 555 NULL 11 NULL
NULL 179 555 NULL 13 NULL
NULL NULL 555 NULL 18 NULL
1 239 555 NULL 24 NULL
NULL 243 222 NULL 25 NULL

statement query IIIFII
select d-e as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       (a+b+c+d+e)/5 as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       a+b*2+c*3+d*4 as col6
from t1
order by col3,col4,col1,col6,col5,col2;

----
1 138 111 137.0 5 1371
-4 142 111 142.0 6 1411
2 213 222 212.0 19 2125
-1 201 222 NULL 0 NULL
NULL 243 222 NULL 25 NULL
-1 107 333 107.0 0 1067
2 127 333 127.0 3 1272
2 163 333 162.0 10 1622
3 182 333 182.0 14 1828
-2 216 333 217.0 20 2165
-1 115 333 NULL 0 NULL
NULL 121 333 NULL 2 1226
1 131 444 132.0 4 1325
-4 188 444 187.0 15 1861
-2 191 444 192.0 16 1918
1 220 444 222.0 21 2226
2 245 444 247.0 26 2476
-2 174 555 172.0 12 1714
-1 199 555 197.0 17 1964
-1 229 555 227.0 22 2264
3 234 555 232.0 23 2323
1 239 555 NULL 24 NULL
4 NULL 555 NULL 1 NULL
NULL 104 555 NULL 0 NULL
NULL 149 555 NULL 7 NULL
NULL 153 555 NULL 8 NULL
NULL 159 555 NULL 9 NULL
NULL 168 555 NULL 11 NULL
NULL 179 555 NULL 13 NULL
NULL NULL 555 NULL 18 NULL

statement query TI
select b as col1,
       c as col2
from t1
order by col2,col1;

----
NULL 102
105 106
112 113
NULL 119
124 123
129 125
130 134
139 137
143 141
145 147
151 150
158 155
160 161
167 166
170 172
175 176
181 184
186 187
194 193
198 195
NULL 202
206 208
211 214
218 215
223 224
228 225
232 231
240 244
249 247
236 NULL

statement query II
select b as col1,
       c as col2
from t1
order by col1,col2;

----
105 106
112 113
124 123
129 125
130 134
139 137
143 141
145 147
151 150
158 155
160 161
167 166
170 172
175 176
181 184
186 187
194 193
198 195
206 208
211 214
218 215
223 224
228 225
232 231
236 NULL
240 244
249 247
NULL 102
NULL 119
NULL 202

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where c between b-2 and d+2
   and d>e
   and (a>b-2 and a<b+2)
order by col2,col1;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where c between b-2 and d+2
   and d>e
   and (a>b-2 and a<b+2)
order by col1,col2;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where c between b-2 and d+2
   and (a>b-2 and a<b+2)
   and d>e
order by col2,col1;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where c between b-2 and d+2
   and (a>b-2 and a<b+2)
   and d>e
order by col2,col1;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col2,col1;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where d>e
   and (a>b-2 and a<b+2)
   and c between b-2 and d+2
order by col1,col2;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where (a>b-2 and a<b+2)
   and d>e
   and c between b-2 and d+2
order by col2,col1;

----
793 0
827 0
1096 0

statement query II
select a+b*2+c*3 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where (a>b-2 and a<b+2)
   and d>e
   and c between b-2 and d+2
order by col1,col2;

----
793 0
827 0
1096 0

statement query IIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where (e>c or e<d)
    or b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1;

----
444 101 NULL
333 108 1612
444 114 NULL
222 122 NULL
222 128 1902
333 133 1985
222 136 2046
222 140 2131
444 164 2432
444 171 2579
333 183 2728
333 185 2806
222 190 2878
333 196 2949
444 203 NULL
444 207 NULL
333 212 3175
222 217 3260
222 222 3331
333 226 3399
333 233 3473
444 238 NULL
111 248 3706
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where (e>c or e<d)
    or b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2,col3;

----
111 248 3706
222 122 NULL
222 128 1902
222 136 2046
222 140 2131
222 190 2878
222 217 3260
222 222 3331
333 108 1612
333 133 1985
333 183 2728
333 185 2806
333 196 2949
333 212 3175
333 226 3399
333 233 3473
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 101 NULL
444 114 NULL
444 164 2432
444 171 2579
444 203 NULL
444 207 NULL
444 238 NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query IIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
order by col2,col3,col1;

----
444 101 NULL
333 108 1612
444 114 NULL
222 122 NULL
222 128 1902
333 133 1985
222 136 2046
222 140 2131
444 164 2432
444 171 2579
333 183 2728
333 185 2806
222 190 2878
333 196 2949
444 203 NULL
444 207 NULL
333 212 3175
222 217 3260
222 222 3331
333 226 3399
333 233 3473
444 238 NULL
111 248 3706
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where b>c
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (e>c or e<d)
order by col1,col3,col2;

----
111 248 3706
222 128 1902
222 136 2046
222 140 2131
222 190 2878
222 217 3260
222 222 3331
222 122 NULL
333 108 1612
333 133 1985
333 183 2728
333 185 2806
333 196 2949
333 212 3175
333 226 3399
333 233 3473
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 164 2432
444 171 2579
444 101 NULL
444 114 NULL
444 203 NULL
444 207 NULL
444 238 NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query IIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
    or (e>c or e<d)
order by col2,col3,col1;

----
444 101 NULL
333 108 1612
444 114 NULL
222 122 NULL
222 128 1902
333 133 1985
222 136 2046
222 140 2131
444 164 2432
444 171 2579
333 183 2728
333 185 2806
222 190 2878
333 196 2949
444 203 NULL
444 207 NULL
333 212 3175
222 217 3260
222 222 3331
333 226 3399
333 233 3473
444 238 NULL
111 248 3706
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query IIT
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or b>c
    or (e>c or e<d)
order by col2,col1,col3;

----
444 101 NULL
333 108 1612
444 114 NULL
222 122 NULL
222 128 1902
333 133 1985
222 136 2046
222 140 2131
444 164 2432
444 171 2579
333 183 2728
333 185 2806
222 190 2878
333 196 2949
444 203 NULL
444 207 NULL
333 212 3175
222 217 3260
222 222 3331
333 226 3399
333 233 3473
444 238 NULL
111 248 3706
333 NULL NULL
333 NULL NULL
333 NULL NULL
444 NULL NULL
444 NULL NULL
444 NULL NULL

statement query IIII
select c-d as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4
from t1
order by col4,col2,col3,col1;

----
-2 -1 108 635
1 NULL 122 738
-3 2 128 760
1 1 133 793
1 1 136 827
1 -4 140 851
NULL NULL NULL 880
NULL NULL NULL 905
NULL NULL NULL 940
-3 2 164 966
NULL NULL NULL 1000
1 -2 171 1030
NULL NULL NULL 1057
1 3 183 1096
2 -4 185 1121
3 -2 190 1158
-1 -1 196 1180
2 2 212 1277
-2 -2 217 1297
2 1 222 1338
-1 -1 226 1360
-2 3 233 1391
NULL NULL NULL 1455
-1 2 248 1484
3 -1 116 NULL
-1 -1 203 NULL
NULL 1 238 NULL
-1 4 114 NULL
1 NULL 101 NULL
1 NULL 207 NULL

statement query IIII
select c-d as col1,
       d-e as col2,
       d as col3,
       a+b*2+c*3 as col4
from t1
order by col2,col1,col3,col4;

----
1 -4 140 851
2 -4 185 1121
-2 -2 217 1297
1 -2 171 1030
3 -2 190 1158
-2 -1 108 635
-1 -1 196 1180
-1 -1 203 NULL
-1 -1 226 1360
3 -1 116 NULL
1 1 133 793
1 1 136 827
2 1 222 1338
NULL 1 238 NULL
-3 2 128 760
-3 2 164 966
-1 2 248 1484
2 2 212 1277
-2 3 233 1391
1 3 183 1096
-1 4 114 NULL
1 NULL 101 NULL
1 NULL 122 738
1 NULL 207 NULL
NULL NULL NULL 880
NULL NULL NULL 905
NULL NULL NULL 940
NULL NULL NULL 1000
NULL NULL NULL 1057
NULL NULL NULL 1455

statement query I
select abs(b-c) as col1
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col1;

----
1
1
1
1
1
3

statement query I
select abs(b-c) as col1
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col1;

----
1
1
1
1
1
3

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       c as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1
where d>e
    or (e>a and e<b)
    or (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
333 1067 106 1612
333 1272 125 1902
444 1325 134 1985
111 1371 137 2046
333 1622 161 2432
333 1828 184 2728
444 1861 187 2806
444 1918 193 2878
222 2125 214 3175
333 2165 215 3260
444 2226 224 3331
555 2323 231 3473
444 2476 247 3706
555 NULL 113 NULL
333 NULL 119 NULL
555 NULL NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       c as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1
where d>e
    or (e>a and e<b)
    or (c<=d-2 or c>=d+2)
order by col2,col4,col3,col1;

----
333 1067 106 1612
333 1272 125 1902
444 1325 134 1985
111 1371 137 2046
333 1622 161 2432
333 1828 184 2728
444 1861 187 2806
444 1918 193 2878
222 2125 214 3175
333 2165 215 3260
444 2226 224 3331
555 2323 231 3473
444 2476 247 3706
555 NULL 113 NULL
333 NULL 119 NULL
555 NULL NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       c as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1
where (c<=d-2 or c>=d+2)
    or d>e
    or (e>a and e<b)
order by col4,col2,col3,col1;

----
333 1067 106 1612
333 1272 125 1902
444 1325 134 1985
111 1371 137 2046
333 1622 161 2432
333 1828 184 2728
444 1861 187 2806
444 1918 193 2878
222 2125 214 3175
333 2165 215 3260
444 2226 224 3331
555 2323 231 3473
444 2476 247 3706
555 NULL 113 NULL
333 NULL 119 NULL
555 NULL NULL NULL

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       c as col3,
       a+b*2+c*3+d*4+e*5 as col4
from t1
where (c<=d-2 or c>=d+2)
    or d>e
    or (e>a and e<b)
order by col3,col4,col1,col2;

----
333 1067 106 1612
555 NULL 113 NULL
333 NULL 119 NULL
333 1272 125 1902
444 1325 134 1985
111 1371 137 2046
333 1622 161 2432
333 1828 184 2728
444 1861 187 2806
444 1918 193 2878
222 2125 214 3175
333 2165 215 3260
444 2226 224 3331
555 2323 231 3473
444 2476 247 3706
555 NULL NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where d>e
    or (a>b-2 and a<b+2)
    or c>d
order by col4,col2,col3,col1;

----
2131 222 -1 -4
2806 333 2 -4
2878 222 -3 -2
2579 444 4 -2
2949 333 1 -1
3399 333 1 -1
NULL 444 NULL -1
3331 222 -3 1
2046 222 -1 1
1985 333 1 1
NULL 444 3 1
3706 111 -4 2
1902 222 -2 2
3175 333 2 2
2432 444 3 2
2728 333 1 3
3473 333 2 3
NULL 444 NULL 4
NULL 222 -3 NULL
NULL 333 1 NULL
NULL 333 1 NULL
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where d>e
    or (a>b-2 and a<b+2)
    or c>d
order by col2,col3,col4,col1;

----
3706 111 -4 2
2878 222 -3 -2
3331 222 -3 1
NULL 222 -3 NULL
1902 222 -2 2
2131 222 -1 -4
2046 222 -1 1
2949 333 1 -1
3399 333 1 -1
1985 333 1 1
2728 333 1 3
NULL 333 1 NULL
NULL 333 1 NULL
2806 333 2 -4
3175 333 2 2
3473 333 2 3
NULL 444 3 1
2432 444 3 2
2579 444 4 -2
NULL 444 NULL -1
NULL 444 NULL 4
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where (a>b-2 and a<b+2)
    or c>d
    or d>e
order by col4,col2,col3,col1;

----
2131 222 -1 -4
2806 333 2 -4
2878 222 -3 -2
2579 444 4 -2
2949 333 1 -1
3399 333 1 -1
NULL 444 NULL -1
3331 222 -3 1
2046 222 -1 1
1985 333 1 1
NULL 444 3 1
3706 111 -4 2
1902 222 -2 2
3175 333 2 2
2432 444 3 2
2728 333 1 3
3473 333 2 3
NULL 444 NULL 4
NULL 222 -3 NULL
NULL 333 1 NULL
NULL 333 1 NULL
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where (a>b-2 and a<b+2)
    or c>d
    or d>e
order by col1,col2,col4,col3;

----
1902 222 -2 2
1985 333 1 1
2046 222 -1 1
2131 222 -1 -4
2432 444 3 2
2579 444 4 -2
2728 333 1 3
2806 333 2 -4
2878 222 -3 -2
2949 333 1 -1
3175 333 2 2
3331 222 -3 1
3399 333 1 -1
3473 333 2 3
3706 111 -4 2
NULL 222 -3 NULL
NULL 333 1 NULL
NULL 333 1 NULL
NULL 444 NULL -1
NULL 444 3 1
NULL 444 NULL 4
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where d>e
    or c>d
    or (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
2131 222 -1 -4
2806 333 2 -4
2878 222 -3 -2
2579 444 4 -2
2949 333 1 -1
3399 333 1 -1
NULL 444 NULL -1
3331 222 -3 1
2046 222 -1 1
1985 333 1 1
NULL 444 3 1
3706 111 -4 2
1902 222 -2 2
3175 333 2 2
2432 444 3 2
2728 333 1 3
3473 333 2 3
NULL 444 NULL 4
NULL 222 -3 NULL
NULL 333 1 NULL
NULL 333 1 NULL
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a-b as col3,
       d-e as col4
from t1
where d>e
    or c>d
    or (a>b-2 and a<b+2)
order by col2,col4,col1,col3;

----
3706 111 -4 2
2131 222 -1 -4
2878 222 -3 -2
2046 222 -1 1
3331 222 -3 1
1902 222 -2 2
NULL 222 -3 NULL
2806 333 2 -4
2949 333 1 -1
3399 333 1 -1
1985 333 1 1
3175 333 2 2
2728 333 1 3
3473 333 2 3
NULL 333 1 NULL
NULL 333 1 NULL
2579 444 4 -2
NULL 444 NULL -1
NULL 444 3 1
2432 444 3 2
NULL 444 NULL 4
NULL 444 NULL NULL
NULL 444 NULL NULL

statement query skipped
elect abs(a) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
where e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----

statement query skipped
elect abs(a) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
where e+d between a+b-10 and c+130
   and (a>b-2 and a<b+2)
order by col4,col3,col2,col1;

----

statement query skipped
elect abs(a) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
where (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect abs(a) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4
from t1
where (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col4,col1,col2,col3;

----

statement query I
select a+b*2+c*3+d*4 as col1
from t1
where (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col1;

----
1067
1272

statement query I
select a+b*2+c*3+d*4 as col1
from t1
where (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col1;

----
1067
1272

statement query I
select a+b*2+c*3+d*4 as col1
from t1
where e+d between a+b-10 and c+130
   and (e>c or e<d)
order by col1;

----
1067
1272

statement query I
select a+b*2+c*3+d*4 as col1
from t1
where e+d between a+b-10 and c+130
   and (e>c or e<d)
order by col1;

----
1067
1272

statement query I
select b-c as col1
from t1
where c>d
order by col1;

----
-4
-3
-3
-2
-2
-1
-1
1
1
2
2
NULL
NULL

statement query I
select b-c as col1
from t1
where c>d
order by col1;

----
-4
-3
-3
-2
-2
-1
-1
1
1
2
2
NULL
NULL

statement query II
select a+b*2+c*3+d*4 as col1,
       c as col2
from t1
where b>c
order by col2,col1;

----
1226 123
1272 125
1371 137
1411 141
NULL 150
NULL 155
NULL 166
1918 193
1964 195
2165 215
2264 225
2323 231
2476 247

statement query II
select a+b*2+c*3+d*4 as col1,
       c as col2
from t1
where b>c
order by col1,col2;

----
1226 123
1272 125
1371 137
1411 141
1918 193
1964 195
2165 215
2264 225
2323 231
2476 247
NULL 150
NULL 155
NULL 166

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       d as col4,
       d-e as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       abs(b-c) as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
1067 -2 635 108 -1 0 1
NULL 1 NULL 101 NULL 0 NULL
NULL 3 NULL 116 -1 0 NULL
NULL -1 NULL 203 -1 0 NULL
NULL -1 NULL 114 4 1 1
1226 1 738 122 NULL 2 1
1272 -3 760 128 2 3 4
1325 1 793 133 1 4 4
1371 1 827 136 1 5 2
1411 1 851 140 -4 6 2
NULL NULL 880 NULL NULL 7 2
NULL NULL 905 NULL NULL 8 1
NULL NULL 940 NULL NULL 9 3
1622 -3 966 164 2 10 1
NULL NULL 1000 NULL NULL 11 1
1714 1 1030 171 -2 12 2
NULL NULL 1057 NULL NULL 13 1
1828 1 1096 183 3 14 3
1861 2 1121 185 -4 15 1
1918 3 1158 190 -2 16 1
1964 -1 1180 196 -1 17 3
NULL 1 NULL 207 NULL 18 2
2125 2 1277 212 2 19 3
2165 -2 1297 217 -2 20 3
2226 2 1338 222 1 21 1
2264 -1 1360 226 -1 22 3
2323 -2 1391 233 3 23 1
NULL NULL NULL 238 1 24 NULL
NULL NULL 1455 NULL NULL 25 4
2476 -1 1484 248 2 26 2

statement query IIIIIII
select a+b*2+c*3+d*4 as col1,
       c-d as col2,
       a+b*2+c*3 as col3,
       d as col4,
       d-e as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       abs(b-c) as col7
from t1
order by col5,col4,col7,col6,col1,col2,col3;

----
1411 1 851 140 -4 6 2
1861 2 1121 185 -4 15 1
1714 1 1030 171 -2 12 2
1918 3 1158 190 -2 16 1
2165 -2 1297 217 -2 20 3
1067 -2 635 108 -1 0 1
NULL 3 NULL 116 -1 0 NULL
1964 -1 1180 196 -1 17 3
NULL -1 NULL 203 -1 0 NULL
2264 -1 1360 226 -1 22 3
1325 1 793 133 1 4 4
1371 1 827 136 1 5 2
2226 2 1338 222 1 21 1
NULL NULL NULL 238 1 24 NULL
1272 -3 760 128 2 3 4
1622 -3 966 164 2 10 1
2125 2 1277 212 2 19 3
2476 -1 1484 248 2 26 2
1828 1 1096 183 3 14 3
2323 -2 1391 233 3 23 1
NULL -1 NULL 114 4 1 1
NULL 1 NULL 101 NULL 0 NULL
1226 1 738 122 NULL 2 1
NULL 1 NULL 207 NULL 18 2
NULL NULL 905 NULL NULL 8 1
NULL NULL 1000 NULL NULL 11 1
NULL NULL 1057 NULL NULL 13 1
NULL NULL 880 NULL NULL 7 2
NULL NULL 940 NULL NULL 9 3
NULL NULL 1455 NULL NULL 25 4

statement query TIII
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d>e
    or b>c
order by col4,col2,col3,col1;

----
NULL 0 -3 1226
1902 0 -2 1272
1985 0 1 1325
2046 0 -1 1371
2131 0 -1 1411
2432 0 3 1622
2728 0 1 1828
2878 0 -3 1918
2949 0 1 1964
3175 0 2 2125
3260 0 -2 2165
3331 0 -3 2226
3399 0 1 2264
3473 0 2 2323
3706 0 -4 2476
NULL 0 1 NULL
NULL 0 1 NULL
NULL 0 2 NULL
NULL 0 3 NULL
NULL 0 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d>e
    or b>c
order by col3,col2,col4,col1;

----
3706 0 -4 2476
NULL 0 -3 1226
2878 0 -3 1918
3331 0 -3 2226
1902 0 -2 1272
3260 0 -2 2165
2046 0 -1 1371
2131 0 -1 1411
1985 0 1 1325
2728 0 1 1828
2949 0 1 1964
3399 0 1 2264
NULL 0 1 NULL
NULL 0 1 NULL
3175 0 2 2125
3473 0 2 2323
NULL 0 2 NULL
2432 0 3 1622
NULL 0 3 NULL
NULL 0 NULL NULL

statement query TIII
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
    or d>e
order by col4,col2,col3,col1;

----
NULL 0 -3 1226
1902 0 -2 1272
1985 0 1 1325
2046 0 -1 1371
2131 0 -1 1411
2432 0 3 1622
2728 0 1 1828
2878 0 -3 1918
2949 0 1 1964
3175 0 2 2125
3260 0 -2 2165
3331 0 -3 2226
3399 0 1 2264
3473 0 2 2323
3706 0 -4 2476
NULL 0 1 NULL
NULL 0 1 NULL
NULL 0 2 NULL
NULL 0 3 NULL
NULL 0 NULL NULL

statement query IIII
select a+b*2+c*3+d*4+e*5 as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a-b as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
    or d>e
order by col1,col4,col2,col3;

----
1902 0 -2 1272
1985 0 1 1325
2046 0 -1 1371
2131 0 -1 1411
2432 0 3 1622
2728 0 1 1828
2878 0 -3 1918
2949 0 1 1964
3175 0 2 2125
3260 0 -2 2165
3331 0 -3 2226
3399 0 1 2264
3473 0 2 2323
3706 0 -4 2476
NULL 0 -3 1226
NULL 0 1 NULL
NULL 0 1 NULL
NULL 0 2 NULL
NULL 0 3 NULL
NULL 0 NULL NULL

statement query II
select a+b*2+c*3 as col1,
       c-d as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
order by col2,col1;

----
760 -3
1297 -2
1391 -2
1180 -1
1360 -1
1484 -1
738 1
827 1
851 1
1158 3
905 NULL
940 NULL
1000 NULL

statement query II
select a+b*2+c*3 as col1,
       c-d as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
order by col2,col1;

----
760 -3
1297 -2
1391 -2
1180 -1
1360 -1
1484 -1
738 1
827 1
851 1
1158 3
905 NULL
940 NULL
1000 NULL

statement query II
select a+b*2+c*3 as col1,
       c-d as col2
from t1
where b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
760 -3
1297 -2
1391 -2
1180 -1
1360 -1
1484 -1
738 1
827 1
851 1
1158 3
905 NULL
940 NULL
1000 NULL

statement query II
select a+b*2+c*3 as col1,
       c-d as col2
from t1
where b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
738 1
760 -3
827 1
851 1
905 NULL
940 NULL
1000 NULL
1158 3
1180 -1
1297 -2
1360 -1
1391 -2
1484 -1

statement query ITTTTI
select c as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       abs(b-c) as col4,
       (a+b+c+d+e)/5 as col5,
       abs(a) as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
102 NULL NULL NULL NULL 104
106 1067 105 1 107.0 107
119 NULL NULL NULL NULL 115
123 1226 124 1 NULL 121
125 1272 129 4 127.0 127
134 1325 130 4 132.0 131
137 1371 139 2 137.0 138
141 1411 143 2 142.0 142
147 NULL 145 2 NULL 149
150 NULL 151 1 NULL 153
155 NULL 158 3 NULL 159
161 1622 160 1 162.0 163
166 NULL 167 1 NULL 168
172 1714 170 2 172.0 174
176 NULL 175 1 NULL 179
184 1828 181 3 182.0 182
187 1861 186 1 187.0 188
193 1918 194 1 192.0 191
195 1964 198 3 197.0 199
202 NULL NULL NULL NULL 201
214 2125 211 3 212.0 213
215 2165 218 3 217.0 216
224 2226 223 1 222.0 220
225 2264 228 3 227.0 229
231 2323 232 1 232.0 234
NULL NULL 236 NULL NULL 239
244 NULL 240 4 NULL 243
247 2476 249 2 247.0 245
113 NULL 112 1 NULL NULL
208 NULL 206 2 NULL NULL

statement query IIIIFI
select c as col1,
       a+b*2+c*3+d*4 as col2,
       b as col3,
       abs(b-c) as col4,
       (a+b+c+d+e)/5 as col5,
       abs(a) as col6
from t1
order by col3,col4,col5,col6,col2,col1;

----
106 1067 105 1 107.0 107
113 NULL 112 1 NULL NULL
123 1226 124 1 NULL 121
125 1272 129 4 127.0 127
134 1325 130 4 132.0 131
137 1371 139 2 137.0 138
141 1411 143 2 142.0 142
147 NULL 145 2 NULL 149
150 NULL 151 1 NULL 153
155 NULL 158 3 NULL 159
161 1622 160 1 162.0 163
166 NULL 167 1 NULL 168
172 1714 170 2 172.0 174
176 NULL 175 1 NULL 179
184 1828 181 3 182.0 182
187 1861 186 1 187.0 188
193 1918 194 1 192.0 191
195 1964 198 3 197.0 199
208 NULL 206 2 NULL NULL
214 2125 211 3 212.0 213
215 2165 218 3 217.0 216
224 2226 223 1 222.0 220
225 2264 228 3 227.0 229
231 2323 232 1 232.0 234
NULL NULL 236 NULL NULL 239
244 NULL 240 4 NULL 243
247 2476 249 2 247.0 245
102 NULL NULL NULL NULL 104
119 NULL NULL NULL NULL 115
202 NULL NULL NULL NULL 201

statement query II
select a as col1,
       c-d as col2
from t1
order by col2,col1;

----
127 -3
163 -3
107 -2
216 -2
234 -2
199 -1
201 -1
229 -1
245 -1
NULL -1
104 1
121 1
131 1
138 1
142 1
174 1
182 1
NULL 1
188 2
213 2
220 2
115 3
191 3
149 NULL
153 NULL
159 NULL
168 NULL
179 NULL
239 NULL
243 NULL

statement query II
select a as col1,
       c-d as col2
from t1
order by col2,col1;

----
127 -3
163 -3
107 -2
216 -2
234 -2
199 -1
201 -1
229 -1
245 -1
NULL -1
104 1
121 1
131 1
138 1
142 1
174 1
182 1
NULL 1
188 2
213 2
220 2
115 3
191 3
149 NULL
153 NULL
159 NULL
168 NULL
179 NULL
239 NULL
243 NULL

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
    or d>e
order by col6,col4,col5,col2,col3,col1;

----
1 1050 107 1612 105 0
4 1290 127 1902 129 0
4 1300 131 1985 130 0
2 1390 138 2046 139 0
1 1600 163 2432 160 0
3 364 182 2728 181 0
1 382 191 2878 194 0
3 426 213 3175 211 0
1 440 220 3331 223 0
1 468 234 3473 232 0
2 490 245 3706 249 0
1 1120 NULL NULL 112 0
NULL 2360 239 NULL 236 0

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where (e>a and e<b)
    or e+d between a+b-10 and c+130
    or d>e
order by col3,col4,col6,col5,col2,col1;

----
1 1050 107 1612 105 0
4 1290 127 1902 129 0
4 1300 131 1985 130 0
2 1390 138 2046 139 0
1 1600 163 2432 160 0
3 364 182 2728 181 0
1 382 191 2878 194 0
3 426 213 3175 211 0
1 440 220 3331 223 0
1 468 234 3473 232 0
NULL 2360 239 NULL 236 0
2 490 245 3706 249 0
1 1120 NULL NULL 112 0

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
    or (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----
1 1050 107 1612 105 0
4 1290 127 1902 129 0
4 1300 131 1985 130 0
2 1390 138 2046 139 0
1 1600 163 2432 160 0
3 364 182 2728 181 0
1 382 191 2878 194 0
3 426 213 3175 211 0
1 440 220 3331 223 0
1 468 234 3473 232 0
2 490 245 3706 249 0
1 1120 NULL NULL 112 0
NULL 2360 239 NULL 236 0

statement query IIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       abs(a) as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
where e+d between a+b-10 and c+130
    or d>e
    or (e>a and e<b)
order by col1,col6,col5,col4,col2,col3;

----
1 1050 107 1612 105 0
1 1120 NULL NULL 112 0
1 1600 163 2432 160 0
1 382 191 2878 194 0
1 440 220 3331 223 0
1 468 234 3473 232 0
2 1390 138 2046 139 0
2 490 245 3706 249 0
3 364 182 2728 181 0
3 426 213 3175 211 0
4 1290 127 1902 129 0
4 1300 131 1985 130 0
NULL 2360 239 NULL 236 0

