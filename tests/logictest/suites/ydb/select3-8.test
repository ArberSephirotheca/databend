statement ok
drop table if exists t1 all;

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null);

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104);

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105);

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113);

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null);

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121);

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125);

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130);

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137);

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143);

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147);

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null);

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158);

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162);

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166);

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174);

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175);

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184);

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185);

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191);

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195);

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204);

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207);

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211);

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219);

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224);

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225);

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233);

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238);

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null);

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245);

statement query IIIFII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a-b as col2,
       b-c as col3,
       (a+b+c+d+e)/5 as col4,
       a+b*2 as col5,
       case when c>avg_c then a*2 else b*10 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
   and d>e
   and c between b-2 and d+2
order by col4,col3,col6,col5,col2,col1;

----
222 -3 -1 222.0 666 440
111 -4 2 247.0 743 490

statement query IIIFII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a-b as col2,
       b-c as col3,
       (a+b+c+d+e)/5 as col4,
       a+b*2 as col5,
       case when c>avg_c then a*2 else b*10 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and (e>a and e<b)
   and d>e
order by col6,col4,col5,col2,col3,col1;

----
222 -3 -1 222.0 666 440
111 -4 2 247.0 743 490

statement query IIIFII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a-b as col2,
       b-c as col3,
       (a+b+c+d+e)/5 as col4,
       a+b*2 as col5,
       case when c>avg_c then a*2 else b*10 end as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
   and (e>a and e<b)
   and d>e
order by col5,col2,col3,col6,col4,col1;

----
222 -3 -1 222.0 666 440
111 -4 2 247.0 743 490

statement query I
select a-b as col1
from t1
where c between b-2 and d+2
order by col1;

----
-4
-3
-3
-1
-1
1
1
2
2
2
2
3
4
NULL
NULL

statement query I
select a-b as col1
from t1
where c between b-2 and d+2
order by col1;

----
-4
-3
-3
-1
-1
1
1
2
2
2
2
3
4
NULL
NULL

statement query IFIIIII
select a-b as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       abs(b-c) as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       a+b*2 as col6,
       b as col7
from t1
where (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
1 132.0 444 4 0 391 130
-1 137.0 111 2 0 416 139
-1 142.0 111 2 0 428 143
1 NULL 555 3 0 475 158
1 NULL 555 1 0 502 167
1 182.0 333 3 0 544 181
1 197.0 555 3 0 595 198
1 227.0 555 3 0 685 228

statement query ITIIIII
select a-b as col1,
       (a+b+c+d+e)/5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       abs(b-c) as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       a+b*2 as col6,
       b as col7
from t1
where (a>b-2 and a<b+2)
order by col4,col3,col6,col1,col7,col5,col2;

----
1 NULL 555 1 0 502 167
-1 137.0 111 2 0 416 139
-1 142.0 111 2 0 428 143
1 182.0 333 3 0 544 181
1 NULL 555 3 0 475 158
1 197.0 555 3 0 595 198
1 227.0 555 3 0 685 228
1 132.0 444 4 0 391 130

statement query FIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       b as col4
from t1
order by col4,col2,col3,col1;

----
107.0 635 106 105
NULL NULL 113 112
NULL 738 123 124
127.0 760 125 129
132.0 793 134 130
137.0 827 137 139
142.0 851 141 143
NULL 880 147 145
NULL 905 150 151
NULL 940 155 158
162.0 966 161 160
NULL 1000 166 167
172.0 1030 172 170
NULL 1057 176 175
182.0 1096 184 181
187.0 1121 187 186
192.0 1158 193 194
197.0 1180 195 198
NULL NULL 208 206
212.0 1277 214 211
217.0 1297 215 218
222.0 1338 224 223
227.0 1360 225 228
232.0 1391 231 232
NULL NULL NULL 236
NULL 1455 244 240
247.0 1484 247 249
NULL NULL 102 NULL
NULL NULL 119 NULL
NULL NULL 202 NULL

statement query TTIT
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3 as col2,
       c as col3,
       b as col4
from t1
order by col3,col2,col4,col1;

----
NULL NULL 102 NULL
107.0 635 106 105
NULL NULL 113 112
NULL NULL 119 NULL
NULL 738 123 124
127.0 760 125 129
132.0 793 134 130
137.0 827 137 139
142.0 851 141 143
NULL 880 147 145
NULL 905 150 151
NULL 940 155 158
162.0 966 161 160
NULL 1000 166 167
172.0 1030 172 170
NULL 1057 176 175
182.0 1096 184 181
187.0 1121 187 186
192.0 1158 193 194
197.0 1180 195 198
NULL NULL 202 NULL
NULL NULL 208 206
212.0 1277 214 211
217.0 1297 215 218
222.0 1338 224 223
227.0 1360 225 228
232.0 1391 231 232
NULL 1455 244 240
247.0 1484 247 249
NULL NULL NULL 236

statement query TIIII
select d-e as col1,
       abs(a) as col2,
       a as col3,
       abs(b-c) as col4,
       a+b*2+c*3 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col4,col5,col2,col3,col1;

----
NULL 121 121 1 738
NULL 153 153 1 905
2 163 163 1 966
NULL 168 168 1 1000
NULL 179 179 1 1057
-4 188 188 1 1121
-2 191 191 1 1158
1 220 220 1 1338
3 234 234 1 1391
4 NULL NULL 1 NULL
1 138 138 2 827
-4 142 142 2 851
NULL 149 149 2 880
-2 174 174 2 1030
2 245 245 2 1484
NULL NULL NULL 2 NULL
NULL 159 159 3 940
3 182 182 3 1096
-1 199 199 3 1180
2 213 213 3 1277
-2 216 216 3 1297
-1 229 229 3 1360
2 127 127 4 760
1 131 131 4 793
NULL 243 243 4 1455
NULL 104 104 NULL NULL
-1 115 115 NULL NULL
1 239 239 NULL NULL

statement query TIIII
select d-e as col1,
       abs(a) as col2,
       a as col3,
       abs(b-c) as col4,
       a+b*2+c*3 as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col5,col2,col4,col3,col1;

----
NULL 121 121 1 738
2 127 127 4 760
1 131 131 4 793
1 138 138 2 827
-4 142 142 2 851
NULL 149 149 2 880
NULL 153 153 1 905
NULL 159 159 3 940
2 163 163 1 966
NULL 168 168 1 1000
-2 174 174 2 1030
NULL 179 179 1 1057
3 182 182 3 1096
-4 188 188 1 1121
-2 191 191 1 1158
-1 199 199 3 1180
2 213 213 3 1277
-2 216 216 3 1297
1 220 220 1 1338
-1 229 229 3 1360
3 234 234 1 1391
NULL 243 243 4 1455
2 245 245 2 1484
NULL 104 104 NULL NULL
-1 115 115 NULL NULL
1 239 239 NULL NULL
4 NULL NULL 1 NULL
NULL NULL NULL 2 NULL

statement query I
select abs(a) as col1
from t1
where d not between 110 and 150
   and (c<=d-2 or c>=d+2)
order by col1;

----
107
163
188
191
213
216
220
234

statement query I
select abs(a) as col1
from t1
where d not between 110 and 150
   and (c<=d-2 or c>=d+2)
order by col1;

----
107
163
188
191
213
216
220
234

statement query I
select abs(a) as col1
from t1
where (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col1;

----
107
163
188
191
213
216
220
234

statement query I
select abs(a) as col1
from t1
where (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col1;

----
107
163
188
191
213
216
220
234

statement query IIIIIIF
select a+b*2+c*3+d*4 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3 as col3,
       a as col4,
       b as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>c or e<d)
order by col6,col7,col4,col5,col2,col3,col1;

----
1371 222 827 138 139 111 137.0
1411 222 851 142 143 111 142.0
2125 333 1277 213 211 222 212.0
NULL 444 NULL 201 NULL 222 NULL
1067 333 635 107 105 333 107.0
1272 222 760 127 129 333 127.0
1622 444 966 163 160 333 162.0
1828 333 1096 182 181 333 182.0
2165 222 1297 216 218 333 217.0
1325 333 793 131 130 444 132.0
1861 333 1121 188 186 444 187.0
2226 222 1338 220 223 444 222.0
2476 111 1484 245 249 444 247.0
1714 444 1030 174 170 555 172.0
1964 333 1180 199 198 555 197.0
2264 333 1360 229 228 555 227.0
2323 333 1391 234 232 555 232.0
NULL 333 940 159 158 555 NULL
NULL 444 1057 179 175 555 NULL
NULL 444 NULL 239 236 555 NULL
NULL 444 NULL NULL 112 555 NULL

statement query IIIIIIF
select a+b*2+c*3+d*4 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3 as col3,
       a as col4,
       b as col5,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col6,
       (a+b+c+d+e)/5 as col7
from t1
where (e>c or e<d)
order by col5,col7,col1,col6,col4,col2,col3;

----
1067 333 635 107 105 333 107.0
NULL 444 NULL NULL 112 555 NULL
1272 222 760 127 129 333 127.0
1325 333 793 131 130 444 132.0
1371 222 827 138 139 111 137.0
1411 222 851 142 143 111 142.0
NULL 333 940 159 158 555 NULL
1622 444 966 163 160 333 162.0
1714 444 1030 174 170 555 172.0
NULL 444 1057 179 175 555 NULL
1828 333 1096 182 181 333 182.0
1861 333 1121 188 186 444 187.0
1964 333 1180 199 198 555 197.0
2125 333 1277 213 211 222 212.0
2165 222 1297 216 218 333 217.0
2226 222 1338 220 223 444 222.0
2264 333 1360 229 228 555 227.0
2323 333 1391 234 232 555 232.0
NULL 444 NULL 239 236 555 NULL
2476 111 1484 245 249 444 247.0
NULL 444 NULL 201 NULL 222 NULL

statement query IIIIII
select abs(a) as col1,
       e as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       a-b as col6
from t1
where (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----
245 246 3706 26 111 -4
191 192 2878 16 222 -3
220 221 3331 21 222 -3

statement query IIIIII
select abs(a) as col1,
       e as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5,
       a-b as col6
from t1
where (e>a and e<b)
order by col1,col5,col6,col4,col2,col3;

----
191 192 2878 16 222 -3
220 221 3331 21 222 -3
245 246 3706 26 111 -4

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a-b as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where (e>a and e<b)
   and a>b
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a-b as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where (e>a and e<b)
   and a>b
order by col3,col2,col6,col4,col5,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a-b as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where a>b
   and (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       a-b as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6
from t1
where a>b
   and (e>a and e<b)
order by col3,col6,col4,col5,col2,col1;

----

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where b>c
    or (c<=d-2 or c>=d+2)
    or a>b
order by col4,col5,col2,col3,col1;

----
2 428 142 -4 222
1 560 188 -4 333
1 579 191 -2 222
3 652 216 -2 222
2 514 174 -2 444
1 317 107 -1 333
3 595 199 -1 333
3 685 229 -1 333
NULL NULL 115 -1 444
2 416 138 1 222
1 666 220 1 222
4 391 131 1 333
NULL 711 239 1 444
2 743 245 2 111
4 385 127 2 222
3 635 213 2 333
1 483 163 2 444
3 544 182 3 333
1 698 234 3 333
1 369 121 NULL 222
1 455 153 NULL 333
3 475 159 NULL 333
1 502 168 NULL 333
2 439 149 NULL 444
1 529 179 NULL 444
4 723 243 NULL 444

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where b>c
    or (c<=d-2 or c>=d+2)
    or a>b
order by col3,col2,col5,col1,col4;

----
1 317 107 -1 333
NULL NULL 115 -1 444
1 369 121 NULL 222
4 385 127 2 222
4 391 131 1 333
2 416 138 1 222
2 428 142 -4 222
2 439 149 NULL 444
1 455 153 NULL 333
3 475 159 NULL 333
1 483 163 2 444
1 502 168 NULL 333
2 514 174 -2 444
1 529 179 NULL 444
3 544 182 3 333
1 560 188 -4 333
1 579 191 -2 222
3 595 199 -1 333
3 635 213 2 333
3 652 216 -2 222
1 666 220 1 222
3 685 229 -1 333
1 698 234 3 333
NULL 711 239 1 444
4 723 243 NULL 444
2 743 245 2 111

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where a>b
    or (c<=d-2 or c>=d+2)
    or b>c
order by col4,col5,col2,col3,col1;

----
2 428 142 -4 222
1 560 188 -4 333
1 579 191 -2 222
3 652 216 -2 222
2 514 174 -2 444
1 317 107 -1 333
3 595 199 -1 333
3 685 229 -1 333
NULL NULL 115 -1 444
2 416 138 1 222
1 666 220 1 222
4 391 131 1 333
NULL 711 239 1 444
2 743 245 2 111
4 385 127 2 222
3 635 213 2 333
1 483 163 2 444
3 544 182 3 333
1 698 234 3 333
1 369 121 NULL 222
1 455 153 NULL 333
3 475 159 NULL 333
1 502 168 NULL 333
2 439 149 NULL 444
1 529 179 NULL 444
4 723 243 NULL 444

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where a>b
    or (c<=d-2 or c>=d+2)
    or b>c
order by col1,col4,col5,col2,col3;

----
1 560 188 -4 333
1 579 191 -2 222
1 317 107 -1 333
1 666 220 1 222
1 483 163 2 444
1 698 234 3 333
1 369 121 NULL 222
1 455 153 NULL 333
1 502 168 NULL 333
1 529 179 NULL 444
2 428 142 -4 222
2 514 174 -2 444
2 416 138 1 222
2 743 245 2 111
2 439 149 NULL 444
3 652 216 -2 222
3 595 199 -1 333
3 685 229 -1 333
3 635 213 2 333
3 544 182 3 333
3 475 159 NULL 333
4 391 131 1 333
4 385 127 2 222
4 723 243 NULL 444
NULL NULL 115 -1 444
NULL 711 239 1 444

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where b>c
    or a>b
    or (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
2 428 142 -4 222
1 560 188 -4 333
1 579 191 -2 222
3 652 216 -2 222
2 514 174 -2 444
1 317 107 -1 333
3 595 199 -1 333
3 685 229 -1 333
NULL NULL 115 -1 444
2 416 138 1 222
1 666 220 1 222
4 391 131 1 333
NULL 711 239 1 444
2 743 245 2 111
4 385 127 2 222
3 635 213 2 333
1 483 163 2 444
3 544 182 3 333
1 698 234 3 333
1 369 121 NULL 222
1 455 153 NULL 333
3 475 159 NULL 333
1 502 168 NULL 333
2 439 149 NULL 444
1 529 179 NULL 444
4 723 243 NULL 444

statement query IIIII
select abs(b-c) as col1,
       a+b*2 as col2,
       abs(a) as col3,
       d-e as col4,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col5
from t1
where b>c
    or a>b
    or (c<=d-2 or c>=d+2)
order by col3,col4,col1,col5,col2;

----
1 317 107 -1 333
NULL NULL 115 -1 444
1 369 121 NULL 222
4 385 127 2 222
4 391 131 1 333
2 416 138 1 222
2 428 142 -4 222
2 439 149 NULL 444
1 455 153 NULL 333
3 475 159 NULL 333
1 483 163 2 444
1 502 168 NULL 333
2 514 174 -2 444
1 529 179 NULL 444
3 544 182 3 333
1 560 188 -4 333
1 579 191 -2 222
3 595 199 -1 333
3 635 213 2 333
3 652 216 -2 222
1 666 220 1 222
3 685 229 -1 333
1 698 234 3 333
NULL 711 239 1 444
4 723 243 NULL 444
2 743 245 2 111

statement query IIIIF
select a+b*2 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col4,col5,col2,col3,col1;

----
428 1430 0 -4 142.0
560 376 0 -4 187.0
514 1700 0 -2 172.0
579 382 0 -2 192.0
652 432 0 -2 217.0
317 1050 0 -1 107.0
595 398 0 -1 197.0
685 458 0 -1 227.0
NULL 402 0 -1 NULL
NULL NULL 0 -1 NULL
391 1300 0 1 132.0
416 1390 0 1 137.0
666 440 0 1 222.0
711 2360 0 1 NULL
385 1290 0 2 127.0
483 1600 0 2 162.0
635 426 0 2 212.0
743 490 0 2 247.0
544 364 0 3 182.0
698 468 0 3 232.0
NULL 1120 0 4 NULL
529 358 0 NULL NULL
723 486 0 NULL NULL
369 1240 0 NULL NULL
439 1450 0 NULL NULL
455 1510 0 NULL NULL
475 1580 0 NULL NULL
502 1670 0 NULL NULL
NULL NULL 0 NULL NULL
NULL NULL 0 NULL NULL

statement query IIIIF
select a+b*2 as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       d-e as col4,
       (a+b+c+d+e)/5 as col5
from t1
order by col3,col1,col4,col2,col5;

----
317 1050 0 -1 107.0
369 1240 0 NULL NULL
385 1290 0 2 127.0
391 1300 0 1 132.0
416 1390 0 1 137.0
428 1430 0 -4 142.0
439 1450 0 NULL NULL
455 1510 0 NULL NULL
475 1580 0 NULL NULL
483 1600 0 2 162.0
502 1670 0 NULL NULL
514 1700 0 -2 172.0
529 358 0 NULL NULL
544 364 0 3 182.0
560 376 0 -4 187.0
579 382 0 -2 192.0
595 398 0 -1 197.0
635 426 0 2 212.0
652 432 0 -2 217.0
666 440 0 1 222.0
685 458 0 -1 227.0
698 468 0 3 232.0
711 2360 0 1 NULL
723 486 0 NULL NULL
743 490 0 2 247.0
NULL 402 0 -1 NULL
NULL NULL 0 -1 NULL
NULL 1120 0 4 NULL
NULL NULL 0 NULL NULL
NULL NULL 0 NULL NULL

statement query IIIIIF
select a as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5,
       (a+b+c+d+e)/5 as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
107 635 1067 1612 2 107.0
127 760 1272 1902 -2 127.0
131 793 1325 1985 1 132.0
138 827 1371 2046 -1 137.0
142 851 1411 2131 -1 142.0
163 966 1622 2432 3 162.0
174 1030 1714 2579 4 172.0
182 1096 1828 2728 1 182.0
188 1121 1861 2806 2 187.0
191 1158 1918 2878 -3 192.0
199 1180 1964 2949 1 197.0
213 1277 2125 3175 2 212.0
216 1297 2165 3260 -2 217.0
220 1338 2226 3331 -3 222.0
229 1360 2264 3399 1 227.0
234 1391 2323 3473 2 232.0
245 1484 2476 3706 -4 247.0
121 738 1226 NULL -3 NULL
159 940 NULL NULL 1 NULL
168 1000 NULL NULL 1 NULL
153 905 NULL NULL 2 NULL
243 1455 NULL NULL 3 NULL
239 NULL NULL NULL 3 NULL
149 880 NULL NULL 4 NULL
179 1057 NULL NULL 4 NULL
104 NULL NULL NULL NULL NULL
115 NULL NULL NULL NULL NULL
201 NULL NULL NULL NULL NULL
NULL NULL NULL NULL NULL NULL
NULL NULL NULL NULL NULL NULL

statement query IIIIIF
select a as col1,
       a+b*2+c*3 as col2,
       a+b*2+c*3+d*4 as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5,
       (a+b+c+d+e)/5 as col6
from t1
order by col3,col2,col6,col1,col5,col4;

----
107 635 1067 1612 2 107.0
121 738 1226 NULL -3 NULL
127 760 1272 1902 -2 127.0
131 793 1325 1985 1 132.0
138 827 1371 2046 -1 137.0
142 851 1411 2131 -1 142.0
163 966 1622 2432 3 162.0
174 1030 1714 2579 4 172.0
182 1096 1828 2728 1 182.0
188 1121 1861 2806 2 187.0
191 1158 1918 2878 -3 192.0
199 1180 1964 2949 1 197.0
213 1277 2125 3175 2 212.0
216 1297 2165 3260 -2 217.0
220 1338 2226 3331 -3 222.0
229 1360 2264 3399 1 227.0
234 1391 2323 3473 2 232.0
245 1484 2476 3706 -4 247.0
149 880 NULL NULL 4 NULL
153 905 NULL NULL 2 NULL
159 940 NULL NULL 1 NULL
168 1000 NULL NULL 1 NULL
179 1057 NULL NULL 4 NULL
243 1455 NULL NULL 3 NULL
104 NULL NULL NULL NULL NULL
115 NULL NULL NULL NULL NULL
201 NULL NULL NULL NULL NULL
239 NULL NULL NULL 3 NULL
NULL NULL NULL NULL NULL NULL
NULL NULL NULL NULL NULL NULL

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where a>b
   and (c<=d-2 or c>=d+2)
order by col2,col1;

----
0 0
10 0
15 0
19 0
23 0

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where a>b
   and (c<=d-2 or c>=d+2)
order by col1,col2;

----
0 0
10 0
15 0
19 0
23 0

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where (c<=d-2 or c>=d+2)
   and a>b
order by col2,col1;

----
0 0
10 0
15 0
19 0
23 0

statement query II
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2
from t1
where (c<=d-2 or c>=d+2)
   and a>b
order by col2,col1;

----
0 0
10 0
15 0
19 0
23 0

statement query IIIIII
select a+b*2 as col1,
       abs(a) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4 as col4,
       b-c as col5,
       b as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
317 107 333 1067 -1 105
NULL NULL 444 NULL -1 112
369 121 222 1226 1 124
385 127 222 1272 4 129
391 131 333 1325 -4 130
416 138 222 1371 2 139
428 142 222 1411 2 143
439 149 444 NULL -2 145
455 153 333 NULL 1 151
475 159 333 NULL 3 158
483 163 444 1622 -1 160
502 168 333 NULL 1 167
514 174 444 1714 -2 170
529 179 444 NULL -1 175
544 182 333 1828 -3 181
560 188 333 1861 -1 186
579 191 222 1918 1 194
595 199 333 1964 3 198
NULL NULL 444 NULL -2 206
635 213 333 2125 -3 211
652 216 222 2165 3 218
666 220 222 2226 -1 223
685 229 333 2264 3 228
698 234 333 2323 1 232
711 239 444 NULL NULL 236
723 243 444 NULL -4 240
743 245 111 2476 2 249
NULL 104 444 NULL NULL NULL
NULL 115 444 NULL NULL NULL
NULL 201 444 NULL NULL NULL

statement query IIIIII
select a+b*2 as col1,
       abs(a) as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       a+b*2+c*3+d*4 as col4,
       b-c as col5,
       b as col6
from t1
order by col6,col3,col5,col2,col1,col4;

----
317 107 333 1067 -1 105
NULL NULL 444 NULL -1 112
369 121 222 1226 1 124
385 127 222 1272 4 129
391 131 333 1325 -4 130
416 138 222 1371 2 139
428 142 222 1411 2 143
439 149 444 NULL -2 145
455 153 333 NULL 1 151
475 159 333 NULL 3 158
483 163 444 1622 -1 160
502 168 333 NULL 1 167
514 174 444 1714 -2 170
529 179 444 NULL -1 175
544 182 333 1828 -3 181
560 188 333 1861 -1 186
579 191 222 1918 1 194
595 199 333 1964 3 198
NULL NULL 444 NULL -2 206
635 213 333 2125 -3 211
652 216 222 2165 3 218
666 220 222 2226 -1 223
685 229 333 2264 3 228
698 234 333 2323 1 232
711 239 444 NULL NULL 236
723 243 444 NULL -4 240
743 245 111 2476 2 249
NULL 104 444 NULL NULL NULL
NULL 115 444 NULL NULL NULL
NULL 201 444 NULL NULL NULL

statement query IIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (c<=d-2 or c>=d+2)
   and d>e
   and (e>c or e<d)
order by col6,col4,col5,col2,col3,col1;

----
333 1272 127 222 385 -3
333 1622 163 444 483 -3
555 2323 234 333 698 -2
444 2226 220 222 666 2
222 2125 213 333 635 2

statement query IIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (c<=d-2 or c>=d+2)
   and d>e
   and (e>c or e<d)
order by col6,col3,col2,col1,col5,col4;

----
333 1272 127 222 385 -3
333 1622 163 444 483 -3
555 2323 234 333 698 -2
222 2125 213 333 635 2
444 2226 220 222 666 2

statement query IIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (e>c or e<d)
   and (c<=d-2 or c>=d+2)
   and d>e
order by col6,col4,col5,col2,col3,col1;

----
333 1272 127 222 385 -3
333 1622 163 444 483 -3
555 2323 234 333 698 -2
444 2226 220 222 666 2
222 2125 213 333 635 2

statement query IIIIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3+d*4 as col2,
       a as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2 as col5,
       c-d as col6
from t1
where (e>c or e<d)
   and (c<=d-2 or c>=d+2)
   and d>e
order by col4,col1,col2,col6,col5,col3;

----
333 1272 127 222 385 -3
444 2226 220 222 666 2
222 2125 213 333 635 2
555 2323 234 333 698 -2
333 1622 163 444 483 -3

statement query IIIII
select b-c as col1,
       c-d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(b-c) as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5
from t1
where d>e
order by col4,col5,col2,col3,col1;

----
-1 -1 0 1 1
-1 -3 0 1 10
-1 2 0 1 21
1 -2 0 1 23
2 1 0 2 5
2 -1 0 2 26
-3 1 0 3 14
-3 2 0 3 19
4 -3 0 4 3
-4 1 0 4 4
NULL NULL 0 NULL 24

statement query IIIII
select b-c as col1,
       c-d as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       abs(b-c) as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5
from t1
where d>e
order by col4,col1,col5,col2,col3;

----
-1 -1 0 1 1
-1 -3 0 1 10
-1 2 0 1 21
1 -2 0 1 23
2 1 0 2 5
2 -1 0 2 26
-3 1 0 3 14
-3 2 0 3 19
-4 1 0 4 4
4 -3 0 4 3
NULL NULL 0 NULL 24

statement query IIIIII
select abs(a) as col1,
       a+b*2 as col2,
       c-d as col3,
       abs(b-c) as col4,
       a+b*2+c*3 as col5,
       a-b as col6
from t1
where b>c
order by col6,col4,col5,col2,col3,col1;

----
245 743 -1 2 1484 -4
121 369 1 1 738 -3
191 579 3 1 1158 -3
216 652 -2 3 1297 -2
127 385 -3 4 760 -2
138 416 1 2 827 -1
142 428 1 2 851 -1
168 502 NULL 1 1000 1
159 475 NULL 3 940 1
199 595 -1 3 1180 1
229 685 -1 3 1360 1
153 455 NULL 1 905 2
234 698 -2 1 1391 2

statement query IIIIII
select abs(a) as col1,
       a+b*2 as col2,
       c-d as col3,
       abs(b-c) as col4,
       a+b*2+c*3 as col5,
       a-b as col6
from t1
where b>c
order by col3,col2,col6,col4,col5,col1;

----
127 385 -3 4 760 -2
216 652 -2 3 1297 -2
234 698 -2 1 1391 2
199 595 -1 3 1180 1
229 685 -1 3 1360 1
245 743 -1 2 1484 -4
121 369 1 1 738 -3
138 416 1 2 827 -1
142 428 1 2 851 -1
191 579 3 1 1158 -3
153 455 NULL 1 905 2
159 475 NULL 3 940 1
168 502 NULL 1 1000 1

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where (e>a and e<b)
    or d not between 110 and 150
order by col2,col3,col1;

----
333 635 0
444 966 10
444 1030 12
333 1096 14
333 1121 15
222 1158 16
333 1180 17
333 1277 19
222 1297 20
222 1338 21
333 1360 22
333 1391 23
111 1484 26
444 NULL 0
444 NULL 0
444 NULL 18
444 NULL 24

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where (e>a and e<b)
    or d not between 110 and 150
order by col3,col1,col2;

----
333 635 0
444 NULL 0
444 NULL 0
444 966 10
444 1030 12
333 1096 14
333 1121 15
222 1158 16
333 1180 17
444 NULL 18
333 1277 19
222 1297 20
222 1338 21
333 1360 22
333 1391 23
444 NULL 24
111 1484 26

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or (e>a and e<b)
order by col2,col3,col1;

----
333 635 0
444 966 10
444 1030 12
333 1096 14
333 1121 15
222 1158 16
333 1180 17
333 1277 19
222 1297 20
222 1338 21
333 1360 22
333 1391 23
111 1484 26
444 NULL 0
444 NULL 0
444 NULL 18
444 NULL 24

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
where d not between 110 and 150
    or (e>a and e<b)
order by col1,col2,col3;

----
111 1484 26
222 1158 16
222 1297 20
222 1338 21
333 635 0
333 1096 14
333 1121 15
333 1180 17
333 1277 19
333 1360 22
333 1391 23
444 966 10
444 1030 12
444 NULL 0
444 NULL 0
444 NULL 18
444 NULL 24

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
order by col1;

----
111
222
222
222
222
333
333
333
333
333
333
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
order by col1;

----
111
222
222
222
222
333
333
333
333
333
333
444
444
444
444

statement query skipped
elect a+b*2+c*3 as col1,
       b as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(a) as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where (e>a and e<b)
   and (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect a+b*2+c*3 as col1,
       b as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(a) as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where (e>a and e<b)
   and (a>b-2 and a<b+2)
order by col4,col1,col6,col3,col5,col2;

----

statement query skipped
elect a+b*2+c*3 as col1,
       b as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(a) as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where (a>b-2 and a<b+2)
   and (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect a+b*2+c*3 as col1,
       b as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       abs(a) as col4,
       e as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6
from t1
where (a>b-2 and a<b+2)
   and (e>a and e<b)
order by col4,col3,col1,col2,col6,col5;

----

statement query I
select a+b*2+c*3 as col1
from t1
where b>c
    or (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where b>c
    or (e>c or e<d)
    or e+d between a+b-10 and c+130
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where e+d between a+b-10 and c+130
    or (e>c or e<d)
    or b>c
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where e+d between a+b-10 and c+130
    or (e>c or e<d)
    or b>c
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where (e>c or e<d)
    or b>c
    or e+d between a+b-10 and c+130
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query I
select a+b*2+c*3 as col1
from t1
where (e>c or e<d)
    or b>c
    or e+d between a+b-10 and c+130
order by col1;

----
635
738
760
793
827
851
905
940
966
1000
1030
1057
1096
1121
1158
1180
1277
1297
1338
1360
1391
1484
NULL
NULL
NULL

statement query II
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
153 333
159 333
168 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
149 444
163 444
174 444
179 444
201 444
239 444
243 444
NULL 444
NULL 444

statement query II
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
153 333
159 333
168 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
149 444
163 444
174 444
179 444
201 444
239 444
243 444
NULL 444
NULL 444

statement query IIIII
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4,
       b as col5
from t1
where (e>c or e<d)
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
188 333 444 -4 186
216 222 333 -2 218
107 333 333 -1 105
220 222 444 1 223
127 222 333 2 129
163 444 333 2 160
213 333 222 2 211
234 333 555 3 232

statement query IIIII
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4,
       b as col5
from t1
where (e>c or e<d)
   and (c<=d-2 or c>=d+2)
order by col2,col1,col3,col4,col5;

----
127 222 333 2 129
216 222 333 -2 218
220 222 444 1 223
107 333 333 -1 105
188 333 444 -4 186
213 333 222 2 211
234 333 555 3 232
163 444 333 2 160

statement query IIIII
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4,
       b as col5
from t1
where (c<=d-2 or c>=d+2)
   and (e>c or e<d)
order by col4,col5,col2,col3,col1;

----
188 333 444 -4 186
216 222 333 -2 218
107 333 333 -1 105
220 222 444 1 223
127 222 333 2 129
163 444 333 2 160
213 333 222 2 211
234 333 555 3 232

statement query IIIII
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       d-e as col4,
       b as col5
from t1
where (c<=d-2 or c>=d+2)
   and (e>c or e<d)
order by col4,col3,col2,col5,col1;

----
188 333 444 -4 186
216 222 333 -2 218
107 333 333 -1 105
220 222 444 1 223
213 333 222 2 211
127 222 333 2 129
163 444 333 2 160
234 333 555 3 232

statement query ITITTII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       c-d as col3,
       a-b as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       a as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
102 NULL 1 NULL NULL 0 104
106 107.0 -2 2 1 0 107
119 NULL 3 NULL NULL 0 115
202 NULL -1 NULL NULL 0 201
113 NULL -1 NULL 1 1 NULL
123 NULL 1 -3 1 2 121
125 127.0 -3 -2 4 3 127
134 132.0 1 1 4 4 131
137 137.0 1 -1 2 5 138
141 142.0 1 -1 2 6 142
147 NULL NULL 4 2 7 149
150 NULL NULL 2 1 8 153
155 NULL NULL 1 3 9 159
161 162.0 -3 3 1 10 163
166 NULL NULL 1 1 11 168
172 172.0 1 4 2 12 174
176 NULL NULL 4 1 13 179
184 182.0 1 1 3 14 182
187 187.0 2 2 1 15 188
193 192.0 3 -3 1 16 191
195 197.0 -1 1 3 17 199
208 NULL 1 NULL 2 18 NULL
214 212.0 2 2 3 19 213
215 217.0 -2 -2 3 20 216
224 222.0 2 -3 1 21 220
225 227.0 -1 1 3 22 229
231 232.0 -2 2 1 23 234
NULL NULL NULL 3 NULL 24 239
244 NULL NULL 3 4 25 243
247 247.0 -1 -4 2 26 245

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       c-d as col3,
       a-b as col4,
       abs(b-c) as col5,
       (select count(*) from t1 as x where x.b<t1.b) as col6,
       a as col7
from t1
order by col2,col4,col6,col1,col7,col5,col3;

----
106 107.0 -2 2 1 0 107
125 127.0 -3 -2 4 3 127
134 132.0 1 1 4 4 131
137 137.0 1 -1 2 5 138
141 142.0 1 -1 2 6 142
161 162.0 -3 3 1 10 163
172 172.0 1 4 2 12 174
184 182.0 1 1 3 14 182
187 187.0 2 2 1 15 188
193 192.0 3 -3 1 16 191
195 197.0 -1 1 3 17 199
214 212.0 2 2 3 19 213
215 217.0 -2 -2 3 20 216
224 222.0 2 -3 1 21 220
225 227.0 -1 1 3 22 229
231 232.0 -2 2 1 23 234
247 247.0 -1 -4 2 26 245
123 NULL 1 -3 1 2 121
155 NULL NULL 1 3 9 159
166 NULL NULL 1 1 11 168
150 NULL NULL 2 1 8 153
NULL NULL NULL 3 NULL 24 239
244 NULL NULL 3 4 25 243
147 NULL NULL 4 2 7 149
176 NULL NULL 4 1 13 179
102 NULL 1 NULL NULL 0 104
119 NULL 3 NULL NULL 0 115
202 NULL -1 NULL NULL 0 201
113 NULL -1 NULL 1 1 NULL
208 NULL 1 NULL 2 18 NULL

statement query IIII
select a-b as col1,
       c-d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3 as col4
from t1
order by col4,col2,col3,col1;

----
2 -2 0 635
-3 1 2 738
-2 -3 3 760
1 1 4 793
-1 1 5 827
-1 1 6 851
4 NULL 7 880
2 NULL 8 905
1 NULL 9 940
3 -3 10 966
1 NULL 11 1000
4 1 12 1030
4 NULL 13 1057
1 1 14 1096
2 2 15 1121
-3 3 16 1158
1 -1 17 1180
2 2 19 1277
-2 -2 20 1297
-3 2 21 1338
1 -1 22 1360
2 -2 23 1391
3 NULL 25 1455
-4 -1 26 1484
NULL -1 0 NULL
NULL -1 1 NULL
NULL 1 0 NULL
NULL 1 18 NULL
NULL 3 0 NULL
3 NULL 24 NULL

statement query IIII
select a-b as col1,
       c-d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       a+b*2+c*3 as col4
from t1
order by col4,col1,col3,col2;

----
2 -2 0 635
-3 1 2 738
-2 -3 3 760
1 1 4 793
-1 1 5 827
-1 1 6 851
4 NULL 7 880
2 NULL 8 905
1 NULL 9 940
3 -3 10 966
1 NULL 11 1000
4 1 12 1030
4 NULL 13 1057
1 1 14 1096
2 2 15 1121
-3 3 16 1158
1 -1 17 1180
2 2 19 1277
-2 -2 20 1297
-3 2 21 1338
1 -1 22 1360
2 -2 23 1391
3 NULL 25 1455
-4 -1 26 1484
3 NULL 24 NULL
NULL -1 0 NULL
NULL 1 0 NULL
NULL 3 0 NULL
NULL -1 1 NULL
NULL 1 18 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
132.0 134 133 0 -4
NULL 244 NULL 0 -4
182.0 184 183 0 -3
212.0 214 212 0 -3
NULL 147 NULL 0 -2
172.0 172 171 0 -2
NULL 208 207 0 -2
107.0 106 108 0 -1
NULL 113 114 0 -1
162.0 161 164 0 -1
NULL 176 NULL 0 -1
187.0 187 185 0 -1
222.0 224 222 0 -1
NULL 123 122 0 1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
192.0 193 190 0 1
232.0 231 233 0 1
137.0 137 136 0 2
142.0 141 140 0 2
247.0 247 248 0 2
NULL 155 NULL 0 3
197.0 195 196 0 3
217.0 215 217 0 3
227.0 225 226 0 3
127.0 125 128 0 4
NULL 102 101 0 NULL
NULL 202 203 0 NULL
NULL NULL 238 0 NULL

statement query TIIIT
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col2,col3,col4,col5,col1;

----
NULL 102 101 0 NULL
107.0 106 108 0 -1
NULL 113 114 0 -1
NULL 123 122 0 1
127.0 125 128 0 4
132.0 134 133 0 -4
137.0 137 136 0 2
142.0 141 140 0 2
NULL 147 NULL 0 -2
NULL 150 NULL 0 1
NULL 155 NULL 0 3
162.0 161 164 0 -1
NULL 166 NULL 0 1
172.0 172 171 0 -2
NULL 176 NULL 0 -1
182.0 184 183 0 -3
187.0 187 185 0 -1
192.0 193 190 0 1
197.0 195 196 0 3
NULL 202 203 0 NULL
NULL 208 207 0 -2
212.0 214 212 0 -3
217.0 215 217 0 3
222.0 224 222 0 -1
227.0 225 226 0 3
232.0 231 233 0 1
NULL 244 NULL 0 -4
247.0 247 248 0 2
NULL NULL 238 0 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
132.0 134 133 0 -4
NULL 244 NULL 0 -4
182.0 184 183 0 -3
212.0 214 212 0 -3
NULL 147 NULL 0 -2
172.0 172 171 0 -2
NULL 208 207 0 -2
107.0 106 108 0 -1
NULL 113 114 0 -1
162.0 161 164 0 -1
NULL 176 NULL 0 -1
187.0 187 185 0 -1
222.0 224 222 0 -1
NULL 123 122 0 1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
192.0 193 190 0 1
232.0 231 233 0 1
137.0 137 136 0 2
142.0 141 140 0 2
247.0 247 248 0 2
NULL 155 NULL 0 3
197.0 195 196 0 3
217.0 215 217 0 3
227.0 225 226 0 3
127.0 125 128 0 4
NULL 102 101 0 NULL
NULL 202 203 0 NULL
NULL NULL 238 0 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col4,col1,col5,col2,col3;

----
107.0 106 108 0 -1
127.0 125 128 0 4
132.0 134 133 0 -4
137.0 137 136 0 2
142.0 141 140 0 2
162.0 161 164 0 -1
172.0 172 171 0 -2
182.0 184 183 0 -3
187.0 187 185 0 -1
192.0 193 190 0 1
197.0 195 196 0 3
212.0 214 212 0 -3
217.0 215 217 0 3
222.0 224 222 0 -1
227.0 225 226 0 3
232.0 231 233 0 1
247.0 247 248 0 2
NULL 244 NULL 0 -4
NULL 147 NULL 0 -2
NULL 208 207 0 -2
NULL 113 114 0 -1
NULL 176 NULL 0 -1
NULL 123 122 0 1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
NULL 155 NULL 0 3
NULL 102 101 0 NULL
NULL 202 203 0 NULL
NULL NULL 238 0 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
132.0 134 133 0 -4
NULL 244 NULL 0 -4
182.0 184 183 0 -3
212.0 214 212 0 -3
NULL 147 NULL 0 -2
172.0 172 171 0 -2
NULL 208 207 0 -2
107.0 106 108 0 -1
NULL 113 114 0 -1
162.0 161 164 0 -1
NULL 176 NULL 0 -1
187.0 187 185 0 -1
222.0 224 222 0 -1
NULL 123 122 0 1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
192.0 193 190 0 1
232.0 231 233 0 1
137.0 137 136 0 2
142.0 141 140 0 2
247.0 247 248 0 2
NULL 155 NULL 0 3
197.0 195 196 0 3
217.0 215 217 0 3
227.0 225 226 0 3
127.0 125 128 0 4
NULL 102 101 0 NULL
NULL 202 203 0 NULL
NULL NULL 238 0 NULL

statement query TIIIT
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col3,col5,col4,col2,col1;

----
NULL 102 101 0 NULL
107.0 106 108 0 -1
NULL 113 114 0 -1
NULL 123 122 0 1
127.0 125 128 0 4
132.0 134 133 0 -4
137.0 137 136 0 2
142.0 141 140 0 2
162.0 161 164 0 -1
172.0 172 171 0 -2
182.0 184 183 0 -3
187.0 187 185 0 -1
192.0 193 190 0 1
197.0 195 196 0 3
NULL 202 203 0 NULL
NULL 208 207 0 -2
212.0 214 212 0 -3
217.0 215 217 0 3
222.0 224 222 0 -1
227.0 225 226 0 3
232.0 231 233 0 1
NULL NULL 238 0 NULL
247.0 247 248 0 2
NULL 244 NULL 0 -4
NULL 147 NULL 0 -2
NULL 176 NULL 0 -1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
NULL 155 NULL 0 3

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
132.0 134 133 0 -4
NULL 244 NULL 0 -4
182.0 184 183 0 -3
212.0 214 212 0 -3
NULL 147 NULL 0 -2
172.0 172 171 0 -2
NULL 208 207 0 -2
107.0 106 108 0 -1
NULL 113 114 0 -1
162.0 161 164 0 -1
NULL 176 NULL 0 -1
187.0 187 185 0 -1
222.0 224 222 0 -1
NULL 123 122 0 1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
192.0 193 190 0 1
232.0 231 233 0 1
137.0 137 136 0 2
142.0 141 140 0 2
247.0 247 248 0 2
NULL 155 NULL 0 3
197.0 195 196 0 3
217.0 215 217 0 3
227.0 225 226 0 3
127.0 125 128 0 4
NULL 102 101 0 NULL
NULL 202 203 0 NULL
NULL NULL 238 0 NULL

statement query FIIII
select (a+b+c+d+e)/5 as col1,
       c as col2,
       d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col1,col3,col5,col2;

----
107.0 106 108 0 -1
127.0 125 128 0 4
132.0 134 133 0 -4
137.0 137 136 0 2
142.0 141 140 0 2
162.0 161 164 0 -1
172.0 172 171 0 -2
182.0 184 183 0 -3
187.0 187 185 0 -1
192.0 193 190 0 1
197.0 195 196 0 3
212.0 214 212 0 -3
217.0 215 217 0 3
222.0 224 222 0 -1
227.0 225 226 0 3
232.0 231 233 0 1
247.0 247 248 0 2
NULL 102 101 0 NULL
NULL 113 114 0 -1
NULL 123 122 0 1
NULL 202 203 0 NULL
NULL 208 207 0 -2
NULL NULL 238 0 NULL
NULL 244 NULL 0 -4
NULL 147 NULL 0 -2
NULL 176 NULL 0 -1
NULL 150 NULL 0 1
NULL 166 NULL 0 1
NULL 155 NULL 0 3

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3,
       e as col4
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
   and a>b
order by col4,col2,col3,col1;

----
333 1096 1 180
555 1180 -1 197
555 1360 -1 227

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3,
       e as col4
from t1
where d not between 110 and 150
   and (a>b-2 and a<b+2)
   and a>b
order by col3,col2,col1,col4;

----
555 1180 -1 197
555 1360 -1 227
333 1096 1 180

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3,
       e as col4
from t1
where (a>b-2 and a<b+2)
   and a>b
   and d not between 110 and 150
order by col4,col2,col3,col1;

----
333 1096 1 180
555 1180 -1 197
555 1360 -1 227

statement query IIII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a+b*2+c*3 as col2,
       c-d as col3,
       e as col4
from t1
where (a>b-2 and a<b+2)
   and a>b
   and d not between 110 and 150
order by col2,col4,col3,col1;

----
333 1096 1 180
555 1180 -1 197
555 1360 -1 227

statement query IIIITIT
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       c as col3,
       b as col4,
       abs(a) as col5,
       d as col6,
       a as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1;

----
0 444 113 112 NULL 114 NULL
0 222 123 124 121 122 121
0 222 125 129 127 128 127
0 333 134 130 131 133 131
0 222 137 139 138 136 138
0 222 141 143 142 140 142
0 444 161 160 163 164 163
0 444 172 170 174 171 174
0 333 184 181 182 183 182
0 333 187 186 188 185 188
0 222 193 194 191 190 191
0 333 195 198 199 196 199
0 444 208 206 NULL 207 NULL
0 333 214 211 213 212 213
0 222 215 218 216 217 216
0 222 224 223 220 222 220
0 333 225 228 229 226 229
0 333 231 232 234 233 234
0 444 NULL 236 239 238 239
0 111 247 249 245 248 245
0 444 147 145 149 NULL 149
0 333 150 151 153 NULL 153
0 333 155 158 159 NULL 159
0 333 166 167 168 NULL 168
0 444 176 175 179 NULL 179
0 444 244 240 243 NULL 243

statement query IIIIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       c as col3,
       b as col4,
       abs(a) as col5,
       d as col6,
       a as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col5,col4,col2,col6,col7,col3;

----
0 222 123 124 121 122 121
0 222 125 129 127 128 127
0 333 134 130 131 133 131
0 222 137 139 138 136 138
0 222 141 143 142 140 142
0 444 147 145 149 NULL 149
0 333 150 151 153 NULL 153
0 333 155 158 159 NULL 159
0 444 161 160 163 164 163
0 333 166 167 168 NULL 168
0 444 172 170 174 171 174
0 444 176 175 179 NULL 179
0 333 184 181 182 183 182
0 333 187 186 188 185 188
0 222 193 194 191 190 191
0 333 195 198 199 196 199
0 333 214 211 213 212 213
0 222 215 218 216 217 216
0 222 224 223 220 222 220
0 333 225 228 229 226 229
0 333 231 232 234 233 234
0 444 NULL 236 239 238 239
0 444 244 240 243 NULL 243
0 111 247 249 245 248 245
0 444 113 112 NULL 114 NULL
0 444 208 206 NULL 207 NULL

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       abs(a) as col4,
       a-b as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
order by col4,col5,col2,col3,col1;

----
2 1 1226 121 -3
3 4 1272 127 -2
5 2 1371 138 -1
6 2 1411 142 -1
8 1 NULL 153 2
9 3 NULL 159 1
11 1 NULL 168 1
16 1 1918 191 -3
17 3 1964 199 1
20 3 2165 216 -2
22 3 2264 229 1
23 1 2323 234 2
26 2 2476 245 -4

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       abs(a) as col4,
       a-b as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and b>c
order by col3,col2,col1,col5,col4;

----
2 1 1226 121 -3
3 4 1272 127 -2
5 2 1371 138 -1
6 2 1411 142 -1
16 1 1918 191 -3
17 3 1964 199 1
20 3 2165 216 -2
22 3 2264 229 1
23 1 2323 234 2
26 2 2476 245 -4
8 1 NULL 153 2
11 1 NULL 168 1
9 3 NULL 159 1

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       abs(a) as col4,
       a-b as col5
from t1
where b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
2 1 1226 121 -3
3 4 1272 127 -2
5 2 1371 138 -1
6 2 1411 142 -1
8 1 NULL 153 2
9 3 NULL 159 1
11 1 NULL 168 1
16 1 1918 191 -3
17 3 1964 199 1
20 3 2165 216 -2
22 3 2264 229 1
23 1 2323 234 2
26 2 2476 245 -4

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       a+b*2+c*3+d*4 as col3,
       abs(a) as col4,
       a-b as col5
from t1
where b>c
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col5,col4,col2,col1;

----
2 1 1226 121 -3
3 4 1272 127 -2
5 2 1371 138 -1
6 2 1411 142 -1
16 1 1918 191 -3
17 3 1964 199 1
20 3 2165 216 -2
22 3 2264 229 1
23 1 2323 234 2
26 2 2476 245 -4
9 3 NULL 159 1
11 1 NULL 168 1
8 1 NULL 153 2

statement query IIIIIIT
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>a and e<b)
    or (e>c or e<d)
    or b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
204 201 0 0 NULL 402 NULL
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
246 245 26 0 2 490 3706
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
NULL 121 2 0 1 1240 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
NULL 153 8 0 1 1510 NULL
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
237 239 24 0 NULL 2360 NULL

statement query IIIIIII
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>a and e<b)
    or (e>c or e<d)
    or b>c
order by col5,col4,col3,col6,col2,col1,col7;

----
132 131 4 0 -4 1300 1985
180 182 14 0 -3 364 2728
210 213 19 0 -3 426 3175
173 174 12 0 -2 1700 2579
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
162 163 10 0 -1 1600 2432
177 179 13 0 -1 358 NULL
189 188 15 0 -1 376 2806
221 220 21 0 -1 440 3331
NULL 121 2 0 1 1240 NULL
NULL 153 8 0 1 1510 NULL
165 168 11 0 1 1670 NULL
192 191 16 0 1 382 2878
230 234 23 0 1 468 3473
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
246 245 26 0 2 490 3706
157 159 9 0 3 1580 NULL
197 199 17 0 3 398 2949
219 216 20 0 3 432 3260
227 229 22 0 3 458 3399
126 127 3 0 4 1290 1902
204 201 0 0 NULL 402 NULL
237 239 24 0 NULL 2360 NULL

statement query IIIIIIT
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>c or e<d)
    or b>c
    or (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
204 201 0 0 NULL 402 NULL
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
246 245 26 0 2 490 3706
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
NULL 121 2 0 1 1240 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
NULL 153 8 0 1 1510 NULL
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
237 239 24 0 NULL 2360 NULL

statement query IIIIIII
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>c or e<d)
    or b>c
    or (e>a and e<b)
order by col1,col4,col6,col2,col3,col5,col7;

----
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
204 201 0 0 NULL 402 NULL
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
237 239 24 0 NULL 2360 NULL
246 245 26 0 2 490 3706
NULL 121 2 0 1 1240 NULL
NULL 153 8 0 1 1510 NULL

statement query IIIIIIT
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where b>c
    or (e>c or e<d)
    or (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
204 201 0 0 NULL 402 NULL
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
246 245 26 0 2 490 3706
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
NULL 121 2 0 1 1240 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
NULL 153 8 0 1 1510 NULL
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
237 239 24 0 NULL 2360 NULL

statement query IIIITIT
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where b>c
    or (e>c or e<d)
    or (e>a and e<b)
order by col4,col3,col6,col5,col7,col1,col2;

----
204 201 0 0 NULL 402 NULL
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
NULL 121 2 0 1 1240 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
NULL 153 8 0 1 1510 NULL
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
237 239 24 0 NULL 2360 NULL
246 245 26 0 2 490 3706

statement query IIIIIIT
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
177 179 13 0 -1 358 NULL
180 182 14 0 -3 364 2728
189 188 15 0 -1 376 2806
192 191 16 0 1 382 2878
197 199 17 0 3 398 2949
204 201 0 0 NULL 402 NULL
210 213 19 0 -3 426 3175
219 216 20 0 3 432 3260
221 220 21 0 -1 440 3331
227 229 22 0 3 458 3399
230 234 23 0 1 468 3473
246 245 26 0 2 490 3706
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
NULL 121 2 0 1 1240 NULL
126 127 3 0 4 1290 1902
132 131 4 0 -4 1300 1985
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
NULL 153 8 0 1 1510 NULL
157 159 9 0 3 1580 NULL
162 163 10 0 -1 1600 2432
165 168 11 0 1 1670 NULL
173 174 12 0 -2 1700 2579
237 239 24 0 NULL 2360 NULL

statement query IIIIIII
select e as col1,
       abs(a) as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col6,
       a+b*2+c*3+d*4+e*5 as col7
from t1
where (e>c or e<d)
    or (e>a and e<b)
    or b>c
order by col5,col3,col6,col7,col4,col2,col1;

----
132 131 4 0 -4 1300 1985
180 182 14 0 -3 364 2728
210 213 19 0 -3 426 3175
173 174 12 0 -2 1700 2579
109 107 0 0 -1 1050 1612
110 NULL 1 0 -1 1120 NULL
162 163 10 0 -1 1600 2432
177 179 13 0 -1 358 NULL
189 188 15 0 -1 376 2806
221 220 21 0 -1 440 3331
NULL 121 2 0 1 1240 NULL
NULL 153 8 0 1 1510 NULL
165 168 11 0 1 1670 NULL
192 191 16 0 1 382 2878
230 234 23 0 1 468 3473
135 138 5 0 2 1390 2046
144 142 6 0 2 1430 2131
246 245 26 0 2 490 3706
157 159 9 0 3 1580 NULL
197 199 17 0 3 398 2949
219 216 20 0 3 432 3260
227 229 22 0 3 458 3399
126 127 3 0 4 1290 1902
204 201 0 0 NULL 402 NULL
237 239 24 0 NULL 2360 NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where b>c
    or (e>c or e<d)
    or (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
1067 -1 -2 107
NULL NULL 3 115
1226 1 1 121
1272 4 -3 127
1325 -4 1 131
1371 2 1 138
1411 2 1 142
NULL 1 NULL 153
NULL 3 NULL 159
1622 -1 -3 163
NULL 1 NULL 168
1714 -2 1 174
NULL -1 NULL 179
1828 -3 1 182
1861 -1 2 188
1918 1 3 191
1964 3 -1 199
NULL NULL -1 201
2125 -3 2 213
2165 3 -2 216
2226 -1 2 220
2264 3 -1 229
2323 1 -2 234
NULL NULL NULL 239
2476 2 -1 245
NULL -1 -1 NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where b>c
    or (e>c or e<d)
    or (c<=d-2 or c>=d+2)
order by col3,col4,col2,col1;

----
1272 4 -3 127
1622 -1 -3 163
1067 -1 -2 107
2165 3 -2 216
2323 1 -2 234
1964 3 -1 199
NULL NULL -1 201
2264 3 -1 229
2476 2 -1 245
NULL -1 -1 NULL
1226 1 1 121
1325 -4 1 131
1371 2 1 138
1411 2 1 142
1714 -2 1 174
1828 -3 1 182
1861 -1 2 188
2125 -3 2 213
2226 -1 2 220
NULL NULL 3 115
1918 1 3 191
NULL 1 NULL 153
NULL 3 NULL 159
NULL 1 NULL 168
NULL -1 NULL 179
NULL NULL NULL 239

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where (e>c or e<d)
    or b>c
    or (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
1067 -1 -2 107
NULL NULL 3 115
1226 1 1 121
1272 4 -3 127
1325 -4 1 131
1371 2 1 138
1411 2 1 142
NULL 1 NULL 153
NULL 3 NULL 159
1622 -1 -3 163
NULL 1 NULL 168
1714 -2 1 174
NULL -1 NULL 179
1828 -3 1 182
1861 -1 2 188
1918 1 3 191
1964 3 -1 199
NULL NULL -1 201
2125 -3 2 213
2165 3 -2 216
2226 -1 2 220
2264 3 -1 229
2323 1 -2 234
NULL NULL NULL 239
2476 2 -1 245
NULL -1 -1 NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where (e>c or e<d)
    or b>c
    or (c<=d-2 or c>=d+2)
order by col2,col3,col4,col1;

----
1325 -4 1 131
1828 -3 1 182
2125 -3 2 213
1714 -2 1 174
1622 -1 -3 163
1067 -1 -2 107
NULL -1 -1 NULL
1861 -1 2 188
2226 -1 2 220
NULL -1 NULL 179
2323 1 -2 234
1226 1 1 121
1918 1 3 191
NULL 1 NULL 153
NULL 1 NULL 168
2476 2 -1 245
1371 2 1 138
1411 2 1 142
2165 3 -2 216
1964 3 -1 199
2264 3 -1 229
NULL 3 NULL 159
1272 4 -3 127
NULL NULL -1 201
NULL NULL 3 115
NULL NULL NULL 239

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where b>c
    or (c<=d-2 or c>=d+2)
    or (e>c or e<d)
order by col4,col2,col3,col1;

----
1067 -1 -2 107
NULL NULL 3 115
1226 1 1 121
1272 4 -3 127
1325 -4 1 131
1371 2 1 138
1411 2 1 142
NULL 1 NULL 153
NULL 3 NULL 159
1622 -1 -3 163
NULL 1 NULL 168
1714 -2 1 174
NULL -1 NULL 179
1828 -3 1 182
1861 -1 2 188
1918 1 3 191
1964 3 -1 199
NULL NULL -1 201
2125 -3 2 213
2165 3 -2 216
2226 -1 2 220
2264 3 -1 229
2323 1 -2 234
NULL NULL NULL 239
2476 2 -1 245
NULL -1 -1 NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where b>c
    or (c<=d-2 or c>=d+2)
    or (e>c or e<d)
order by col3,col2,col4,col1;

----
1622 -1 -3 163
1272 4 -3 127
1067 -1 -2 107
2323 1 -2 234
2165 3 -2 216
NULL -1 -1 NULL
2476 2 -1 245
1964 3 -1 199
2264 3 -1 229
NULL NULL -1 201
1325 -4 1 131
1828 -3 1 182
1714 -2 1 174
1226 1 1 121
1371 2 1 138
1411 2 1 142
2125 -3 2 213
1861 -1 2 188
2226 -1 2 220
1918 1 3 191
NULL NULL 3 115
NULL -1 NULL 179
NULL 1 NULL 153
NULL 1 NULL 168
NULL 3 NULL 159
NULL NULL NULL 239

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where (c<=d-2 or c>=d+2)
    or b>c
    or (e>c or e<d)
order by col4,col2,col3,col1;

----
1067 -1 -2 107
NULL NULL 3 115
1226 1 1 121
1272 4 -3 127
1325 -4 1 131
1371 2 1 138
1411 2 1 142
NULL 1 NULL 153
NULL 3 NULL 159
1622 -1 -3 163
NULL 1 NULL 168
1714 -2 1 174
NULL -1 NULL 179
1828 -3 1 182
1861 -1 2 188
1918 1 3 191
1964 3 -1 199
NULL NULL -1 201
2125 -3 2 213
2165 3 -2 216
2226 -1 2 220
2264 3 -1 229
2323 1 -2 234
NULL NULL NULL 239
2476 2 -1 245
NULL -1 -1 NULL

statement query IIII
select a+b*2+c*3+d*4 as col1,
       b-c as col2,
       c-d as col3,
       a as col4
from t1
where (c<=d-2 or c>=d+2)
    or b>c
    or (e>c or e<d)
order by col4,col1,col3,col2;

----
1067 -1 -2 107
NULL NULL 3 115
1226 1 1 121
1272 4 -3 127
1325 -4 1 131
1371 2 1 138
1411 2 1 142
NULL 1 NULL 153
NULL 3 NULL 159
1622 -1 -3 163
NULL 1 NULL 168
1714 -2 1 174
NULL -1 NULL 179
1828 -3 1 182
1861 -1 2 188
1918 1 3 191
1964 3 -1 199
NULL NULL -1 201
2125 -3 2 213
2165 3 -2 216
2226 -1 2 220
2264 3 -1 229
2323 1 -2 234
NULL NULL NULL 239
2476 2 -1 245
NULL -1 -1 NULL

statement query IIT
select abs(a) as col1,
       a as col2,
       b-c as col3
from t1
order by col2,col3,col1;

----
104 104 NULL
107 107 -1
115 115 NULL
121 121 1
127 127 4
131 131 -4
138 138 2
142 142 2
149 149 -2
153 153 1
159 159 3
163 163 -1
168 168 1
174 174 -2
179 179 -1
182 182 -3
188 188 -1
191 191 1
199 199 3
201 201 NULL
213 213 -3
216 216 3
220 220 -1
229 229 3
234 234 1
239 239 NULL
243 243 -4
245 245 2
NULL NULL -2
NULL NULL -1

statement query IIT
select abs(a) as col1,
       a as col2,
       b-c as col3
from t1
order by col1,col3,col2;

----
104 104 NULL
107 107 -1
115 115 NULL
121 121 1
127 127 4
131 131 -4
138 138 2
142 142 2
149 149 -2
153 153 1
159 159 3
163 163 -1
168 168 1
174 174 -2
179 179 -1
182 182 -3
188 188 -1
191 191 1
199 199 3
201 201 NULL
213 213 -3
216 216 3
220 220 -1
229 229 3
234 234 1
239 239 NULL
243 243 -4
245 245 2
NULL NULL -2
NULL NULL -1

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
0 698 231 233 230

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where (c<=d-2 or c>=d+2)
   and b>c
   and c between b-2 and d+2
order by col5,col1,col4,col2,col3;

----
0 698 231 233 230

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where b>c
   and (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
0 698 231 233 230

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where b>c
   and (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col5,col1,col3,col4,col2;

----
0 698 231 233 230

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where b>c
   and c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
0 698 231 233 230

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a+b*2 as col2,
       c as col3,
       d as col4,
       e as col5
from t1
where b>c
   and c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
order by col3,col2,col4,col5,col1;

----
0 698 231 233 230

statement query ITTTTI
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(b-c) as col2,
       e as col3,
       d-e as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       c as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
0 NULL NULL NULL NULL 102
0 1 109 -1 1050 106
0 1 110 4 1120 113
0 NULL 117 -1 NULL 119
0 1 NULL NULL 1240 123
0 4 126 2 1290 125
0 4 132 1 1300 134
0 2 135 1 1390 137
0 2 144 -4 1430 141
0 2 146 NULL 1450 147
0 1 NULL NULL 1510 150
0 3 157 NULL 1580 155
0 1 162 2 1600 161
0 1 165 NULL 1670 166
0 2 173 -2 1700 172
0 1 177 NULL 358 176
0 3 180 3 364 184
0 1 189 -4 376 187
0 1 192 -2 382 193
0 3 197 -1 398 195
0 NULL 204 -1 402 202
0 2 NULL NULL NULL 208
0 3 210 2 426 214
0 3 219 -2 432 215
0 1 221 1 440 224
0 3 227 -1 458 225
0 1 230 3 468 231
0 4 NULL NULL 486 244
0 2 246 2 490 247
0 NULL 237 1 2360 NULL

statement query IIIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       abs(b-c) as col2,
       e as col3,
       d-e as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       c as col6
from t1
order by col4,col2,col1,col6,col5,col3;

----
0 1 189 -4 376 187
0 2 144 -4 1430 141
0 1 192 -2 382 193
0 2 173 -2 1700 172
0 3 219 -2 432 215
0 1 109 -1 1050 106
0 3 197 -1 398 195
0 3 227 -1 458 225
0 NULL 117 -1 NULL 119
0 NULL 204 -1 402 202
0 1 221 1 440 224
0 2 135 1 1390 137
0 4 132 1 1300 134
0 NULL 237 1 2360 NULL
0 1 162 2 1600 161
0 2 246 2 490 247
0 3 210 2 426 214
0 4 126 2 1290 125
0 1 230 3 468 231
0 3 180 3 364 184
0 1 110 4 1120 113
0 1 NULL NULL 1240 123
0 1 NULL NULL 1510 150
0 1 165 NULL 1670 166
0 1 177 NULL 358 176
0 2 146 NULL 1450 147
0 2 NULL NULL NULL 208
0 3 157 NULL 1580 155
0 4 NULL NULL 486 244
0 NULL NULL NULL NULL 102

statement query IIIIIII
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or a>b
    or e+d between a+b-10 and c+130
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 107 333 2 1050 1067 109
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-1 163 333 3 1600 1622 162
-2 174 555 4 1700 1714 173
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
2 245 444 -4 490 2476 246
-1 NULL 555 NULL 1120 NULL 110
-2 149 555 4 1450 NULL 146
3 159 555 1 1580 NULL 157
1 168 555 1 1670 NULL 165
-1 179 555 4 358 NULL 177
NULL 239 555 3 2360 NULL 237
1 153 555 2 1510 NULL NULL
-4 243 222 3 486 NULL NULL

statement query IIIIITI
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or a>b
    or e+d between a+b-10 and c+130
order by col5,col3,col6,col7,col4,col2,col1;

----
-1 179 555 4 358 NULL 177
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
-4 243 222 3 486 NULL NULL
2 245 444 -4 490 2476 246
-1 107 333 2 1050 1067 109
-1 NULL 555 NULL 1120 NULL 110
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-2 149 555 4 1450 NULL 146
1 153 555 2 1510 NULL NULL
3 159 555 1 1580 NULL 157
-1 163 333 3 1600 1622 162
1 168 555 1 1670 NULL 165
-2 174 555 4 1700 1714 173
NULL 239 555 3 2360 NULL 237

statement query IIIIIII
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a>b
    or d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 107 333 2 1050 1067 109
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-1 163 333 3 1600 1622 162
-2 174 555 4 1700 1714 173
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
2 245 444 -4 490 2476 246
-1 NULL 555 NULL 1120 NULL 110
-2 149 555 4 1450 NULL 146
3 159 555 1 1580 NULL 157
1 168 555 1 1670 NULL 165
-1 179 555 4 358 NULL 177
NULL 239 555 3 2360 NULL 237
1 153 555 2 1510 NULL NULL
-4 243 222 3 486 NULL NULL

statement query IIIIITI
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or a>b
    or d>e
order by col5,col4,col6,col7,col2,col3,col1;

----
-1 179 555 4 358 NULL 177
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
-4 243 222 3 486 NULL NULL
2 245 444 -4 490 2476 246
-1 107 333 2 1050 1067 109
-1 NULL 555 NULL 1120 NULL 110
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-2 149 555 4 1450 NULL 146
1 153 555 2 1510 NULL NULL
3 159 555 1 1580 NULL 157
-1 163 333 3 1600 1622 162
1 168 555 1 1670 NULL 165
-2 174 555 4 1700 1714 173
NULL 239 555 3 2360 NULL 237

statement query IIIIIII
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or d>e
    or e+d between a+b-10 and c+130
order by col6,col7,col4,col5,col2,col3,col1;

----
-1 107 333 2 1050 1067 109
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-1 163 333 3 1600 1622 162
-2 174 555 4 1700 1714 173
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
2 245 444 -4 490 2476 246
-1 NULL 555 NULL 1120 NULL 110
-2 149 555 4 1450 NULL 146
3 159 555 1 1580 NULL 157
1 168 555 1 1670 NULL 165
-1 179 555 4 358 NULL 177
NULL 239 555 3 2360 NULL 237
1 153 555 2 1510 NULL NULL
-4 243 222 3 486 NULL NULL

statement query IIIIIII
select b-c as col1,
       abs(a) as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a-b as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a+b*2+c*3+d*4 as col6,
       e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where a>b
    or d>e
    or e+d between a+b-10 and c+130
order by col6,col1,col3,col5,col7,col4,col2;

----
-1 107 333 2 1050 1067 109
4 127 333 -2 1290 1272 126
-4 131 444 1 1300 1325 132
2 138 111 -1 1390 1371 135
-1 163 333 3 1600 1622 162
-2 174 555 4 1700 1714 173
-3 182 333 1 364 1828 180
-1 188 444 2 376 1861 189
3 199 555 1 398 1964 197
-3 213 222 2 426 2125 210
-1 220 444 -3 440 2226 221
3 229 555 1 458 2264 227
1 234 555 2 468 2323 230
2 245 444 -4 490 2476 246
-4 243 222 3 486 NULL NULL
-2 149 555 4 1450 NULL 146
-1 179 555 4 358 NULL 177
-1 NULL 555 NULL 1120 NULL 110
1 153 555 2 1510 NULL NULL
1 168 555 1 1670 NULL 165
3 159 555 1 1580 NULL 157
NULL 239 555 3 2360 NULL 237

statement query IIII
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----
-1 0 402 222
2 19 426 222
-2 0 1050 333
-3 3 1290 333
-3 10 1600 333
1 14 364 333
-2 20 432 333
2 15 376 444
3 16 382 444
2 21 440 444
-1 26 490 444
1 0 NULL 555
1 12 1700 555
-1 17 398 555
1 18 NULL 555
-1 22 458 555
-2 23 468 555
NULL 24 2360 555

statement query IIII
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where d not between 110 and 150
    or e+d between a+b-10 and c+130
order by col2,col4,col1,col3;

----
-1 0 402 222
-2 0 1050 333
1 0 NULL 555
-3 3 1290 333
-3 10 1600 333
1 12 1700 555
1 14 364 333
2 15 376 444
3 16 382 444
-1 17 398 555
1 18 NULL 555
2 19 426 222
-2 20 432 333
2 21 440 444
-1 22 458 555
-2 23 468 555
NULL 24 2360 555
-1 26 490 444

statement query IIII
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col4,col2,col3,col1;

----
-1 0 402 222
2 19 426 222
-2 0 1050 333
-3 3 1290 333
-3 10 1600 333
1 14 364 333
-2 20 432 333
2 15 376 444
3 16 382 444
2 21 440 444
-1 26 490 444
1 0 NULL 555
1 12 1700 555
-1 17 398 555
1 18 NULL 555
-1 22 458 555
-2 23 468 555
NULL 24 2360 555

statement query IIII
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where e+d between a+b-10 and c+130
    or d not between 110 and 150
order by col3,col2,col1,col4;

----
1 14 364 333
2 15 376 444
3 16 382 444
-1 17 398 555
-1 0 402 222
2 19 426 222
-2 20 432 333
2 21 440 444
-1 22 458 555
-2 23 468 555
-1 26 490 444
-2 0 1050 333
-3 3 1290 333
-3 10 1600 333
1 12 1700 555
NULL 24 2360 555
1 0 NULL 555
1 18 NULL 555

statement query II
select e as col1,
       b as col2
from t1
order by col2,col1;

----
109 105
110 112
NULL 124
126 129
132 130
135 139
144 143
146 145
NULL 151
157 158
162 160
165 167
173 170
177 175
180 181
189 186
192 194
197 198
NULL 206
210 211
219 218
221 223
227 228
230 232
237 236
NULL 240
246 249
117 NULL
204 NULL
NULL NULL

statement query II
select e as col1,
       b as col2
from t1
order by col1,col2;

----
109 105
110 112
117 NULL
126 129
132 130
135 139
144 143
146 145
157 158
162 160
165 167
173 170
177 175
180 181
189 186
192 194
197 198
204 NULL
210 211
219 218
221 223
227 228
230 232
237 236
246 249
NULL 124
NULL 151
NULL 206
NULL 240
NULL NULL

statement query IIIIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(a) as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5,
       a+b*2+c*3 as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
106 0 107 0 1067 635
123 0 121 2 1226 738
125 0 127 3 1272 760
134 0 131 4 1325 793
137 0 138 5 1371 827
141 0 142 6 1411 851
147 0 149 7 NULL 880
150 0 153 8 NULL 905
155 0 159 9 NULL 940
161 0 163 10 1622 966
166 0 168 11 NULL 1000
172 0 174 12 1714 1030
176 0 179 13 NULL 1057
184 0 182 14 1828 1096
187 0 188 15 1861 1121
193 0 191 16 1918 1158
195 0 199 17 1964 1180
214 0 213 19 2125 1277
215 0 216 20 2165 1297
224 0 220 21 2226 1338
225 0 229 22 2264 1360
231 0 234 23 2323 1391
244 0 243 25 NULL 1455
247 0 245 26 2476 1484
102 0 104 0 NULL NULL
119 0 115 0 NULL NULL
202 0 201 0 NULL NULL
113 0 NULL 1 NULL NULL
208 0 NULL 18 NULL NULL
NULL 0 239 24 NULL NULL

statement query IIIIII
select c as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       abs(a) as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5,
       a+b*2+c*3 as col6
from t1
order by col5,col1,col2,col3,col6,col4;

----
106 0 107 0 1067 635
123 0 121 2 1226 738
125 0 127 3 1272 760
134 0 131 4 1325 793
137 0 138 5 1371 827
141 0 142 6 1411 851
161 0 163 10 1622 966
172 0 174 12 1714 1030
184 0 182 14 1828 1096
187 0 188 15 1861 1121
193 0 191 16 1918 1158
195 0 199 17 1964 1180
214 0 213 19 2125 1277
215 0 216 20 2165 1297
224 0 220 21 2226 1338
225 0 229 22 2264 1360
231 0 234 23 2323 1391
247 0 245 26 2476 1484
102 0 104 0 NULL NULL
113 0 NULL 1 NULL NULL
119 0 115 0 NULL NULL
147 0 149 7 NULL 880
150 0 153 8 NULL 905
155 0 159 9 NULL 940
166 0 168 11 NULL 1000
176 0 179 13 NULL 1057
202 0 201 0 NULL NULL
208 0 NULL 18 NULL NULL
244 0 243 25 NULL 1455
NULL 0 239 24 NULL NULL

statement query IIIIII
select c-d as col1,
       c as col2,
       d as col3,
       a-b as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       b-c as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
1 134 133 1 1985 -4
NULL 244 NULL 3 NULL -4
1 184 183 1 2728 -3
2 214 212 2 3175 -3
1 172 171 4 2579 -2
NULL 147 NULL 4 NULL -2
1 208 207 NULL NULL -2
2 224 222 -3 3331 -1
-2 106 108 2 1612 -1
2 187 185 2 2806 -1
-3 161 164 3 2432 -1
NULL 176 NULL 4 NULL -1
-1 113 114 NULL NULL -1
3 193 190 -3 2878 1
1 123 122 -3 NULL 1
NULL 166 NULL 1 NULL 1
-2 231 233 2 3473 1
NULL 150 NULL 2 NULL 1
-1 247 248 -4 3706 2
1 137 136 -1 2046 2
1 141 140 -1 2131 2
-2 215 217 -2 3260 3
-1 195 196 1 2949 3
-1 225 226 1 3399 3
NULL 155 NULL 1 NULL 3
-3 125 128 -2 1902 4
NULL NULL 238 3 NULL NULL
1 102 101 NULL NULL NULL
3 119 116 NULL NULL NULL
-1 202 203 NULL NULL NULL

statement query IIIIII
select c-d as col1,
       c as col2,
       d as col3,
       a-b as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       b-c as col6
from t1
order by col5,col2,col4,col1,col6,col3;

----
-2 106 108 2 1612 -1
-3 125 128 -2 1902 4
1 134 133 1 1985 -4
1 137 136 -1 2046 2
1 141 140 -1 2131 2
-3 161 164 3 2432 -1
1 172 171 4 2579 -2
1 184 183 1 2728 -3
2 187 185 2 2806 -1
3 193 190 -3 2878 1
-1 195 196 1 2949 3
2 214 212 2 3175 -3
-2 215 217 -2 3260 3
2 224 222 -3 3331 -1
-1 225 226 1 3399 3
-2 231 233 2 3473 1
-1 247 248 -4 3706 2
1 102 101 NULL NULL NULL
-1 113 114 NULL NULL -1
3 119 116 NULL NULL NULL
1 123 122 -3 NULL 1
NULL 147 NULL 4 NULL -2
NULL 150 NULL 2 NULL 1
NULL 155 NULL 1 NULL 3
NULL 166 NULL 1 NULL 1
NULL 176 NULL 4 NULL -1
-1 202 203 NULL NULL NULL
1 208 207 NULL NULL -2
NULL 244 NULL 3 NULL -4
NULL NULL 238 3 NULL NULL

statement query II
select a as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
    or b>c
order by col2,col1;

----
131 -4
182 -3
213 -3
107 -1
163 -1
188 -1
220 -1
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
199 3
216 3
229 3
127 4
115 NULL

statement query II
select a as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
    or b>c
order by col1,col2;

----
107 -1
115 NULL
121 1
127 4
131 -4
138 2
142 2
153 1
159 3
163 -1
168 1
182 -3
188 -1
191 1
199 3
213 -3
216 3
220 -1
229 3
234 1
245 2

statement query II
select a as col1,
       b-c as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
order by col2,col1;

----
131 -4
182 -3
213 -3
107 -1
163 -1
188 -1
220 -1
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
199 3
216 3
229 3
127 4
115 NULL

statement query II
select a as col1,
       b-c as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
    or (c<=d-2 or c>=d+2)
order by col2,col1;

----
131 -4
182 -3
213 -3
107 -1
163 -1
188 -1
220 -1
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
199 3
216 3
229 3
127 4
115 NULL

statement query II
select a as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
    or (c<=d-2 or c>=d+2)
order by col2,col1;

----
131 -4
182 -3
213 -3
107 -1
163 -1
188 -1
220 -1
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
199 3
216 3
229 3
127 4
115 NULL

statement query II
select a as col1,
       b-c as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
    or (c<=d-2 or c>=d+2)
order by col1,col2;

----
107 -1
115 NULL
121 1
127 4
131 -4
138 2
142 2
153 1
159 3
163 -1
168 1
182 -3
188 -1
191 1
199 3
213 -3
216 3
220 -1
229 3
234 1
245 2

statement query III
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3
from t1
where (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1;

----
-1 1 1120
-3 3 1290
1 4 1300
1 5 1390
1 6 1430
NULL 9 1580
-3 10 1600
1 12 1700
NULL 13 358
1 14 364
2 15 376
-1 17 398
2 19 426
-2 20 432
2 21 440
-1 22 458
-2 23 468
NULL 24 2360
-1 26 490

statement query III
select c-d as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3
from t1
where (e>c or e<d)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1,col3;

----
-1 1 1120
-3 3 1290
1 4 1300
1 5 1390
1 6 1430
NULL 9 1580
-3 10 1600
1 12 1700
NULL 13 358
1 14 364
2 15 376
-1 17 398
2 19 426
-2 20 432
2 21 440
-1 22 458
-2 23 468
NULL 24 2360
-1 26 490

statement query skipped
elect a+b*2 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3
from t1
where (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col2,col3,col1;

----

statement query skipped
elect a+b*2 as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3
from t1
where (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col1,col3,col2;

----

statement query skipped
elect c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3,
       c-d as col4,
       d as col5,
       abs(b-c) as col6
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3,
       c-d as col4,
       d as col5,
       abs(b-c) as col6
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
order by col1,col3,col6,col4,col5,col2;

----

statement query skipped
elect c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3,
       c-d as col4,
       d as col5,
       abs(b-c) as col6
from t1
where (a>b-2 and a<b+2)
   and (c<=d-2 or c>=d+2)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect c as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3,
       c-d as col4,
       d as col5,
       abs(b-c) as col6
from t1
where (a>b-2 and a<b+2)
   and (c<=d-2 or c>=d+2)
order by col2,col6,col1,col4,col5,col3;

----

statement query IIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or d not between 110 and 150
    or (e>c or e<d)
order by col4,col2,col3,col1;

----
125 1290 1272 -3
161 1600 1622 -3
215 432 2165 -2
231 468 2323 -2
106 1050 1067 -2
195 398 1964 -1
202 402 NULL -1
225 458 2264 -1
247 490 2476 -1
113 1120 NULL -1
184 364 1828 1
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
172 1700 1714 1
102 NULL NULL 1
208 NULL NULL 1
187 376 1861 2
214 426 2125 2
224 440 2226 2
193 382 1918 3
176 358 NULL NULL
155 1580 NULL NULL
NULL 2360 NULL NULL

statement query IITT
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or d not between 110 and 150
    or (e>c or e<d)
order by col2,col4,col3,col1;

----
176 358 NULL NULL
184 364 1828 1
187 376 1861 2
193 382 1918 3
195 398 1964 -1
202 402 NULL -1
214 426 2125 2
215 432 2165 -2
224 440 2226 2
225 458 2264 -1
231 468 2323 -2
247 490 2476 -1
106 1050 1067 -2
113 1120 NULL -1
125 1290 1272 -3
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
155 1580 NULL NULL
161 1600 1622 -3
172 1700 1714 1
NULL 2360 NULL NULL
102 NULL NULL 1
208 NULL NULL 1

statement query IIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or (e>a and e<b)
    or d not between 110 and 150
order by col4,col2,col3,col1;

----
125 1290 1272 -3
161 1600 1622 -3
215 432 2165 -2
231 468 2323 -2
106 1050 1067 -2
195 398 1964 -1
202 402 NULL -1
225 458 2264 -1
247 490 2476 -1
113 1120 NULL -1
184 364 1828 1
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
172 1700 1714 1
102 NULL NULL 1
208 NULL NULL 1
187 376 1861 2
214 426 2125 2
224 440 2226 2
193 382 1918 3
176 358 NULL NULL
155 1580 NULL NULL
NULL 2360 NULL NULL

statement query ITTI
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or (e>a and e<b)
    or d not between 110 and 150
order by col1,col3,col2,col4;

----
102 NULL NULL 1
106 1050 1067 -2
113 1120 NULL -1
125 1290 1272 -3
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
155 1580 NULL NULL
161 1600 1622 -3
172 1700 1714 1
176 358 NULL NULL
184 364 1828 1
187 376 1861 2
193 382 1918 3
195 398 1964 -1
202 402 NULL -1
208 NULL NULL 1
214 426 2125 2
215 432 2165 -2
224 440 2226 2
225 458 2264 -1
231 468 2323 -2
247 490 2476 -1
NULL 2360 NULL NULL

statement query IIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or d not between 110 and 150
    or (e>a and e<b)
order by col4,col2,col3,col1;

----
125 1290 1272 -3
161 1600 1622 -3
215 432 2165 -2
231 468 2323 -2
106 1050 1067 -2
195 398 1964 -1
202 402 NULL -1
225 458 2264 -1
247 490 2476 -1
113 1120 NULL -1
184 364 1828 1
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
172 1700 1714 1
102 NULL NULL 1
208 NULL NULL 1
187 376 1861 2
214 426 2125 2
224 440 2226 2
193 382 1918 3
176 358 NULL NULL
155 1580 NULL NULL
NULL 2360 NULL NULL

statement query IITT
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
    or d not between 110 and 150
    or (e>a and e<b)
order by col2,col3,col4,col1;

----
176 358 NULL NULL
184 364 1828 1
187 376 1861 2
193 382 1918 3
195 398 1964 -1
202 402 NULL -1
214 426 2125 2
215 432 2165 -2
224 440 2226 2
225 458 2264 -1
231 468 2323 -2
247 490 2476 -1
106 1050 1067 -2
113 1120 NULL -1
125 1290 1272 -3
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
155 1580 NULL NULL
161 1600 1622 -3
172 1700 1714 1
NULL 2360 NULL NULL
102 NULL NULL 1
208 NULL NULL 1

statement query IIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or (e>c or e<d)
    or d not between 110 and 150
order by col4,col2,col3,col1;

----
125 1290 1272 -3
161 1600 1622 -3
215 432 2165 -2
231 468 2323 -2
106 1050 1067 -2
195 398 1964 -1
202 402 NULL -1
225 458 2264 -1
247 490 2476 -1
113 1120 NULL -1
184 364 1828 1
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
172 1700 1714 1
102 NULL NULL 1
208 NULL NULL 1
187 376 1861 2
214 426 2125 2
224 440 2226 2
193 382 1918 3
176 358 NULL NULL
155 1580 NULL NULL
NULL 2360 NULL NULL

statement query IIII
select c as col1,
       case when c>avg_c then a*2 else b*10 end as col2,
       a+b*2+c*3+d*4 as col3,
       c-d as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>a and e<b)
    or (e>c or e<d)
    or d not between 110 and 150
order by col4,col1,col2,col3;

----
125 1290 1272 -3
161 1600 1622 -3
106 1050 1067 -2
215 432 2165 -2
231 468 2323 -2
113 1120 NULL -1
195 398 1964 -1
202 402 NULL -1
225 458 2264 -1
247 490 2476 -1
102 NULL NULL 1
134 1300 1325 1
137 1390 1371 1
141 1430 1411 1
172 1700 1714 1
184 364 1828 1
208 NULL NULL 1
187 376 1861 2
214 426 2125 2
224 440 2226 2
193 382 1918 3
155 1580 NULL NULL
176 358 NULL NULL
NULL 2360 NULL NULL

statement query I
select b as col1
from t1
where d>e
    or (e>c or e<d)
order by col1;

----
105
112
129
130
139
143
158
160
170
175
181
186
198
211
218
223
228
232
236
249
NULL

statement query I
select b as col1
from t1
where d>e
    or (e>c or e<d)
order by col1;

----
105
112
129
130
139
143
158
160
170
175
181
186
198
211
218
223
228
232
236
249
NULL

statement query I
select b as col1
from t1
where (e>c or e<d)
    or d>e
order by col1;

----
105
112
129
130
139
143
158
160
170
175
181
186
198
211
218
223
228
232
236
249
NULL

statement query I
select b as col1
from t1
where (e>c or e<d)
    or d>e
order by col1;

----
105
112
129
130
139
143
158
160
170
175
181
186
198
211
218
223
228
232
236
249
NULL

statement query III
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case when c>avg_c then a*2 else b*10 end as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col3,col1;

----
245 111 490
191 222 382
216 222 432
220 222 440
121 222 1240
127 222 1290
138 222 1390
142 222 1430
182 333 364
188 333 376
199 333 398
213 333 426
229 333 458
234 333 468
107 333 1050
131 333 1300
153 333 1510
159 333 1580
168 333 1670
179 444 358
201 444 402
243 444 486
NULL 444 1120
149 444 1450
163 444 1600
174 444 1700
239 444 2360
104 444 NULL
115 444 NULL
NULL 444 NULL

statement query IIT
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       case when c>avg_c then a*2 else b*10 end as col3
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col1,col2,col3;

----
104 444 NULL
107 333 1050
115 444 NULL
121 222 1240
127 222 1290
131 333 1300
138 222 1390
142 222 1430
149 444 1450
153 333 1510
159 333 1580
163 444 1600
168 333 1670
174 444 1700
179 444 358
182 333 364
188 333 376
191 222 382
199 333 398
201 444 402
213 333 426
216 222 432
220 222 440
229 333 458
234 333 468
239 444 2360
243 444 486
245 111 490
NULL 444 1120
NULL 444 NULL

statement query ITTI
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       a as col4
from t1
where a>b
    or c>d
    or e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----
102 NULL NULL 104
106 1612 -1 107
119 NULL NULL 115
123 NULL 1 121
125 1902 4 127
134 1985 -4 131
137 2046 2 138
141 2131 2 142
147 NULL -2 149
150 NULL 1 153
155 NULL 3 159
161 2432 -1 163
166 NULL 1 168
172 2579 -2 174
176 NULL -1 179
184 2728 -3 182
187 2806 -1 188
193 2878 1 191
195 2949 3 199
214 3175 -3 213
224 3331 -1 220
225 3399 3 229
231 3473 1 234
NULL NULL NULL 239
244 NULL -4 243
208 NULL -2 NULL

statement query ITTI
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       a as col4
from t1
where a>b
    or c>d
    or e+d between a+b-10 and c+130
order by col4,col3,col2,col1;

----
102 NULL NULL 104
106 1612 -1 107
119 NULL NULL 115
123 NULL 1 121
125 1902 4 127
134 1985 -4 131
137 2046 2 138
141 2131 2 142
147 NULL -2 149
150 NULL 1 153
155 NULL 3 159
161 2432 -1 163
166 NULL 1 168
172 2579 -2 174
176 NULL -1 179
184 2728 -3 182
187 2806 -1 188
193 2878 1 191
195 2949 3 199
214 3175 -3 213
224 3331 -1 220
225 3399 3 229
231 3473 1 234
NULL NULL NULL 239
244 NULL -4 243
208 NULL -2 NULL

statement query ITTI
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       a as col4
from t1
where a>b
    or e+d between a+b-10 and c+130
    or c>d
order by col4,col2,col3,col1;

----
102 NULL NULL 104
106 1612 -1 107
119 NULL NULL 115
123 NULL 1 121
125 1902 4 127
134 1985 -4 131
137 2046 2 138
141 2131 2 142
147 NULL -2 149
150 NULL 1 153
155 NULL 3 159
161 2432 -1 163
166 NULL 1 168
172 2579 -2 174
176 NULL -1 179
184 2728 -3 182
187 2806 -1 188
193 2878 1 191
195 2949 3 199
214 3175 -3 213
224 3331 -1 220
225 3399 3 229
231 3473 1 234
NULL NULL NULL 239
244 NULL -4 243
208 NULL -2 NULL

statement query IIII
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       b-c as col3,
       a as col4
from t1
where a>b
    or e+d between a+b-10 and c+130
    or c>d
order by col3,col1,col4,col2;

----
134 1985 -4 131
244 NULL -4 243
184 2728 -3 182
214 3175 -3 213
147 NULL -2 149
172 2579 -2 174
208 NULL -2 NULL
106 1612 -1 107
161 2432 -1 163
176 NULL -1 179
187 2806 -1 188
224 3331 -1 220
123 NULL 1 121
150 NULL 1 153
166 NULL 1 168
193 2878 1 191
231 3473 1 234
137 2046 2 138
141 2131 2 142
155 NULL 3 159
195 2949 3 199
225 3399 3 229
125 1902 4 127
102 NULL NULL 104
119 NULL NULL 115
NULL NULL NULL 239

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2,
       b-c as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
   and d not between 110 and 150
order by col4,col2,col3,col1;

----
0 -2 1 1918
0 -1 3 1964
0 -2 3 2165
0 -1 3 2264
0 3 1 2323
0 2 2 2476

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2,
       b-c as col3,
       a+b*2+c*3+d*4 as col4
from t1
where b>c
   and d not between 110 and 150
order by col1,col4,col2,col3;

----
0 -2 1 1918
0 -1 3 1964
0 -2 3 2165
0 -1 3 2264
0 3 1 2323
0 2 2 2476

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2,
       b-c as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d not between 110 and 150
   and b>c
order by col4,col2,col3,col1;

----
0 -2 1 1918
0 -1 3 1964
0 -2 3 2165
0 -1 3 2264
0 3 1 2323
0 2 2 2476

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d-e as col2,
       b-c as col3,
       a+b*2+c*3+d*4 as col4
from t1
where d not between 110 and 150
   and b>c
order by col2,col1,col4,col3;

----
0 -2 1 1918
0 -2 3 2165
0 -1 3 1964
0 -1 3 2264
0 2 2 2476
0 3 1 2323

statement query IF
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (a+b+c+d+e)/5 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
1290 127.0
1300 132.0
1390 137.0
1430 142.0
1600 162.0
1700 172.0
364 182.0
376 187.0
382 192.0
398 197.0
426 212.0
432 217.0
440 222.0
458 227.0
468 232.0
490 247.0
358 NULL
486 NULL
1120 NULL
1240 NULL
1450 NULL
1510 NULL
1580 NULL
1670 NULL
2360 NULL
NULL NULL

statement query IF
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       (a+b+c+d+e)/5 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
1290 127.0
1300 132.0
1390 137.0
1430 142.0
1600 162.0
1700 172.0
364 182.0
376 187.0
382 192.0
398 197.0
426 212.0
432 217.0
440 222.0
458 227.0
468 232.0
490 247.0
358 NULL
486 NULL
1120 NULL
1240 NULL
1450 NULL
1510 NULL
1580 NULL
1670 NULL
2360 NULL
NULL NULL

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2+c*3+d*4 as col4,
       b as col5
from t1
order by col4,col5,col2,col3,col1;

----
-2 1612 333 1067 105
1 NULL 333 1226 124
-3 1902 333 1272 129
1 1985 444 1325 130
1 2046 111 1371 139
1 2131 111 1411 143
-3 2432 333 1622 160
1 2579 555 1714 170
1 2728 333 1828 181
2 2806 444 1861 186
3 2878 444 1918 194
-1 2949 555 1964 198
2 3175 222 2125 211
-2 3260 333 2165 218
2 3331 444 2226 223
-1 3399 555 2264 228
-2 3473 555 2323 232
-1 3706 444 2476 249
-1 NULL 555 NULL 112
NULL NULL 555 NULL 145
NULL NULL 555 NULL 151
NULL NULL 555 NULL 158
NULL NULL 555 NULL 167
NULL NULL 555 NULL 175
1 NULL 555 NULL 206
NULL NULL 555 NULL 236
NULL NULL 222 NULL 240
-1 NULL 222 NULL NULL
3 NULL 333 NULL NULL
1 NULL 555 NULL NULL

statement query IIIII
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       a+b*2+c*3+d*4 as col4,
       b as col5
from t1
order by col3,col5,col4,col2,col1;

----
1 2046 111 1371 139
1 2131 111 1411 143
2 3175 222 2125 211
NULL NULL 222 NULL 240
-1 NULL 222 NULL NULL
-2 1612 333 1067 105
1 NULL 333 1226 124
-3 1902 333 1272 129
-3 2432 333 1622 160
1 2728 333 1828 181
-2 3260 333 2165 218
3 NULL 333 NULL NULL
1 1985 444 1325 130
2 2806 444 1861 186
3 2878 444 1918 194
2 3331 444 2226 223
-1 3706 444 2476 249
-1 NULL 555 NULL 112
NULL NULL 555 NULL 145
NULL NULL 555 NULL 151
NULL NULL 555 NULL 158
NULL NULL 555 NULL 167
1 2579 555 1714 170
NULL NULL 555 NULL 175
-1 2949 555 1964 198
1 NULL 555 NULL 206
-1 3399 555 2264 228
-2 3473 555 2323 232
NULL NULL 555 NULL 236
1 NULL 555 NULL NULL

statement query II
select d-e as col1,
       c-d as col2
from t1
where (e>c or e<d)
   and d not between 110 and 150
order by col2,col1;

----
2 -3
-2 -2
-1 -2
3 -2
-1 -1
-1 -1
-1 -1
2 -1
-2 1
3 1
-4 2
1 2
2 2
1 NULL

statement query II
select d-e as col1,
       c-d as col2
from t1
where (e>c or e<d)
   and d not between 110 and 150
order by col2,col1;

----
2 -3
-2 -2
-1 -2
3 -2
-1 -1
-1 -1
-1 -1
2 -1
-2 1
3 1
-4 2
1 2
2 2
1 NULL

statement query II
select d-e as col1,
       c-d as col2
from t1
where d not between 110 and 150
   and (e>c or e<d)
order by col2,col1;

----
2 -3
-2 -2
-1 -2
3 -2
-1 -1
-1 -1
-1 -1
2 -1
-2 1
3 1
-4 2
1 2
2 2
1 NULL

statement query II
select d-e as col1,
       c-d as col2
from t1
where d not between 110 and 150
   and (e>c or e<d)
order by col2,col1;

----
2 -3
-2 -2
-1 -2
3 -2
-1 -1
-1 -1
-1 -1
2 -1
-2 1
3 1
-4 2
1 2
2 2
1 NULL

statement query IIIF
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4
from t1
where d>e
    or (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
125 1902 2 127.0
134 1985 1 132.0
137 2046 1 137.0
141 2131 -4 142.0
161 2432 2 162.0
184 2728 3 182.0
195 2949 -1 197.0
214 3175 2 212.0
224 3331 1 222.0
225 3399 -1 227.0
231 3473 3 232.0
247 3706 2 247.0
NULL NULL 1 NULL
113 NULL 4 NULL
155 NULL NULL NULL
166 NULL NULL NULL

statement query IIIF
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4
from t1
where d>e
    or (a>b-2 and a<b+2)
order by col3,col1,col2,col4;

----
141 2131 -4 142.0
195 2949 -1 197.0
225 3399 -1 227.0
134 1985 1 132.0
137 2046 1 137.0
224 3331 1 222.0
NULL NULL 1 NULL
125 1902 2 127.0
161 2432 2 162.0
214 3175 2 212.0
247 3706 2 247.0
184 2728 3 182.0
231 3473 3 232.0
113 NULL 4 NULL
155 NULL NULL NULL
166 NULL NULL NULL

statement query IIIF
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4
from t1
where (a>b-2 and a<b+2)
    or d>e
order by col4,col2,col3,col1;

----
125 1902 2 127.0
134 1985 1 132.0
137 2046 1 137.0
141 2131 -4 142.0
161 2432 2 162.0
184 2728 3 182.0
195 2949 -1 197.0
214 3175 2 212.0
224 3331 1 222.0
225 3399 -1 227.0
231 3473 3 232.0
247 3706 2 247.0
NULL NULL 1 NULL
113 NULL 4 NULL
155 NULL NULL NULL
166 NULL NULL NULL

statement query IIIF
select c as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       d-e as col3,
       (a+b+c+d+e)/5 as col4
from t1
where (a>b-2 and a<b+2)
    or d>e
order by col3,col1,col4,col2;

----
141 2131 -4 142.0
195 2949 -1 197.0
225 3399 -1 227.0
134 1985 1 132.0
137 2046 1 137.0
224 3331 1 222.0
NULL NULL 1 NULL
125 1902 2 127.0
161 2432 2 162.0
214 3175 2 212.0
247 3706 2 247.0
184 2728 3 182.0
231 3473 3 232.0
113 NULL 4 NULL
155 NULL NULL NULL
166 NULL NULL NULL

statement query IIFIII
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       e as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or d>e
order by col6,col4,col5,col2,col3,col1;

----
108 1612 107.0 109 1050 107
128 1902 127.0 126 1290 127
133 1985 132.0 132 1300 131
136 2046 137.0 135 1390 138
164 2432 162.0 162 1600 163
183 2728 182.0 180 364 182
212 3175 212.0 210 426 213
222 3331 222.0 221 440 220
233 3473 232.0 230 468 234
238 NULL NULL 237 2360 239
248 3706 247.0 246 490 245
114 NULL NULL 110 1120 NULL

statement query IIFIII
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       e as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where e+d between a+b-10 and c+130
    or d>e
order by col5,col6,col3,col4,col1,col2;

----
183 2728 182.0 180 364 182
212 3175 212.0 210 426 213
222 3331 222.0 221 440 220
233 3473 232.0 230 468 234
248 3706 247.0 246 490 245
108 1612 107.0 109 1050 107
114 NULL NULL 110 1120 NULL
128 1902 127.0 126 1290 127
133 1985 132.0 132 1300 131
136 2046 137.0 135 1390 138
164 2432 162.0 162 1600 163
238 NULL NULL 237 2360 239

statement query IIFIII
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       e as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
108 1612 107.0 109 1050 107
128 1902 127.0 126 1290 127
133 1985 132.0 132 1300 131
136 2046 137.0 135 1390 138
164 2432 162.0 162 1600 163
183 2728 182.0 180 364 182
212 3175 212.0 210 426 213
222 3331 222.0 221 440 220
233 3473 232.0 230 468 234
238 NULL NULL 237 2360 239
248 3706 247.0 246 490 245
114 NULL NULL 110 1120 NULL

statement query IIFIII
select d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       (a+b+c+d+e)/5 as col3,
       e as col4,
       case when c>avg_c then a*2 else b*10 end as col5,
       a as col6
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or e+d between a+b-10 and c+130
order by col2,col5,col4,col3,col6,col1;

----
108 1612 107.0 109 1050 107
128 1902 127.0 126 1290 127
133 1985 132.0 132 1300 131
136 2046 137.0 135 1390 138
164 2432 162.0 162 1600 163
183 2728 182.0 180 364 182
212 3175 212.0 210 426 213
222 3331 222.0 221 440 220
233 3473 232.0 230 468 234
248 3706 247.0 246 490 245
114 NULL NULL 110 1120 NULL
238 NULL NULL 237 2360 239

statement query skipped
elect e as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       abs(a) as col5,
       d as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       abs(a) as col5,
       d as col6,
       b-c as col7
from t1
where (c<=d-2 or c>=d+2)
   and (a>b-2 and a<b+2)
order by col5,col1,col7,col6,col4,col3,col2;

----

statement query skipped
elect e as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       abs(a) as col5,
       d as col6,
       b-c as col7
from t1
where (a>b-2 and a<b+2)
   and (c<=d-2 or c>=d+2)
order by col6,col7,col4,col5,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       c-d as col4,
       abs(a) as col5,
       d as col6,
       b-c as col7
from t1
where (a>b-2 and a<b+2)
   and (c<=d-2 or c>=d+2)
order by col2,col3,col1,col5,col4,col6,col7;

----

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       c-d as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
order by col4,col2,col3,col1;

----
0 -1 -2 1067
3 4 -3 1272
4 -4 1 1325
5 2 1 1371
6 2 1 1411
10 -1 -3 1622
12 -2 1 1714
14 -3 1 1828
15 -1 2 1861
17 3 -1 1964
19 -3 2 2125
20 3 -2 2165
21 -1 2 2226
22 3 -1 2264
23 1 -2 2323
26 2 -1 2476
1 -1 -1 NULL
13 -1 NULL NULL
9 3 NULL NULL
0 NULL -1 NULL
24 NULL NULL NULL

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       b-c as col2,
       c-d as col3,
       a+b*2+c*3+d*4 as col4
from t1
where (e>c or e<d)
order by col1,col4,col3,col2;

----
0 -1 -2 1067
0 NULL -1 NULL
1 -1 -1 NULL
3 4 -3 1272
4 -4 1 1325
5 2 1 1371
6 2 1 1411
9 3 NULL NULL
10 -1 -3 1622
12 -2 1 1714
13 -1 NULL NULL
14 -3 1 1828
15 -1 2 1861
17 3 -1 1964
19 -3 2 2125
20 3 -2 2165
21 -1 2 2226
22 3 -1 2264
23 1 -2 2323
24 NULL NULL NULL
26 2 -1 2476

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
order by col2,col3,col1;

----
555 104 0
333 107 0
333 115 0
333 121 2
333 127 3
444 131 4
111 138 5
111 142 6
555 149 7
555 153 8
555 159 9
333 163 10
555 168 11
555 174 12
555 179 13
333 182 14
444 188 15
444 191 16
555 199 17
222 201 0
222 213 19
333 216 20
444 220 21
555 229 22
555 234 23
555 239 24
222 243 25
444 245 26
555 NULL 1
555 NULL 18

statement query III
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       a as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3
from t1
order by col3,col2,col1;

----
555 104 0
333 107 0
333 115 0
222 201 0
555 NULL 1
333 121 2
333 127 3
444 131 4
111 138 5
111 142 6
555 149 7
555 153 8
555 159 9
333 163 10
555 168 11
555 174 12
555 179 13
333 182 14
444 188 15
444 191 16
555 199 17
555 NULL 18
222 213 19
333 216 20
444 220 21
555 229 22
555 234 23
555 239 24
222 243 25
444 245 26

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
   and a>b
   and (e>c or e<d)
order by col4,col2,col3,col1;

----
105 1067 0 333
130 1325 0 333
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333
160 1622 0 444
170 1714 0 444

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
   and a>b
   and (e>c or e<d)
order by col2,col4,col3,col1;

----
105 1067 0 333
130 1325 0 333
160 1622 0 444
170 1714 0 444
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and a>b
order by col4,col2,col3,col1;

----
105 1067 0 333
130 1325 0 333
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333
160 1622 0 444
170 1714 0 444

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
   and (e>c or e<d)
   and a>b
order by col2,col3,col1,col4;

----
105 1067 0 333
130 1325 0 333
160 1622 0 444
170 1714 0 444
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where a>b
   and (e>c or e<d)
   and c between b-2 and d+2
order by col4,col2,col3,col1;

----
105 1067 0 333
130 1325 0 333
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333
160 1622 0 444
170 1714 0 444

statement query IIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where a>b
   and (e>c or e<d)
   and c between b-2 and d+2
order by col2,col1,col3,col4;

----
105 1067 0 333
130 1325 0 333
160 1622 0 444
170 1714 0 444
181 1828 0 333
186 1861 0 333
211 2125 0 333
232 2323 0 333

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       abs(b-c) as col4
from t1
where (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
11 502 555 1
5 416 111 2
6 428 111 2
9 475 555 3
14 544 333 3
17 595 555 3
22 685 555 3
4 391 444 4

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2 as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3,
       abs(b-c) as col4
from t1
where (a>b-2 and a<b+2)
order by col2,col1,col4,col3;

----
4 391 444 4
5 416 111 2
6 428 111 2
9 475 555 3
11 502 555 1
14 544 333 3
17 595 555 3
22 685 555 3

statement query IIIII
select c as col1,
       c-d as col2,
       a-b as col3,
       a+b*2+c*3 as col4,
       abs(a) as col5
from t1
order by col4,col5,col2,col3,col1;

----
106 -2 2 635 107
123 1 -3 738 121
125 -3 -2 760 127
134 1 1 793 131
137 1 -1 827 138
141 1 -1 851 142
147 NULL 4 880 149
150 NULL 2 905 153
155 NULL 1 940 159
161 -3 3 966 163
166 NULL 1 1000 168
172 1 4 1030 174
176 NULL 4 1057 179
184 1 1 1096 182
187 2 2 1121 188
193 3 -3 1158 191
195 -1 1 1180 199
214 2 2 1277 213
215 -2 -2 1297 216
224 2 -3 1338 220
225 -1 1 1360 229
231 -2 2 1391 234
244 NULL 3 1455 243
247 -1 -4 1484 245
102 1 NULL NULL 104
119 3 NULL NULL 115
202 -1 NULL NULL 201
NULL NULL 3 NULL 239
113 -1 NULL NULL NULL
208 1 NULL NULL NULL

statement query IITTI
select c as col1,
       c-d as col2,
       a-b as col3,
       a+b*2+c*3 as col4,
       abs(a) as col5
from t1
order by col5,col3,col2,col4,col1;

----
102 1 NULL NULL 104
106 -2 2 635 107
119 3 NULL NULL 115
123 1 -3 738 121
125 -3 -2 760 127
134 1 1 793 131
137 1 -1 827 138
141 1 -1 851 142
147 NULL 4 880 149
150 NULL 2 905 153
155 NULL 1 940 159
161 -3 3 966 163
166 NULL 1 1000 168
172 1 4 1030 174
176 NULL 4 1057 179
184 1 1 1096 182
187 2 2 1121 188
193 3 -3 1158 191
195 -1 1 1180 199
202 -1 NULL NULL 201
214 2 2 1277 213
215 -2 -2 1297 216
224 2 -3 1338 220
225 -1 1 1360 229
231 -2 2 1391 234
NULL NULL 3 NULL 239
244 NULL 3 1455 243
247 -1 -4 1484 245
113 -1 NULL NULL NULL
208 1 NULL NULL NULL

statement query TITTTII
select b as col1,
       abs(a) as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       a as col6,
       c as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
NULL 104 NULL NULL NULL 104 102
105 107 317 1050 -1 107 106
129 127 385 1290 2 127 125
130 131 391 1300 1 131 134
139 138 416 1390 1 138 137
160 163 483 1600 2 163 161
170 174 514 1700 -2 174 172
181 182 544 364 3 182 184
186 188 560 376 -4 188 187
194 191 579 382 -2 191 193
198 199 595 398 -1 199 195
NULL 201 NULL 402 -1 201 202
211 213 635 426 2 213 214
218 216 652 432 -2 216 215
223 220 666 440 1 220 224
228 229 685 458 -1 229 225
232 234 698 468 3 234 231
236 239 711 2360 1 239 NULL
249 245 743 490 2 245 247
112 NULL NULL 1120 4 NULL 113
206 NULL NULL NULL NULL NULL 208

statement query IIIIIII
select b as col1,
       abs(a) as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       a as col6,
       c as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d not between 110 and 150
    or d>e
order by col5,col2,col1,col7,col3,col4,col6;

----
186 188 560 376 -4 188 187
170 174 514 1700 -2 174 172
194 191 579 382 -2 191 193
218 216 652 432 -2 216 215
105 107 317 1050 -1 107 106
198 199 595 398 -1 199 195
NULL 201 NULL 402 -1 201 202
228 229 685 458 -1 229 225
130 131 391 1300 1 131 134
139 138 416 1390 1 138 137
223 220 666 440 1 220 224
236 239 711 2360 1 239 NULL
129 127 385 1290 2 127 125
160 163 483 1600 2 163 161
211 213 635 426 2 213 214
249 245 743 490 2 245 247
181 182 544 364 3 182 184
232 234 698 468 3 234 231
112 NULL NULL 1120 4 NULL 113
NULL 104 NULL NULL NULL 104 102
206 NULL NULL NULL NULL NULL 208

statement query TITTTII
select b as col1,
       abs(a) as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       a as col6,
       c as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or d not between 110 and 150
order by col6,col7,col4,col5,col2,col3,col1;

----
NULL 104 NULL NULL NULL 104 102
105 107 317 1050 -1 107 106
129 127 385 1290 2 127 125
130 131 391 1300 1 131 134
139 138 416 1390 1 138 137
160 163 483 1600 2 163 161
170 174 514 1700 -2 174 172
181 182 544 364 3 182 184
186 188 560 376 -4 188 187
194 191 579 382 -2 191 193
198 199 595 398 -1 199 195
NULL 201 NULL 402 -1 201 202
211 213 635 426 2 213 214
218 216 652 432 -2 216 215
223 220 666 440 1 220 224
228 229 685 458 -1 229 225
232 234 698 468 3 234 231
236 239 711 2360 1 239 NULL
249 245 743 490 2 245 247
112 NULL NULL 1120 4 NULL 113
206 NULL NULL NULL NULL NULL 208

statement query IIIIIII
select b as col1,
       abs(a) as col2,
       a+b*2 as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       d-e as col5,
       a as col6,
       c as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
    or d not between 110 and 150
order by col5,col4,col6,col7,col2,col3,col1;

----
186 188 560 376 -4 188 187
194 191 579 382 -2 191 193
218 216 652 432 -2 216 215
170 174 514 1700 -2 174 172
198 199 595 398 -1 199 195
NULL 201 NULL 402 -1 201 202
228 229 685 458 -1 229 225
105 107 317 1050 -1 107 106
223 220 666 440 1 220 224
130 131 391 1300 1 131 134
139 138 416 1390 1 138 137
236 239 711 2360 1 239 NULL
211 213 635 426 2 213 214
249 245 743 490 2 245 247
129 127 385 1290 2 127 125
160 163 483 1600 2 163 161
181 182 544 364 3 182 184
232 234 698 468 3 234 231
112 NULL NULL 1120 4 NULL 113
NULL 104 NULL NULL NULL 104 102
206 NULL NULL NULL NULL NULL 208

statement query I
select c-d as col1
from t1
order by col1;

----
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
1
1
1
1
2
2
2
3
3
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select c-d as col1
from t1
order by col1;

----
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
1
1
1
1
2
2
2
3
3
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIIIIIT
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       b-c as col4,
       a+b*2 as col5,
       a as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
order by col6,col7,col4,col5,col2,col3,col1;

----
123 2 1240 1 369 121 NULL
125 3 1290 4 385 127 127.0
137 5 1390 2 416 138 137.0
141 6 1430 2 428 142 142.0
150 8 1510 1 455 153 NULL
155 9 1580 3 475 159 NULL
166 11 1670 1 502 168 NULL
193 16 382 1 579 191 192.0
195 17 398 3 595 199 197.0
215 20 432 3 652 216 217.0
225 22 458 3 685 229 227.0
231 23 468 1 698 234 232.0
247 26 490 2 743 245 247.0

statement query IIIIIIT
select c as col1,
       (select count(*) from t1 as x where x.b<t1.b) as col2,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col3,
       b-c as col4,
       a+b*2 as col5,
       a as col6,
       (a+b+c+d+e)/5 as col7
from t1
where b>c
order by col1,col4,col2,col6,col7,col3,col5;

----
123 2 1240 1 369 121 NULL
125 3 1290 4 385 127 127.0
137 5 1390 2 416 138 137.0
141 6 1430 2 428 142 142.0
150 8 1510 1 455 153 NULL
155 9 1580 3 475 159 NULL
166 11 1670 1 502 168 NULL
193 16 382 1 579 191 192.0
195 17 398 3 595 199 197.0
215 20 432 3 652 216 217.0
225 22 458 3 685 229 227.0
231 23 468 1 698 234 232.0
247 26 490 2 743 245 247.0

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       e as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
order by col2,col1;

----
1120 110
1290 126
1300 132
1390 135
1600 162
364 180
426 210
440 221
468 230
2360 237
490 246

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       e as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where d>e
order by col1,col2;

----
364 180
426 210
440 221
468 230
490 246
1120 110
1290 126
1300 132
1390 135
1600 162
2360 237

statement query FI
select (a+b+c+d+e)/5 as col1,
       a-b as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
247.0 -4
192.0 -3
222.0 -3
NULL -3
127.0 -2
217.0 -2
137.0 -1
142.0 -1
132.0 1
182.0 1
197.0 1
227.0 1
NULL 1
NULL 1
187.0 2
212.0 2
232.0 2
NULL 2
162.0 3
NULL 3
NULL 3
172.0 4
NULL 4
NULL 4
NULL NULL
NULL NULL

statement query FI
select (a+b+c+d+e)/5 as col1,
       a-b as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
127.0 -2
132.0 1
137.0 -1
142.0 -1
162.0 3
172.0 4
182.0 1
187.0 2
192.0 -3
197.0 1
212.0 2
217.0 -2
222.0 -3
227.0 1
232.0 2
247.0 -4
NULL -3
NULL 1
NULL 1
NULL 2
NULL 3
NULL 3
NULL 4
NULL 4
NULL NULL
NULL NULL

statement query TIII
select abs(b-c) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       c as col4
from t1
order by col4,col2,col3,col1;

----
NULL 444 0 102
1 333 0 106
1 444 0 113
NULL 444 0 119
1 222 0 123
4 222 0 125
4 333 0 134
2 222 0 137
2 222 0 141
2 444 0 147
1 333 0 150
3 333 0 155
1 444 0 161
1 333 0 166
2 444 0 172
1 444 0 176
3 333 0 184
1 333 0 187
1 222 0 193
3 333 0 195
NULL 444 0 202
2 444 0 208
3 333 0 214
3 222 0 215
1 222 0 224
3 333 0 225
1 333 0 231
4 444 0 244
2 111 0 247
NULL 444 0 NULL

statement query IIII
select abs(b-c) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       c as col4
from t1
order by col3,col1,col4,col2;

----
1 333 0 106
1 444 0 113
1 222 0 123
1 333 0 150
1 444 0 161
1 333 0 166
1 444 0 176
1 333 0 187
1 222 0 193
1 222 0 224
1 333 0 231
2 222 0 137
2 222 0 141
2 444 0 147
2 444 0 172
2 444 0 208
2 111 0 247
3 333 0 155
3 333 0 184
3 333 0 195
3 333 0 214
3 222 0 215
3 333 0 225
4 222 0 125
4 333 0 134
4 444 0 244
NULL 444 0 102
NULL 444 0 119
NULL 444 0 202
NULL 444 0 NULL

statement query IIIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2 as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       c-d as col5
from t1
where b>c
    or c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
5 416 138 111 1
6 428 142 111 1
19 635 213 222 2
3 385 127 333 -3
10 483 163 333 -3
0 317 107 333 -2
20 652 216 333 -2
2 369 121 333 1
14 544 182 333 1
26 743 245 444 -1
4 391 131 444 1
15 560 188 444 2
21 666 220 444 2
16 579 191 444 3
23 698 234 555 -2
17 595 199 555 -1
22 685 229 555 -1
1 NULL NULL 555 -1
12 514 174 555 1
18 NULL NULL 555 1
8 455 153 555 NULL
9 475 159 555 NULL
11 502 168 555 NULL

