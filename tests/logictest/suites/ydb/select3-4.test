statement ok
drop table if exists t1 all;

statement ok
create table t1(a integer null, b integer null, c integer null, d integer null, e integer null);

statement ok
insert into t1(e,c,b,d,a) values(null,102,null,101,104);

statement ok
insert into t1(a,c,d,e,b) values(107,106,108,109,105);

statement ok
insert into t1(e,d,b,a,c) values(110,114,112,null,113);

statement ok
insert into t1(d,c,e,a,b) values(116,119,117,115,null);

statement ok
insert into t1(c,d,b,e,a) values(123,122,124,null,121);

statement ok
insert into t1(a,d,b,e,c) values(127,128,129,126,125);

statement ok
insert into t1(e,c,a,d,b) values(132,134,131,133,130);

statement ok
insert into t1(a,d,b,e,c) values(138,136,139,135,137);

statement ok
insert into t1(e,c,d,a,b) values(144,141,140,142,143);

statement ok
insert into t1(b,a,e,d,c) values(145,149,146,null,147);

statement ok
insert into t1(b,c,a,d,e) values(151,150,153,null,null);

statement ok
insert into t1(c,e,a,d,b) values(155,157,159,null,158);

statement ok
insert into t1(c,b,a,d,e) values(161,160,163,164,162);

statement ok
insert into t1(b,d,a,e,c) values(167,null,168,165,166);

statement ok
insert into t1(d,b,c,e,a) values(171,170,172,173,174);

statement ok
insert into t1(e,c,a,d,b) values(177,176,179,null,175);

statement ok
insert into t1(b,e,a,d,c) values(181,180,182,183,184);

statement ok
insert into t1(c,a,b,e,d) values(187,188,186,189,185);

statement ok
insert into t1(d,b,c,e,a) values(190,194,193,192,191);

statement ok
insert into t1(a,e,b,d,c) values(199,197,198,196,195);

statement ok
insert into t1(b,c,d,a,e) values(null,202,203,201,204);

statement ok
insert into t1(c,e,a,b,d) values(208,null,null,206,207);

statement ok
insert into t1(c,e,a,d,b) values(214,210,213,212,211);

statement ok
insert into t1(b,c,a,d,e) values(218,215,216,217,219);

statement ok
insert into t1(b,e,d,a,c) values(223,221,222,220,224);

statement ok
insert into t1(d,e,b,a,c) values(226,227,228,229,225);

statement ok
insert into t1(a,c,b,e,d) values(234,231,232,230,233);

statement ok
insert into t1(e,b,a,c,d) values(237,236,239,null,238);

statement ok
insert into t1(e,c,b,a,d) values(null,244,240,243,null);

statement ok
insert into t1(e,d,c,b,a) values(246,248,247,249,245);

statement query TTTI
select a+b*2+c*3+d*4 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       e as col3,
       abs(a) as col4
from t1
order by col4,col2,col3,col1;

----
NULL NULL NULL 104
1067 1612 109 107
NULL NULL 117 115
1226 NULL NULL 121
1272 1902 126 127
1325 1985 132 131
1371 2046 135 138
1411 2131 144 142
NULL NULL 146 149
NULL NULL NULL 153
NULL NULL 157 159
1622 2432 162 163
NULL NULL 165 168
1714 2579 173 174
NULL NULL 177 179
1828 2728 180 182
1861 2806 189 188
1918 2878 192 191
1964 2949 197 199
NULL NULL 204 201
2125 3175 210 213
2165 3260 219 216
2226 3331 221 220
2264 3399 227 229
2323 3473 230 234
NULL NULL 237 239
NULL NULL NULL 243
2476 3706 246 245
NULL NULL 110 NULL
NULL NULL NULL NULL

statement query IIIFII
select c as col1,
       a as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       a-b as col5,
       a+b*2+c*3 as col6
from t1
where c>d
    or (e>c or e<d)
order by col6,col4,col5,col2,col3,col1;

----
106 107 0 107.0 2 635
123 121 0 NULL -3 738
125 127 0 127.0 -2 760
134 131 0 132.0 1 793
137 138 0 137.0 -1 827
141 142 0 142.0 -1 851
155 159 0 NULL 1 940
161 163 0 162.0 3 966
172 174 0 172.0 4 1030
176 179 0 NULL 4 1057
184 182 0 182.0 1 1096
187 188 0 187.0 2 1121
193 191 0 192.0 -3 1158
195 199 0 197.0 1 1180
214 213 0 212.0 2 1277
215 216 0 217.0 -2 1297
224 220 0 222.0 -3 1338
225 229 0 227.0 1 1360
231 234 0 232.0 2 1391
247 245 0 247.0 -4 1484
NULL 239 0 NULL 3 NULL
102 104 0 NULL NULL NULL
119 115 0 NULL NULL NULL
202 201 0 NULL NULL NULL
113 NULL 0 NULL NULL NULL
208 NULL 0 NULL NULL NULL

statement query IIITTT
select c as col1,
       a as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       a-b as col5,
       a+b*2+c*3 as col6
from t1
where c>d
    or (e>c or e<d)
order by col1,col2,col6,col5,col4,col3;

----
102 104 0 NULL NULL NULL
106 107 0 107.0 2 635
113 NULL 0 NULL NULL NULL
119 115 0 NULL NULL NULL
123 121 0 NULL -3 738
125 127 0 127.0 -2 760
134 131 0 132.0 1 793
137 138 0 137.0 -1 827
141 142 0 142.0 -1 851
155 159 0 NULL 1 940
161 163 0 162.0 3 966
172 174 0 172.0 4 1030
176 179 0 NULL 4 1057
184 182 0 182.0 1 1096
187 188 0 187.0 2 1121
193 191 0 192.0 -3 1158
195 199 0 197.0 1 1180
202 201 0 NULL NULL NULL
208 NULL 0 NULL NULL NULL
214 213 0 212.0 2 1277
215 216 0 217.0 -2 1297
224 220 0 222.0 -3 1338
225 229 0 227.0 1 1360
231 234 0 232.0 2 1391
247 245 0 247.0 -4 1484
NULL 239 0 NULL 3 NULL

statement query IIIFII
select c as col1,
       a as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       a-b as col5,
       a+b*2+c*3 as col6
from t1
where (e>c or e<d)
    or c>d
order by col6,col4,col5,col2,col3,col1;

----
106 107 0 107.0 2 635
123 121 0 NULL -3 738
125 127 0 127.0 -2 760
134 131 0 132.0 1 793
137 138 0 137.0 -1 827
141 142 0 142.0 -1 851
155 159 0 NULL 1 940
161 163 0 162.0 3 966
172 174 0 172.0 4 1030
176 179 0 NULL 4 1057
184 182 0 182.0 1 1096
187 188 0 187.0 2 1121
193 191 0 192.0 -3 1158
195 199 0 197.0 1 1180
214 213 0 212.0 2 1277
215 216 0 217.0 -2 1297
224 220 0 222.0 -3 1338
225 229 0 227.0 1 1360
231 234 0 232.0 2 1391
247 245 0 247.0 -4 1484
NULL 239 0 NULL 3 NULL
102 104 0 NULL NULL NULL
119 115 0 NULL NULL NULL
202 201 0 NULL NULL NULL
113 NULL 0 NULL NULL NULL
208 NULL 0 NULL NULL NULL

statement query IIIFII
select c as col1,
       a as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       (a+b+c+d+e)/5 as col4,
       a-b as col5,
       a+b*2+c*3 as col6
from t1
where (e>c or e<d)
    or c>d
order by col5,col3,col6,col1,col4,col2;

----
247 245 0 247.0 -4 1484
123 121 0 NULL -3 738
193 191 0 192.0 -3 1158
224 220 0 222.0 -3 1338
125 127 0 127.0 -2 760
215 216 0 217.0 -2 1297
137 138 0 137.0 -1 827
141 142 0 142.0 -1 851
134 131 0 132.0 1 793
155 159 0 NULL 1 940
184 182 0 182.0 1 1096
195 199 0 197.0 1 1180
225 229 0 227.0 1 1360
106 107 0 107.0 2 635
187 188 0 187.0 2 1121
214 213 0 212.0 2 1277
231 234 0 232.0 2 1391
161 163 0 162.0 3 966
NULL 239 0 NULL 3 NULL
172 174 0 172.0 4 1030
176 179 0 NULL 4 1057
102 104 0 NULL NULL NULL
113 NULL 0 NULL NULL NULL
119 115 0 NULL NULL NULL
202 201 0 NULL NULL NULL
208 NULL 0 NULL NULL NULL

statement query I
select d-e as col1
from t1
where b>c
    or (c<=d-2 or c>=d+2)
order by col1;

----
-4
-4
-2
-2
-1
-1
-1
-1
1
1
2
2
2
2
3
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where b>c
    or (c<=d-2 or c>=d+2)
order by col1;

----
-4
-4
-2
-2
-1
-1
-1
-1
1
1
2
2
2
2
3
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where (c<=d-2 or c>=d+2)
    or b>c
order by col1;

----
-4
-4
-2
-2
-1
-1
-1
-1
1
1
2
2
2
2
3
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where (c<=d-2 or c>=d+2)
    or b>c
order by col1;

----
-4
-4
-2
-2
-1
-1
-1
-1
1
1
2
2
2
2
3
NULL
NULL
NULL
NULL

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and (c<=d-2 or c>=d+2)
order by col6,col4,col5,col2,col3,col1;

----
-3 127 4 129 1272 125
-3 163 -1 160 1622 161
2 213 -3 211 2125 214
2 220 -1 223 2226 224
-2 234 1 232 2323 231

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and (c<=d-2 or c>=d+2)
order by col4,col3,col6,col5,col2,col1;

----
-3 127 4 129 1272 125
-3 163 -1 160 1622 161
2 213 -3 211 2125 214
2 220 -1 223 2226 224
-2 234 1 232 2323 231

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
order by col6,col4,col5,col2,col3,col1;

----
-3 127 4 129 1272 125
-3 163 -1 160 1622 161
2 213 -3 211 2125 214
2 220 -1 223 2226 224
-2 234 1 232 2323 231

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
order by col3,col4,col5,col6,col2,col1;

----
2 213 -3 211 2125 214
-3 163 -1 160 1622 161
2 220 -1 223 2226 224
-2 234 1 232 2323 231
-3 127 4 129 1272 125

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where d>e
   and (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col4,col5,col2,col3,col1;

----
-3 127 4 129 1272 125
-3 163 -1 160 1622 161
2 213 -3 211 2125 214
2 220 -1 223 2226 224
-2 234 1 232 2323 231

statement query IIIIII
select c-d as col1,
       abs(a) as col2,
       b-c as col3,
       b as col4,
       a+b*2+c*3+d*4 as col5,
       c as col6
from t1
where d>e
   and (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col1,col4,col5,col2,col3;

----
-3 127 4 129 1272 125
-3 163 -1 160 1622 161
2 213 -3 211 2125 214
2 220 -1 223 2226 224
-2 234 1 232 2323 231

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       c-d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
3 212 2 0 -3
1 108 -2 0 -1
1 164 -3 0 -1
1 185 2 0 -1
1 222 2 0 -1
1 190 3 0 1
1 233 -2 0 1
3 217 -2 0 3
4 128 -3 0 4
NULL 116 3 0 NULL

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       c-d as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       b-c as col5
from t1
where (c<=d-2 or c>=d+2)
order by col2,col5,col1,col4,col3;

----
1 108 -2 0 -1
NULL 116 3 0 NULL
4 128 -3 0 4
1 164 -3 0 -1
1 185 2 0 -1
1 190 3 0 1
3 212 2 0 -3
3 217 -2 0 3
1 222 2 0 -1
1 233 -2 0 1

statement query ITITTIT
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c as col3,
       abs(b-c) as col4,
       e as col5,
       d as col6,
       d-e as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col6,col7,col4,col5,col2,col3,col1;

----
1 NULL 102 NULL NULL 101 NULL
-1 NULL 113 1 110 114 4
3 NULL 119 NULL 117 116 -1
1 NULL 123 1 NULL 122 NULL
-3 1902 125 4 126 128 2
1 1985 134 4 132 133 1
1 2046 137 2 135 136 1
1 2131 141 2 144 140 -4
-3 2432 161 1 162 164 2
1 2579 172 2 173 171 -2
1 2728 184 3 180 183 3
2 2806 187 1 189 185 -4
3 2878 193 1 192 190 -2
-1 2949 195 3 197 196 -1
1 NULL 208 2 NULL 207 NULL
2 3175 214 3 210 212 2
-2 3260 215 3 219 217 -2
2 3331 224 1 221 222 1
-1 3399 225 3 227 226 -1
-2 3473 231 1 230 233 3
NULL NULL NULL NULL 237 238 1
-1 3706 247 2 246 248 2
NULL NULL 166 1 165 NULL NULL
NULL NULL 176 1 177 NULL NULL
NULL NULL 150 1 NULL NULL NULL
NULL NULL 147 2 146 NULL NULL
NULL NULL 155 3 157 NULL NULL
NULL NULL 244 4 NULL NULL NULL

statement query ITITTIT
select c-d as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c as col3,
       abs(b-c) as col4,
       e as col5,
       d as col6,
       d-e as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col3,col4,col5,col2,col6,col7,col1;

----
1 NULL 102 NULL NULL 101 NULL
-1 NULL 113 1 110 114 4
3 NULL 119 NULL 117 116 -1
1 NULL 123 1 NULL 122 NULL
-3 1902 125 4 126 128 2
1 1985 134 4 132 133 1
1 2046 137 2 135 136 1
1 2131 141 2 144 140 -4
NULL NULL 147 2 146 NULL NULL
NULL NULL 150 1 NULL NULL NULL
NULL NULL 155 3 157 NULL NULL
-3 2432 161 1 162 164 2
NULL NULL 166 1 165 NULL NULL
1 2579 172 2 173 171 -2
NULL NULL 176 1 177 NULL NULL
1 2728 184 3 180 183 3
2 2806 187 1 189 185 -4
3 2878 193 1 192 190 -2
-1 2949 195 3 197 196 -1
1 NULL 208 2 NULL 207 NULL
2 3175 214 3 210 212 2
-2 3260 215 3 219 217 -2
2 3331 224 1 221 222 1
-1 3399 225 3 227 226 -1
-2 3473 231 1 230 233 3
NULL NULL 244 4 NULL NULL NULL
-1 3706 247 2 246 248 2
NULL NULL NULL NULL 237 238 1

statement query FIIIII
select (a+b+c+d+e)/5 as col1,
       d-e as col2,
       a-b as col3,
       abs(a) as col4,
       b as col5,
       b-c as col6
from t1
where c between b-2 and d+2
order by col6,col4,col5,col2,col3,col1;

----
132.0 1 1 131 130 -4
182.0 3 1 182 181 -3
212.0 2 2 213 211 -3
172.0 -2 4 174 170 -2
NULL NULL NULL NULL 206 -2
107.0 -1 2 107 105 -1
162.0 2 3 163 160 -1
187.0 -4 2 188 186 -1
222.0 1 -3 220 223 -1
NULL 4 NULL NULL 112 -1
NULL NULL -3 121 124 1
232.0 3 2 234 232 1
137.0 1 -1 138 139 2
142.0 -4 -1 142 143 2
247.0 2 -4 245 249 2

statement query FIIIII
select (a+b+c+d+e)/5 as col1,
       d-e as col2,
       a-b as col3,
       abs(a) as col4,
       b as col5,
       b-c as col6
from t1
where c between b-2 and d+2
order by col4,col6,col1,col5,col2,col3;

----
107.0 -1 2 107 105 -1
NULL NULL -3 121 124 1
132.0 1 1 131 130 -4
137.0 1 -1 138 139 2
142.0 -4 -1 142 143 2
162.0 2 3 163 160 -1
172.0 -2 4 174 170 -2
182.0 3 1 182 181 -3
187.0 -4 2 188 186 -1
212.0 2 2 213 211 -3
222.0 1 -3 220 223 -1
232.0 3 2 234 232 1
247.0 2 -4 245 249 2
NULL NULL NULL NULL 206 -2
NULL 4 NULL NULL 112 -1

statement query F
select (a+b+c+d+e)/5 as col1
from t1
order by col1;

----
107.0
127.0
132.0
137.0
142.0
162.0
172.0
182.0
187.0
192.0
197.0
212.0
217.0
222.0
227.0
232.0
247.0
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query F
select (a+b+c+d+e)/5 as col1
from t1
order by col1;

----
107.0
127.0
132.0
137.0
142.0
162.0
172.0
182.0
187.0
192.0
197.0
212.0
217.0
222.0
227.0
232.0
247.0
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIIIII
select d as col1,
       c-d as col2,
       c as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       a-b as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
248 -1 247 26 490 -4
122 1 123 2 1240 -3
190 3 193 16 382 -3
222 2 224 21 440 -3
128 -3 125 3 1290 -2
217 -2 215 20 432 -2
136 1 137 5 1390 -1
140 1 141 6 1430 -1
133 1 134 4 1300 1
NULL NULL 155 9 1580 1
NULL NULL 166 11 1670 1
183 1 184 14 364 1
196 -1 195 17 398 1
226 -1 225 22 458 1
108 -2 106 0 1050 2
NULL NULL 150 8 1510 2
185 2 187 15 376 2
212 2 214 19 426 2
233 -2 231 23 468 2
164 -3 161 10 1600 3
238 NULL NULL 24 2360 3
NULL NULL 244 25 486 3
NULL NULL 147 7 1450 4
171 1 172 12 1700 4
NULL NULL 176 13 358 4
203 -1 202 0 402 NULL
101 1 102 0 NULL NULL
116 3 119 0 NULL NULL
114 -1 113 1 1120 NULL
207 1 208 18 NULL NULL

statement query IIIIII
select d as col1,
       c-d as col2,
       c as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col5,
       a-b as col6
from t1
order by col2,col5,col3,col1,col4,col6;

----
128 -3 125 3 1290 -2
164 -3 161 10 1600 3
217 -2 215 20 432 -2
233 -2 231 23 468 2
108 -2 106 0 1050 2
196 -1 195 17 398 1
203 -1 202 0 402 NULL
226 -1 225 22 458 1
248 -1 247 26 490 -4
114 -1 113 1 1120 NULL
183 1 184 14 364 1
122 1 123 2 1240 -3
133 1 134 4 1300 1
136 1 137 5 1390 -1
140 1 141 6 1430 -1
171 1 172 12 1700 4
101 1 102 0 NULL NULL
207 1 208 18 NULL NULL
185 2 187 15 376 2
212 2 214 19 426 2
222 2 224 21 440 -3
190 3 193 16 382 -3
116 3 119 0 NULL NULL
NULL NULL 176 13 358 4
NULL NULL 244 25 486 3
NULL NULL 147 7 1450 4
NULL NULL 150 8 1510 2
NULL NULL 155 9 1580 1
NULL NULL 166 11 1670 1
238 NULL NULL 24 2360 3

statement query II
select abs(a) as col1,
       abs(b-c) as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col2,col1;

----
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
182 3
199 3
216 3
229 3
127 4
131 4

statement query II
select abs(a) as col1,
       abs(b-c) as col2
from t1
where (a>b-2 and a<b+2)
    or b>c
order by col2,col1;

----
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
182 3
199 3
216 3
229 3
127 4
131 4

statement query II
select abs(a) as col1,
       abs(b-c) as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col1;

----
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
182 3
199 3
216 3
229 3
127 4
131 4

statement query II
select abs(a) as col1,
       abs(b-c) as col2
from t1
where b>c
    or (a>b-2 and a<b+2)
order by col2,col1;

----
121 1
153 1
168 1
191 1
234 1
138 2
142 2
245 2
159 3
182 3
199 3
216 3
229 3
127 4
131 4

statement query IIIII
select e as col1,
       c as col2,
       abs(b-c) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
189 187 1 0 -4
192 193 1 0 -2
219 215 3 0 -2
109 106 1 0 -1
117 119 NULL 0 -1
221 224 1 0 1
126 125 4 0 2
162 161 1 0 2
210 214 3 0 2
230 231 1 0 3

statement query IIIII
select e as col1,
       c as col2,
       abs(b-c) as col3,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col4,
       d-e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col3,col1,col4,col5,col2;

----
109 106 1 0 -1
162 161 1 0 2
189 187 1 0 -4
192 193 1 0 -2
221 224 1 0 1
230 231 1 0 3
210 214 3 0 2
219 215 3 0 -2
126 125 4 0 2
117 119 NULL 0 -1

statement query III
select c as col1,
       a+b*2 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where (c<=d-2 or c>=d+2)
order by col2,col3,col1;

----
106 317 333
125 385 222
161 483 444
187 560 333
193 579 222
214 635 333
215 652 222
224 666 222
231 698 333
119 NULL 444

statement query III
select c as col1,
       a+b*2 as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3
from t1
where (c<=d-2 or c>=d+2)
order by col3,col2,col1;

----
125 385 222
193 579 222
215 652 222
224 666 222
106 317 333
187 560 333
214 635 333
231 698 333
161 483 444
119 NULL 444

statement query IIII
select c-d as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where c>d
order by col4,col2,col3,col1;

----
1 -4 0 111
1 1 0 111
2 2 0 222
3 -1 0 333
1 3 0 333
1 NULL 0 333
2 -4 0 444
3 -2 0 444
1 1 0 444
2 1 0 444
1 -2 0 555
1 NULL 0 555
1 NULL 0 555

statement query IIII
select c-d as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where c>d
order by col3,col1,col2,col4;

----
1 -4 0 111
1 -2 0 555
1 1 0 111
1 1 0 444
1 3 0 333
1 NULL 0 333
1 NULL 0 555
1 NULL 0 555
2 -4 0 444
2 1 0 444
2 2 0 222
3 -2 0 444
3 -1 0 333

statement query TITTIIT
select b as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b-c as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a as col5,
       abs(a) as col6,
       d-e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col6,col7,col4,col5,col2,col3,col1;

----
NULL 555 NULL NULL 104 104 NULL
105 333 -1 1050 107 107 -1
NULL 333 NULL NULL 115 115 -1
124 333 1 1240 121 121 NULL
129 333 4 1290 127 127 2
130 444 -4 1300 131 131 1
139 111 2 1390 138 138 1
143 111 2 1430 142 142 -4
145 555 -2 1450 149 149 NULL
151 555 1 1510 153 153 NULL
158 555 3 1580 159 159 NULL
160 333 -1 1600 163 163 2
167 555 1 1670 168 168 NULL
170 555 -2 1700 174 174 -2
175 555 -1 358 179 179 NULL
181 333 -3 364 182 182 3
186 444 -1 376 188 188 -4
194 444 1 382 191 191 -2
198 555 3 398 199 199 -1
NULL 222 NULL 402 201 201 -1
211 222 -3 426 213 213 2
218 333 3 432 216 216 -2
223 444 -1 440 220 220 1
228 555 3 458 229 229 -1
232 555 1 468 234 234 3
236 555 NULL 2360 239 239 1
240 222 -4 486 243 243 NULL
249 444 2 490 245 245 2
112 555 -1 1120 NULL NULL 4
206 555 -2 NULL NULL NULL NULL

statement query TITTIIT
select b as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       b-c as col3,
       case when c>avg_c then a*2 else b*10 end as col4,
       a as col5,
       abs(a) as col6,
       d-e as col7
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col5,col4,col2,col7,col3,col6,col1;

----
NULL 555 NULL NULL 104 104 NULL
105 333 -1 1050 107 107 -1
NULL 333 NULL NULL 115 115 -1
124 333 1 1240 121 121 NULL
129 333 4 1290 127 127 2
130 444 -4 1300 131 131 1
139 111 2 1390 138 138 1
143 111 2 1430 142 142 -4
145 555 -2 1450 149 149 NULL
151 555 1 1510 153 153 NULL
158 555 3 1580 159 159 NULL
160 333 -1 1600 163 163 2
167 555 1 1670 168 168 NULL
170 555 -2 1700 174 174 -2
175 555 -1 358 179 179 NULL
181 333 -3 364 182 182 3
186 444 -1 376 188 188 -4
194 444 1 382 191 191 -2
198 555 3 398 199 199 -1
NULL 222 NULL 402 201 201 -1
211 222 -3 426 213 213 2
218 333 3 432 216 216 -2
223 444 -1 440 220 220 1
228 555 3 458 229 229 -1
232 555 1 468 234 234 3
236 555 NULL 2360 239 239 1
240 222 -4 486 243 243 NULL
249 444 2 490 245 245 2
112 555 -1 1120 NULL NULL 4
206 555 -2 NULL NULL NULL NULL

statement query I
select a as col1
from t1
where (c<=d-2 or c>=d+2)
order by col1;

----
107
115
127
163
188
191
213
216
220
234

statement query I
select a as col1
from t1
where (c<=d-2 or c>=d+2)
order by col1;

----
107
115
127
163
188
191
213
216
220
234

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
1 105
1 112
1 124
4 129
4 130
2 139
2 143
2 145
1 151
3 158
1 160
1 167
2 170
1 175
3 181
1 186
1 194
3 198
2 206
3 211
3 218
1 223
3 228
1 232
NULL 236
4 240
2 249
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where c between b-2 and d+2
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
1 105
1 112
1 124
1 151
1 160
1 167
1 175
1 186
1 194
1 223
1 232
2 139
2 143
2 145
2 170
2 206
2 249
3 158
3 181
3 198
3 211
3 218
3 228
4 129
4 130
4 240
NULL 236
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col2,col1;

----
1 105
1 112
1 124
4 129
4 130
2 139
2 143
2 145
1 151
3 158
1 160
1 167
2 170
1 175
3 181
1 186
1 194
3 198
2 206
3 211
3 218
1 223
3 228
1 232
NULL 236
4 240
2 249
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col2,col1;

----
1 105
1 112
1 124
4 129
4 130
2 139
2 143
2 145
1 151
3 158
1 160
1 167
2 170
1 175
3 181
1 186
1 194
3 198
2 206
3 211
3 218
1 223
3 228
1 232
NULL 236
4 240
2 249
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
1 105
1 112
1 124
4 129
4 130
2 139
2 143
2 145
1 151
3 158
1 160
1 167
2 170
1 175
3 181
1 186
1 194
3 198
2 206
3 211
3 218
1 223
3 228
1 232
NULL 236
4 240
2 249
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where (a>b-2 and a<b+2)
    or c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
1 105
1 112
1 124
1 151
1 160
1 167
1 175
1 186
1 194
1 223
1 232
2 139
2 143
2 145
2 170
2 206
2 249
3 158
3 181
3 198
3 211
3 218
3 228
4 129
4 130
4 240
NULL 236
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col2,col1;

----
1 105
1 112
1 124
4 129
4 130
2 139
2 143
2 145
1 151
3 158
1 160
1 167
2 170
1 175
3 181
1 186
1 194
3 198
2 206
3 211
3 218
1 223
3 228
1 232
NULL 236
4 240
2 249
NULL NULL
NULL NULL

statement query II
select abs(b-c) as col1,
       b as col2
from t1
where c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
    or (a>b-2 and a<b+2)
order by col1,col2;

----
1 105
1 112
1 124
1 151
1 160
1 167
1 175
1 186
1 194
1 223
1 232
2 139
2 143
2 145
2 170
2 206
2 249
3 158
3 181
3 198
3 211
3 218
3 228
4 129
4 130
4 240
NULL 236
NULL NULL
NULL NULL

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
   and (e>a and e<b)
order by col4,col2,col3,col1;

----

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
   and (e>a and e<b)
order by col3,col4,col2,col1;

----

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
order by col1,col3,col4,col2;

----

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a as col2,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
   and e+d between a+b-10 and c+130
order by col1,col4,col2,col3;

----

statement query IIIII
select abs(a) as col1,
       a-b as col2,
       d as col3,
       a+b*2 as col4,
       c-d as col5
from t1
where (e>c or e<d)
order by col4,col5,col2,col3,col1;

----
107 2 108 317 -2
127 -2 128 385 -3
131 1 133 391 1
138 -1 136 416 1
142 -1 140 428 1
159 1 NULL 475 NULL
163 3 164 483 -3
174 4 171 514 1
179 4 NULL 529 NULL
182 1 183 544 1
188 2 185 560 2
199 1 196 595 -1
213 2 212 635 2
216 -2 217 652 -2
220 -3 222 666 2
229 1 226 685 -1
234 2 233 698 -2
239 3 238 711 NULL
245 -4 248 743 -1
NULL NULL 114 NULL -1
201 NULL 203 NULL -1

statement query IIIII
select abs(a) as col1,
       a-b as col2,
       d as col3,
       a+b*2 as col4,
       c-d as col5
from t1
where (e>c or e<d)
order by col1,col3,col2,col4,col5;

----
107 2 108 317 -2
127 -2 128 385 -3
131 1 133 391 1
138 -1 136 416 1
142 -1 140 428 1
159 1 NULL 475 NULL
163 3 164 483 -3
174 4 171 514 1
179 4 NULL 529 NULL
182 1 183 544 1
188 2 185 560 2
199 1 196 595 -1
201 NULL 203 NULL -1
213 2 212 635 2
216 -2 217 652 -2
220 -3 222 666 2
229 1 226 685 -1
234 2 233 698 -2
239 3 238 711 NULL
245 -4 248 743 -1
NULL NULL 114 NULL -1

statement query III
select d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       d-e as col3
from t1
where b>c
order by col2,col3,col1;

----
140 111 -4
136 111 1
217 333 -2
128 333 2
122 333 NULL
190 444 -2
248 444 2
196 555 -1
226 555 -1
233 555 3
NULL 555 NULL
NULL 555 NULL
NULL 555 NULL

statement query III
select d as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       d-e as col3
from t1
where b>c
order by col3,col2,col1;

----
140 111 -4
217 333 -2
190 444 -2
196 555 -1
226 555 -1
136 111 1
128 333 2
248 444 2
233 555 3
122 333 NULL
NULL 555 NULL
NULL 555 NULL
NULL 555 NULL

statement query IIIII
select e as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a-b as col4,
       c-d as col5
from t1
where (c<=d-2 or c>=d+2)
   and c>d
order by col4,col5,col2,col3,col1;

----
221 440 0 -3 2
192 382 0 -3 3
189 376 0 2 2
210 426 0 2 2
117 NULL 0 NULL 3

statement query IIIII
select e as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a-b as col4,
       c-d as col5
from t1
where (c<=d-2 or c>=d+2)
   and c>d
order by col4,col1,col3,col2,col5;

----
192 382 0 -3 3
221 440 0 -3 2
189 376 0 2 2
210 426 0 2 2
117 NULL 0 NULL 3

statement query IIIIIII
select a as col1,
       d-e as col2,
       c-d as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       abs(a) as col5,
       b-c as col6,
       a+b*2+c*3+d*4 as col7
from t1
where (a>b-2 and a<b+2)
order by col6,col7,col4,col5,col2,col3,col1;

----
131 1 1 4 131 -4 1325
182 3 1 14 182 -3 1828
168 NULL NULL 11 168 1 NULL
138 1 1 5 138 2 1371
142 -4 1 6 142 2 1411
199 -1 -1 17 199 3 1964
229 -1 -1 22 229 3 2264
159 NULL NULL 9 159 3 NULL

statement query IIIIIII
select a as col1,
       d-e as col2,
       c-d as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       abs(a) as col5,
       b-c as col6,
       a+b*2+c*3+d*4 as col7
from t1
where (a>b-2 and a<b+2)
order by col3,col2,col5,col1,col6,col7,col4;

----
199 -1 -1 17 199 3 1964
229 -1 -1 22 229 3 2264
142 -4 1 6 142 2 1411
131 1 1 4 131 -4 1325
138 1 1 5 138 2 1371
182 3 1 14 182 -3 1828
159 NULL NULL 9 159 3 NULL
168 NULL NULL 11 168 1 NULL

statement query IIIIIII
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       d as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       b as col5,
       a-b as col6,
       c-d as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1;

----
2 490 248 26 249 -4 -1
1 1240 122 2 124 -3 1
1 440 222 21 223 -3 2
1 382 190 16 194 -3 3
4 1290 128 3 129 -2 -3
3 432 217 20 218 -2 -2
2 1390 136 5 139 -1 1
2 1430 140 6 143 -1 1
3 398 196 17 198 1 -1
3 458 226 22 228 1 -1
4 1300 133 4 130 1 1
3 364 183 14 181 1 1
3 1580 NULL 9 158 1 NULL
1 1670 NULL 11 167 1 NULL
1 468 233 23 232 2 -2
1 376 185 15 186 2 2
3 426 212 19 211 2 2
1 1510 NULL 8 151 2 NULL
1 1600 164 10 160 3 -3
NULL 2360 238 24 236 3 NULL
4 486 NULL 25 240 3 NULL
2 1700 171 12 170 4 1
2 1450 NULL 7 145 4 NULL
1 358 NULL 13 175 4 NULL
1 1120 114 1 112 NULL -1
2 NULL 207 18 206 NULL 1

statement query IIIIITI
select abs(b-c) as col1,
       case when c>(select avg(c) from t1) then a*2 else b*10 end as col2,
       d as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       b as col5,
       a-b as col6,
       c-d as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col7,col6,col4,col5,col2,col1;

----
1 1120 114 1 112 NULL -1
1 1240 122 2 124 -3 1
4 1290 128 3 129 -2 -3
4 1300 133 4 130 1 1
2 1390 136 5 139 -1 1
2 1430 140 6 143 -1 1
1 1600 164 10 160 3 -3
2 1700 171 12 170 4 1
3 364 183 14 181 1 1
1 376 185 15 186 2 2
1 382 190 16 194 -3 3
3 398 196 17 198 1 -1
2 NULL 207 18 206 NULL 1
3 426 212 19 211 2 2
3 432 217 20 218 -2 -2
1 440 222 21 223 -3 2
3 458 226 22 228 1 -1
1 468 233 23 232 2 -2
NULL 2360 238 24 236 3 NULL
2 490 248 26 249 -4 -1
3 1580 NULL 9 158 1 NULL
1 1670 NULL 11 167 1 NULL
1 1510 NULL 8 151 2 NULL
4 486 NULL 25 240 3 NULL
2 1450 NULL 7 145 4 NULL
1 358 NULL 13 175 4 NULL

statement query skipped
elect b as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and c>d
order by col2,col1;

----

statement query skipped
elect b as col1,
       a+b*2 as col2
from t1
where e+d between a+b-10 and c+130
   and c>d
order by col1,col2;

----

statement query skipped
elect b as col1,
       a+b*2 as col2
from t1
where c>d
   and e+d between a+b-10 and c+130
order by col2,col1;

----

statement query skipped
elect b as col1,
       a+b*2 as col2
from t1
where c>d
   and e+d between a+b-10 and c+130
order by col2,col1;

----

statement query IIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3+d*4 as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col4,col2,col3,col1;

----
1096 2728 1828 364
1121 2806 1861 376
1277 3175 2125 426
1338 3331 2226 440
1391 3473 2323 468
1484 3706 2476 490
635 1612 1067 1050
NULL NULL NULL 1120
738 NULL 1226 1240
793 1985 1325 1300
827 2046 1371 1390
851 2131 1411 1430
966 2432 1622 1600
1030 2579 1714 1700
NULL NULL NULL NULL

statement query IIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a+b*2+c*3+d*4 as col3,
       case when c>avg_c then a*2 else b*10 end as col4
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c between b-2 and d+2
order by col3,col1,col4,col2;

----
635 1612 1067 1050
738 NULL 1226 1240
793 1985 1325 1300
827 2046 1371 1390
851 2131 1411 1430
966 2432 1622 1600
1030 2579 1714 1700
1096 2728 1828 364
1121 2806 1861 376
1277 3175 2125 426
1338 3331 2226 440
1391 3473 2323 468
1484 3706 2476 490
NULL NULL NULL 1120
NULL NULL NULL NULL

statement query IIFIII
select b-c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
   and d not between 110 and 150
order by col6,col4,col5,col2,col3,col1;

----
-1 1622 162.0 333 0 1
-1 2226 222.0 444 0 1
1 2323 232.0 555 0 1
2 2476 247.0 444 0 2
-3 2125 212.0 222 0 3
-3 1828 182.0 333 0 3
NULL NULL NULL 555 0 NULL

statement query IIFIII
select b-c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where d>e
   and exists(select 1 from t1 as x where x.b<t1.b)
   and d not between 110 and 150
order by col5,col3,col4,col1,col6,col2;

----
-1 1622 162.0 333 0 1
-3 1828 182.0 333 0 3
-3 2125 212.0 222 0 3
-1 2226 222.0 444 0 1
1 2323 232.0 555 0 1
2 2476 247.0 444 0 2
NULL NULL NULL 555 0 NULL

statement query IIFIII
select b-c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and d not between 110 and 150
order by col6,col4,col5,col2,col3,col1;

----
-1 1622 162.0 333 0 1
-1 2226 222.0 444 0 1
1 2323 232.0 555 0 1
2 2476 247.0 444 0 2
-3 2125 212.0 222 0 3
-3 1828 182.0 333 0 3
NULL NULL NULL 555 0 NULL

statement query IIFIII
select b-c as col1,
       a+b*2+c*3+d*4 as col2,
       (a+b+c+d+e)/5 as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col5,
       abs(b-c) as col6
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and d>e
   and d not between 110 and 150
order by col6,col4,col1,col5,col2,col3;

----
-1 1622 162.0 333 0 1
-1 2226 222.0 444 0 1
1 2323 232.0 555 0 1
2 2476 247.0 444 0 2
-3 2125 212.0 222 0 3
-3 1828 182.0 333 0 3
NULL NULL NULL 555 0 NULL

statement query II
select a as col1,
       b as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or a>b
order by col2,col1;

----
107 105
NULL 112
121 124
127 129
131 130
138 139
142 143
149 145
153 151
159 158
163 160
168 167
174 170
179 175
182 181
188 186
191 194
199 198
NULL 206
213 211
216 218
220 223
229 228
234 232
239 236
243 240
245 249
104 NULL
115 NULL
201 NULL

statement query II
select a as col1,
       b as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or a>b
order by col2,col1;

----
107 105
NULL 112
121 124
127 129
131 130
138 139
142 143
149 145
153 151
159 158
163 160
168 167
174 170
179 175
182 181
188 186
191 194
199 198
NULL 206
213 211
216 218
220 223
229 228
234 232
239 236
243 240
245 249
104 NULL
115 NULL
201 NULL

statement query II
select a as col1,
       b as col2
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
107 105
NULL 112
121 124
127 129
131 130
138 139
142 143
149 145
153 151
159 158
163 160
168 167
174 170
179 175
182 181
188 186
191 194
199 198
NULL 206
213 211
216 218
220 223
229 228
234 232
239 236
243 240
245 249
104 NULL
115 NULL
201 NULL

statement query IT
select a as col1,
       b as col2
from t1
where a>b
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
104 NULL
107 105
115 NULL
121 124
127 129
131 130
138 139
142 143
149 145
153 151
159 158
163 160
168 167
174 170
179 175
182 181
188 186
191 194
199 198
201 NULL
213 211
216 218
220 223
229 228
234 232
239 236
243 240
245 249
NULL 112
NULL 206

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(b-c) as col2,
       abs(a) as col3
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col3,col1;

----
222 1 191
222 1 220
111 2 245

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(b-c) as col2,
       abs(a) as col3
from t1
where (e>a and e<b)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col3,col2,col1;

----
222 1 191
222 1 220
111 2 245

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(b-c) as col2,
       abs(a) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
order by col2,col3,col1;

----
222 1 191
222 1 220
111 2 245

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       abs(b-c) as col2,
       abs(a) as col3
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (e>a and e<b)
order by col3,col1,col2;

----
222 1 191
222 1 220
111 2 245

statement query II
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2
from t1
where (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col1;

----
1290 760
1600 966
376 1121
382 1158
426 1277
432 1297
440 1338
468 1391

statement query II
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2
from t1
where (c<=d-2 or c>=d+2)
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1,col2;

----
376 1121
382 1158
426 1277
432 1297
440 1338
468 1391
1290 760
1600 966

statement query II
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
order by col2,col1;

----
1290 760
1600 966
376 1121
382 1158
426 1277
432 1297
440 1338
468 1391

statement query II
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       a+b*2+c*3 as col2
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and (c<=d-2 or c>=d+2)
order by col2,col1;

----
1290 760
1600 966
376 1121
382 1158
426 1277
432 1297
440 1338
468 1391

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where a>b
   and d>e
   and c between b-2 and d+2
order by col2,col3,col1;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where a>b
   and d>e
   and c between b-2 and d+2
order by col2,col1,col3;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where d>e
   and c between b-2 and d+2
   and a>b
order by col2,col3,col1;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where d>e
   and c between b-2 and d+2
   and a>b
order by col2,col3,col1;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where d>e
   and a>b
   and c between b-2 and d+2
order by col2,col3,col1;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query III
select b as col1,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col2,
       a+b*2 as col3
from t1
where d>e
   and a>b
   and c between b-2 and d+2
order by col3,col2,col1;

----
130 0 391
160 0 483
181 0 544
211 0 635
232 0 698

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col1;

----
222

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>a and e<b)
   and (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
order by col1;

----
222

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
   and (e>a and e<b)
   and (c<=d-2 or c>=d+2)
order by col1;

----
222

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
   and (e>a and e<b)
   and (c<=d-2 or c>=d+2)
order by col1;

----
222

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a-b as col2,
       e as col3,
       abs(b-c) as col4
from t1
where (a>b-2 and a<b+2)
order by col4,col2,col3,col1;

----
333 1 165 1
222 -1 135 2
222 -1 144 2
333 1 157 3
333 1 180 3
333 1 197 3
333 1 227 3
333 1 132 4

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       a-b as col2,
       e as col3,
       abs(b-c) as col4
from t1
where (a>b-2 and a<b+2)
order by col4,col1,col2,col3;

----
333 1 165 1
222 -1 135 2
222 -1 144 2
333 1 157 3
333 1 180 3
333 1 197 3
333 1 227 3
333 1 132 4

statement query III
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3
from t1
where (e>a and e<b)
order by col2,col3,col1;

----
0 193 444
0 224 444
0 247 444

statement query III
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       c as col2,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col3
from t1
where (e>a and e<b)
order by col2,col1,col3;

----
0 193 444
0 224 444
0 247 444

statement query IIIIIII
select abs(a) as col1,
       c as col2,
       a+b*2+c*3 as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       a+b*2+c*3+d*4 as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
127 125 760 128 1902 1272 333
131 134 793 133 1985 1325 444
138 137 827 136 2046 1371 111
163 161 966 164 2432 1622 333
182 184 1096 183 2728 1828 333
213 214 1277 212 3175 2125 222
220 224 1338 222 3331 2226 444
234 231 1391 233 3473 2323 555
245 247 1484 248 3706 2476 444
NULL 113 NULL 114 NULL NULL 555
239 NULL NULL 238 NULL NULL 555

statement query IIIIIII
select abs(a) as col1,
       c as col2,
       a+b*2+c*3 as col3,
       d as col4,
       a+b*2+c*3+d*4+e*5 as col5,
       a+b*2+c*3+d*4 as col6,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col7
from t1
where d>e
order by col6,col2,col7,col3,col5,col1,col4;

----
127 125 760 128 1902 1272 333
131 134 793 133 1985 1325 444
138 137 827 136 2046 1371 111
163 161 966 164 2432 1622 333
182 184 1096 183 2728 1828 333
213 214 1277 212 3175 2125 222
220 224 1338 222 3331 2226 444
234 231 1391 233 3473 2323 555
245 247 1484 248 3706 2476 444
NULL 113 NULL 114 NULL NULL 555
239 NULL NULL 238 NULL NULL 555

statement query I
select c-d as col1
from t1
order by col1;

----
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
1
1
1
1
2
2
2
3
3
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select c-d as col1
from t1
order by col1;

----
-3
-3
-2
-2
-2
-1
-1
-1
-1
-1
1
1
1
1
1
1
1
1
2
2
2
3
3
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d as col2,
       b as col3,
       a+b*2 as col4
from t1
where c between b-2 and d+2
order by col4,col2,col3,col1;

----
0 108 105 317
0 122 124 369
0 133 130 391
0 136 139 416
0 140 143 428
0 164 160 483
0 171 170 514
0 183 181 544
0 185 186 560
0 212 211 635
0 222 223 666
0 233 232 698
0 248 249 743
0 114 112 NULL
0 207 206 NULL

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       d as col2,
       b as col3,
       a+b*2 as col4
from t1
where c between b-2 and d+2
order by col2,col3,col4,col1;

----
0 108 105 317
0 114 112 NULL
0 122 124 369
0 133 130 391
0 136 139 416
0 140 143 428
0 164 160 483
0 171 170 514
0 183 181 544
0 185 186 560
0 207 206 NULL
0 212 211 635
0 222 223 666
0 233 232 698
0 248 249 743

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       b-c as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
   and c>d
order by col2,col1;

----
426 -3
376 -1
440 -1
382 1
NULL NULL

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       b-c as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (c<=d-2 or c>=d+2)
   and c>d
order by col1,col2;

----
376 -1
382 1
426 -3
440 -1
NULL NULL

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       b-c as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and (c<=d-2 or c>=d+2)
order by col2,col1;

----
426 -3
376 -1
440 -1
382 1
NULL NULL

statement query II
select case when c>avg_c then a*2 else b*10 end as col1,
       b-c as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where c>d
   and (c<=d-2 or c>=d+2)
order by col2,col1;

----
426 -3
376 -1
440 -1
382 1
NULL NULL

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where (e>c or e<d)
   and b>c
   and d not between 110 and 150
order by col2,col3,col1;

----
333 197 3
222 219 3
333 227 3
333 230 1
111 246 2

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where (e>c or e<d)
   and b>c
   and d not between 110 and 150
order by col1,col2,col3;

----
111 246 2
222 219 3
333 197 3
333 227 3
333 230 1

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and b>c
order by col2,col3,col1;

----
333 197 3
222 219 3
333 227 3
333 230 1
111 246 2

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where (e>c or e<d)
   and d not between 110 and 150
   and b>c
order by col2,col1,col3;

----
333 197 3
222 219 3
333 227 3
333 230 1
111 246 2

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where d not between 110 and 150
   and b>c
   and (e>c or e<d)
order by col2,col3,col1;

----
333 197 3
222 219 3
333 227 3
333 230 1
111 246 2

statement query III
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       abs(b-c) as col3
from t1
where d not between 110 and 150
   and b>c
   and (e>c or e<d)
order by col3,col1,col2;

----
333 230 1
111 246 2
222 219 3
333 197 3
333 227 3

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (e>a and e<b)
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
1 108 1612 0 1067
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
3 NULL NULL 9 NULL
1 164 2432 10 1622
1 NULL NULL 11 NULL
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
2 207 NULL 18 NULL
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
NULL 238 NULL 24 NULL
2 248 3706 26 2476

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (e>a and e<b)
    or (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col3,col1,col4,col5,col2;

----
1 108 1612 0 1067
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
1 164 2432 10 1622
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
2 248 3706 26 2476
1 NULL NULL 11 NULL
2 207 NULL 18 NULL
3 NULL NULL 9 NULL
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
NULL 238 NULL 24 NULL

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
1 108 1612 0 1067
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
3 NULL NULL 9 NULL
1 164 2432 10 1622
1 NULL NULL 11 NULL
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
2 207 NULL 18 NULL
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
NULL 238 NULL 24 NULL
2 248 3706 26 2476

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
    or (e>a and e<b)
order by col5,col1,col2,col3,col4;

----
1 108 1612 0 1067
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
1 164 2432 10 1622
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
2 248 3706 26 2476
1 NULL NULL 11 NULL
2 207 NULL 18 NULL
3 NULL NULL 9 NULL
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
NULL 238 NULL 24 NULL

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
    or (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
1 108 1612 0 1067
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
3 NULL NULL 9 NULL
1 164 2432 10 1622
1 NULL NULL 11 NULL
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
2 207 NULL 18 NULL
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
NULL 238 NULL 24 NULL
2 248 3706 26 2476

statement query IIIII
select abs(b-c) as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4,
       a+b*2+c*3+d*4 as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
    or (e>a and e<b)
order by col5,col3,col1,col4,col2;

----
1 108 1612 0 1067
4 133 1985 4 1325
2 136 2046 5 1371
2 140 2131 6 1411
1 164 2432 10 1622
2 171 2579 12 1714
3 183 2728 14 1828
1 185 2806 15 1861
1 190 2878 16 1918
3 196 2949 17 1964
3 212 3175 19 2125
3 217 3260 20 2165
1 222 3331 21 2226
3 226 3399 22 2264
1 233 3473 23 2323
2 248 3706 26 2476
1 NULL NULL 11 NULL
2 207 NULL 18 NULL
3 NULL NULL 9 NULL
NULL 101 NULL 0 NULL
NULL 203 NULL 0 NULL
NULL 238 NULL 24 NULL

statement query IIIIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       d as col5,
       c-d as col6
from t1
where b>c
order by col6,col4,col5,col2,col3,col1;

----
760 1902 127 333 128 -3
1297 3260 216 333 217 -2
1391 3473 234 555 233 -2
1484 3706 245 444 248 -1
1180 2949 199 555 196 -1
1360 3399 229 555 226 -1
827 2046 138 111 136 1
851 2131 142 111 140 1
738 NULL 121 333 122 1
1158 2878 191 444 190 3
905 NULL 153 555 NULL NULL
940 NULL 159 555 NULL NULL
1000 NULL 168 555 NULL NULL

statement query ITIIII
select a+b*2+c*3 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       a as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4,
       d as col5,
       c-d as col6
from t1
where b>c
order by col1,col3,col5,col6,col4,col2;

----
738 NULL 121 333 122 1
760 1902 127 333 128 -3
827 2046 138 111 136 1
851 2131 142 111 140 1
905 NULL 153 555 NULL NULL
940 NULL 159 555 NULL NULL
1000 NULL 168 555 NULL NULL
1158 2878 191 444 190 3
1180 2949 199 555 196 -1
1297 3260 216 333 217 -2
1360 3399 229 555 226 -1
1391 3473 234 555 233 -2
1484 3706 245 444 248 -1

statement query skipped
elect case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       e as col3,
       d-e as col4,
       c-d as col5,
       a as col6
from t1
where (e>a and e<b)
   and a>b
   and d>e
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       e as col3,
       d-e as col4,
       c-d as col5,
       a as col6
from t1
where (e>a and e<b)
   and a>b
   and d>e
order by col6,col3,col4,col5,col2,col1;

----

statement query skipped
elect case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       e as col3,
       d-e as col4,
       c-d as col5,
       a as col6
from t1
where a>b
   and d>e
   and (e>a and e<b)
order by col6,col4,col5,col2,col3,col1;

----

statement query skipped
elect case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       b-c as col2,
       e as col3,
       d-e as col4,
       c-d as col5,
       a as col6
from t1
where a>b
   and d>e
   and (e>a and e<b)
order by col6,col5,col4,col2,col3,col1;

----

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c as col3,
       a+b*2 as col4
from t1
where (e>a and e<b)
   and b>c
order by col4,col2,col3,col1;

----
16 2878 193 579
26 3706 247 743

statement query IIII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c as col3,
       a+b*2 as col4
from t1
where (e>a and e<b)
   and b>c
order by col2,col4,col3,col1;

----
16 2878 193 579
26 3706 247 743

statement query IIIII
select abs(a) as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       e as col4,
       b as col5
from t1
where (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
107 635 317 109 105
163 966 483 162 160
188 1121 560 189 186
191 1158 579 192 194
213 1277 635 210 211
216 1297 652 219 218
220 1338 666 221 223
234 1391 698 230 232

statement query IIIII
select abs(a) as col1,
       a+b*2+c*3 as col2,
       a+b*2 as col3,
       e as col4,
       b as col5
from t1
where (c<=d-2 or c>=d+2)
   and d not between 110 and 150
order by col5,col4,col1,col2,col3;

----
107 635 317 109 105
163 966 483 162 160
188 1121 560 189 186
191 1158 579 192 194
213 1277 635 210 211
216 1297 652 219 218
220 1338 666 221 223
234 1391 698 230 232

statement query IIIII
select a-b as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5
from t1
where c between b-2 and d+2
order by col4,col5,col2,col3,col1;

----
2 635 0 1067 107
-3 738 0 1226 121
1 793 0 1325 131
-1 827 0 1371 138
-1 851 0 1411 142
3 966 0 1622 163
4 1030 0 1714 174
1 1096 0 1828 182
2 1121 0 1861 188
2 1277 0 2125 213
-3 1338 0 2226 220
2 1391 0 2323 234
-4 1484 0 2476 245
NULL NULL 0 NULL NULL
NULL NULL 0 NULL NULL

statement query IIIII
select a-b as col1,
       a+b*2+c*3 as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       a+b*2+c*3+d*4 as col4,
       abs(a) as col5
from t1
where c between b-2 and d+2
order by col5,col2,col4,col3,col1;

----
2 635 0 1067 107
-3 738 0 1226 121
1 793 0 1325 131
-1 827 0 1371 138
-1 851 0 1411 142
3 966 0 1622 163
4 1030 0 1714 174
1 1096 0 1828 182
2 1121 0 1861 188
2 1277 0 2125 213
-3 1338 0 2226 220
2 1391 0 2323 234
-4 1484 0 2476 245
NULL NULL 0 NULL NULL
NULL NULL 0 NULL NULL

statement query I
select a-b as col1
from t1
where c between b-2 and d+2
order by col1;

----
-4
-3
-3
-1
-1
1
1
2
2
2
2
3
4
NULL
NULL

statement query I
select a-b as col1
from t1
where c between b-2 and d+2
order by col1;

----
-4
-3
-3
-1
-1
1
1
2
2
2
2
3
4
NULL
NULL

statement query IIII
select a+b*2 as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where b>c
    or c between b-2 and d+2
order by col4,col2,col3,col1;

----
743 2 0 111
428 -4 0 222
579 -2 0 222
652 -2 0 222
416 1 0 222
666 1 0 222
385 2 0 222
369 NULL 0 222
560 -4 0 333
317 -1 0 333
595 -1 0 333
685 -1 0 333
391 1 0 333
635 2 0 333
544 3 0 333
698 3 0 333
455 NULL 0 333
475 NULL 0 333
502 NULL 0 333
514 -2 0 444
483 2 0 444
NULL 4 0 444
NULL NULL 0 444

statement query IIII
select a+b*2 as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where b>c
    or c between b-2 and d+2
order by col1,col2,col3,col4;

----
317 -1 0 333
369 NULL 0 222
385 2 0 222
391 1 0 333
416 1 0 222
428 -4 0 222
455 NULL 0 333
475 NULL 0 333
483 2 0 444
502 NULL 0 333
514 -2 0 444
544 3 0 333
560 -4 0 333
579 -2 0 222
595 -1 0 333
635 2 0 333
652 -2 0 222
666 1 0 222
685 -1 0 333
698 3 0 333
743 2 0 111
NULL 4 0 444
NULL NULL 0 444

statement query IIII
select a+b*2 as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
    or b>c
order by col4,col2,col3,col1;

----
743 2 0 111
428 -4 0 222
579 -2 0 222
652 -2 0 222
416 1 0 222
666 1 0 222
385 2 0 222
369 NULL 0 222
560 -4 0 333
317 -1 0 333
595 -1 0 333
685 -1 0 333
391 1 0 333
635 2 0 333
544 3 0 333
698 3 0 333
455 NULL 0 333
475 NULL 0 333
502 NULL 0 333
514 -2 0 444
483 2 0 444
NULL 4 0 444
NULL NULL 0 444

statement query IIII
select a+b*2 as col1,
       d-e as col2,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where c between b-2 and d+2
    or b>c
order by col3,col2,col4,col1;

----
428 -4 0 222
560 -4 0 333
579 -2 0 222
652 -2 0 222
514 -2 0 444
317 -1 0 333
595 -1 0 333
685 -1 0 333
416 1 0 222
666 1 0 222
391 1 0 333
743 2 0 111
385 2 0 222
635 2 0 333
483 2 0 444
544 3 0 333
698 3 0 333
NULL 4 0 444
369 NULL 0 222
455 NULL 0 333
475 NULL 0 333
502 NULL 0 333
NULL NULL 0 444

statement query I
select b as col1
from t1
where c between b-2 and d+2
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
112
124
130
139
143
160
170
181
186
206
211
223
232
249

statement query I
select b as col1
from t1
where c between b-2 and d+2
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
112
124
130
139
143
160
170
181
186
206
211
223
232
249

statement query I
select b as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
order by col1;

----
112
124
130
139
143
160
170
181
186
206
211
223
232
249

statement query I
select b as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c between b-2 and d+2
order by col1;

----
112
124
130
139
143
160
170
181
186
206
211
223
232
249

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where (e>c or e<d)
    or c>d
    or d>e
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
159 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
163 444
174 444
179 444
201 444
239 444
NULL 444
NULL 444

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where (e>c or e<d)
    or c>d
    or d>e
order by col1,col2;

----
104 444
107 333
115 444
121 222
127 222
131 333
138 222
142 222
159 333
163 444
174 444
179 444
182 333
188 333
191 222
199 333
201 444
213 333
216 222
220 222
229 333
234 333
239 444
245 111
NULL 444
NULL 444

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
    or c>d
    or (e>c or e<d)
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
159 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
163 444
174 444
179 444
201 444
239 444
NULL 444
NULL 444

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
    or c>d
    or (e>c or e<d)
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
159 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
163 444
174 444
179 444
201 444
239 444
NULL 444
NULL 444

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
    or (e>c or e<d)
    or c>d
order by col2,col1;

----
245 111
121 222
127 222
138 222
142 222
191 222
216 222
220 222
107 333
131 333
159 333
182 333
188 333
199 333
213 333
229 333
234 333
104 444
115 444
163 444
174 444
179 444
201 444
239 444
NULL 444
NULL 444

statement query II
select abs(a) as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2
from t1
where d>e
    or (e>c or e<d)
    or c>d
order by col1,col2;

----
104 444
107 333
115 444
121 222
127 222
131 333
138 222
142 222
159 333
163 444
174 444
179 444
182 333
188 333
191 222
199 333
201 444
213 333
216 222
220 222
229 333
234 333
239 444
245 111
NULL 444
NULL 444

statement query IIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col5,col2,col3,col1;

----
1240 222 369 1 124
376 333 560 1 186
382 222 579 1 194
440 222 666 1 223
1390 222 416 2 139
1430 222 428 2 143
1700 444 514 2 170
NULL 444 NULL 2 206
364 333 544 3 181
426 333 635 3 211
1300 333 391 4 130

statement query IIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where c>d
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col1,col5,col2,col3;

----
376 333 560 1 186
382 222 579 1 194
440 222 666 1 223
1240 222 369 1 124
1390 222 416 2 139
1430 222 428 2 143
1700 444 514 2 170
NULL 444 NULL 2 206
364 333 544 3 181
426 333 635 3 211
1300 333 391 4 130

statement query IIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
order by col4,col5,col2,col3,col1;

----
1240 222 369 1 124
376 333 560 1 186
382 222 579 1 194
440 222 666 1 223
1390 222 416 2 139
1430 222 428 2 143
1700 444 514 2 170
NULL 444 NULL 2 206
364 333 544 3 181
426 333 635 3 211
1300 333 391 4 130

statement query IIIII
select case when c>(select avg(c) from t1) then a*2 else b*10 end as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       a+b*2 as col3,
       abs(b-c) as col4,
       b as col5
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and c>d
order by col5,col4,col3,col1,col2;

----
1240 222 369 1 124
1300 333 391 4 130
1390 222 416 2 139
1430 222 428 2 143
1700 444 514 2 170
364 333 544 3 181
376 333 560 1 186
382 222 579 1 194
NULL 444 NULL 2 206
426 333 635 3 211
440 222 666 1 223

statement query IIII
select a+b*2+c*3 as col1,
       d as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
order by col4,col2,col3,col1;

----
635 108 -1 0
NULL 114 -1 1
738 122 1 2
793 133 -4 4
827 136 2 5
851 140 2 6
966 164 -1 10
1030 171 -2 12
1096 183 -3 14
1121 185 -1 15
NULL 207 -2 18
1277 212 -3 19
1338 222 -1 21
1391 233 1 23
1484 248 2 26

statement query IIII
select a+b*2+c*3 as col1,
       d as col2,
       b-c as col3,
       (select count(*) from t1 as x where x.b<t1.b) as col4
from t1
where c between b-2 and d+2
order by col4,col3,col1,col2;

----
635 108 -1 0
NULL 114 -1 1
738 122 1 2
793 133 -4 4
827 136 2 5
851 140 2 6
966 164 -1 10
1030 171 -2 12
1096 183 -3 14
1121 185 -1 15
NULL 207 -2 18
1277 212 -3 19
1338 222 -1 21
1391 233 1 23
1484 248 2 26

statement query IIIIIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a as col5,
       abs(b-c) as col6,
       c-d as col7
from t1
where a>b
order by col6,col7,col4,col5,col2,col3,col1;

----
160 1622 2432 444 163 1 -3
105 1067 1612 333 107 1 -2
232 2323 3473 333 234 1 -2
186 1861 2806 333 188 1 2
151 NULL NULL 333 153 1 NULL
167 NULL NULL 333 168 1 NULL
175 NULL NULL 444 179 1 NULL
170 1714 2579 444 174 2 1
145 NULL NULL 444 149 2 NULL
198 1964 2949 333 199 3 -1
228 2264 3399 333 229 3 -1
181 1828 2728 333 182 3 1
211 2125 3175 333 213 3 2
158 NULL NULL 333 159 3 NULL
130 1325 1985 333 131 4 1
240 NULL NULL 444 243 4 NULL
236 NULL NULL 444 239 NULL NULL

statement query IIIIIII
select b as col1,
       a+b*2+c*3+d*4 as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a as col5,
       abs(b-c) as col6,
       c-d as col7
from t1
where a>b
order by col3,col4,col7,col5,col2,col1,col6;

----
105 1067 1612 333 107 1 -2
130 1325 1985 333 131 4 1
160 1622 2432 444 163 1 -3
170 1714 2579 444 174 2 1
181 1828 2728 333 182 3 1
186 1861 2806 333 188 1 2
198 1964 2949 333 199 3 -1
211 2125 3175 333 213 3 2
228 2264 3399 333 229 3 -1
232 2323 3473 333 234 1 -2
151 NULL NULL 333 153 1 NULL
158 NULL NULL 333 159 3 NULL
167 NULL NULL 333 168 1 NULL
145 NULL NULL 444 149 2 NULL
175 NULL NULL 444 179 1 NULL
236 NULL NULL 444 239 NULL NULL
240 NULL NULL 444 243 4 NULL

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a-b as col2,
       c as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where a>b
order by col4,col2,col3,col1;

----
0 2 214 222
0 3 244 222
0 1 184 333
0 2 106 333
0 3 161 333
0 1 134 444
0 2 187 444
0 1 155 555
0 1 166 555
0 1 195 555
0 1 225 555
0 2 150 555
0 2 231 555
0 3 NULL 555
0 4 147 555
0 4 172 555
0 4 176 555

statement query IIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       a-b as col2,
       c as col3,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col4
from t1
where a>b
order by col1,col2,col4,col3;

----
0 1 184 333
0 1 134 444
0 1 155 555
0 1 166 555
0 1 195 555
0 1 225 555
0 2 214 222
0 2 106 333
0 2 187 444
0 2 150 555
0 2 231 555
0 3 244 222
0 3 161 333
0 3 NULL 555
0 4 147 555
0 4 172 555
0 4 176 555

statement query IIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col4,col5,col2,col3,col1;

----
0 1 107.0 1067 -1
4 4 132.0 1325 1
5 2 137.0 1371 1
6 2 142.0 1411 -4
10 1 162.0 1622 2
12 2 172.0 1714 -2
14 3 182.0 1828 3
15 1 187.0 1861 -4
16 1 192.0 1918 -2
17 3 197.0 1964 -1
19 3 212.0 2125 2
20 3 217.0 2165 -2
21 1 222.0 2226 1
22 3 227.0 2264 -1
23 1 232.0 2323 3
26 2 247.0 2476 2
0 NULL NULL NULL -1
24 NULL NULL NULL 1
11 1 NULL NULL NULL
18 2 NULL NULL NULL
9 3 NULL NULL NULL
0 NULL NULL NULL NULL

statement query IIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from t1
where d not between 110 and 150
    or (a>b-2 and a<b+2)
order by col1,col4,col5,col2,col3;

----
0 1 107.0 1067 -1
0 NULL NULL NULL -1
0 NULL NULL NULL NULL
4 4 132.0 1325 1
5 2 137.0 1371 1
6 2 142.0 1411 -4
9 3 NULL NULL NULL
10 1 162.0 1622 2
11 1 NULL NULL NULL
12 2 172.0 1714 -2
14 3 182.0 1828 3
15 1 187.0 1861 -4
16 1 192.0 1918 -2
17 3 197.0 1964 -1
18 2 NULL NULL NULL
19 3 212.0 2125 2
20 3 217.0 2165 -2
21 1 222.0 2226 1
22 3 227.0 2264 -1
23 1 232.0 2323 3
24 NULL NULL NULL 1
26 2 247.0 2476 2

statement query IIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col4,col5,col2,col3,col1;

----
0 1 107.0 1067 -1
4 4 132.0 1325 1
5 2 137.0 1371 1
6 2 142.0 1411 -4
10 1 162.0 1622 2
12 2 172.0 1714 -2
14 3 182.0 1828 3
15 1 187.0 1861 -4
16 1 192.0 1918 -2
17 3 197.0 1964 -1
19 3 212.0 2125 2
20 3 217.0 2165 -2
21 1 222.0 2226 1
22 3 227.0 2264 -1
23 1 232.0 2323 3
26 2 247.0 2476 2
0 NULL NULL NULL -1
24 NULL NULL NULL 1
11 1 NULL NULL NULL
18 2 NULL NULL NULL
9 3 NULL NULL NULL
0 NULL NULL NULL NULL

statement query IIFII
select (select count(*) from t1 as x where x.b<t1.b) as col1,
       abs(b-c) as col2,
       (a+b+c+d+e)/5 as col3,
       a+b*2+c*3+d*4 as col4,
       d-e as col5
from t1
where (a>b-2 and a<b+2)
    or d not between 110 and 150
order by col1,col5,col4,col2,col3;

----
0 1 107.0 1067 -1
0 NULL NULL NULL -1
0 NULL NULL NULL NULL
4 4 132.0 1325 1
5 2 137.0 1371 1
6 2 142.0 1411 -4
9 3 NULL NULL NULL
10 1 162.0 1622 2
11 1 NULL NULL NULL
12 2 172.0 1714 -2
14 3 182.0 1828 3
15 1 187.0 1861 -4
16 1 192.0 1918 -2
17 3 197.0 1964 -1
18 2 NULL NULL NULL
19 3 212.0 2125 2
20 3 217.0 2165 -2
21 1 222.0 2226 1
22 3 227.0 2264 -1
23 1 232.0 2323 3
24 NULL NULL NULL 1
26 2 247.0 2476 2

statement query IIIITI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       c as col3,
       abs(a) as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
444 101 102 104 NULL 0
333 108 106 107 105 0
444 116 119 115 NULL 0
222 122 123 121 124 0
222 128 125 127 129 0
333 133 134 131 130 0
222 136 137 138 139 0
222 140 141 142 143 0
444 NULL 147 149 145 0
333 NULL 150 153 151 0
333 NULL 155 159 158 0
444 164 161 163 160 0
333 NULL 166 168 167 0
444 171 172 174 170 0
444 NULL 176 179 175 0
333 183 184 182 181 0
333 185 187 188 186 0
222 190 193 191 194 0
333 196 195 199 198 0
444 203 202 201 NULL 0
333 212 214 213 211 0
222 217 215 216 218 0
222 222 224 220 223 0
333 226 225 229 228 0
333 233 231 234 232 0
444 238 NULL 239 236 0
444 NULL 244 243 240 0
111 248 247 245 249 0
444 114 113 NULL 112 0
444 207 208 NULL 206 0

statement query IIIITI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       c as col3,
       abs(a) as col4,
       b as col5,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col6
from t1
order by col3,col2,col5,col4,col1,col6;

----
444 101 102 104 NULL 0
333 108 106 107 105 0
444 114 113 NULL 112 0
444 116 119 115 NULL 0
222 122 123 121 124 0
222 128 125 127 129 0
333 133 134 131 130 0
222 136 137 138 139 0
222 140 141 142 143 0
444 NULL 147 149 145 0
333 NULL 150 153 151 0
333 NULL 155 159 158 0
444 164 161 163 160 0
333 NULL 166 168 167 0
444 171 172 174 170 0
444 NULL 176 179 175 0
333 183 184 182 181 0
333 185 187 188 186 0
222 190 193 191 194 0
333 196 195 199 198 0
444 203 202 201 NULL 0
444 207 208 NULL 206 0
333 212 214 213 211 0
222 217 215 216 218 0
222 222 224 220 223 0
333 226 225 229 228 0
333 233 231 234 232 0
444 NULL 244 243 240 0
111 248 247 245 249 0
444 238 NULL 239 236 0

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
   and e+d between a+b-10 and c+130
order by col2,col4,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where e+d between a+b-10 and c+130
   and exists(select 1 from t1 as x where x.b<t1.b)
   and a>b
order by col4,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where e+d between a+b-10 and c+130
   and exists(select 1 from t1 as x where x.b<t1.b)
   and a>b
order by col4,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where e+d between a+b-10 and c+130
   and a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where e+d between a+b-10 and c+130
   and a>b
   and exists(select 1 from t1 as x where x.b<t1.b)
order by col4,col1,col2,col3;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and a>b
   and e+d between a+b-10 and c+130
order by col4,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       abs(a) as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
   and a>b
   and e+d between a+b-10 and c+130
order by col3,col4,col1,col2;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a-b as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a-b as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (a>b-2 and a<b+2)
   and (e>c or e<d)
   and e+d between a+b-10 and c+130
order by col3,col1,col4,col2,col5;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a-b as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col4,col5,col2,col3,col1;

----

statement query skipped
elect e as col1,
       a+b*2+c*3 as col2,
       case when c>avg_c then a*2 else b*10 end as col3,
       a-b as col4,
       b-c as col5
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
where (e>c or e<d)
   and (a>b-2 and a<b+2)
   and e+d between a+b-10 and c+130
order by col5,col4,col3,col1,col2;

----

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (a+b+c+d+e)/5 as col4,
       e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
333 108 0 107.0 109
222 128 3 127.0 126
444 164 10 162.0 162
333 185 15 187.0 189
222 190 16 192.0 192
333 212 19 212.0 210
222 217 20 217.0 219
222 222 21 222.0 221
333 233 23 232.0 230
444 116 0 NULL 117

statement query IIIFI
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       d as col2,
       (select count(*) from t1 as x where x.b<t1.b) as col3,
       (a+b+c+d+e)/5 as col4,
       e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col1,col5,col3,col2;

----
333 108 0 107.0 109
222 128 3 127.0 126
444 164 10 162.0 162
333 185 15 187.0 189
222 190 16 192.0 192
333 212 19 212.0 210
222 217 20 217.0 219
222 222 21 222.0 221
333 233 23 232.0 230
444 116 0 NULL 117

statement query I
select d as col1
from t1
where d not between 110 and 150
   and (e>a and e<b)
order by col1;

----
190
222
248

statement query I
select d as col1
from t1
where d not between 110 and 150
   and (e>a and e<b)
order by col1;

----
190
222
248

statement query I
select d as col1
from t1
where (e>a and e<b)
   and d not between 110 and 150
order by col1;

----
190
222
248

statement query I
select d as col1
from t1
where (e>a and e<b)
   and d not between 110 and 150
order by col1;

----
190
222
248

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where d>e
   and c>d
   and (e>a and e<b)
order by col6,col7,col4,col5,col2,col3,col1;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where d>e
   and c>d
   and (e>a and e<b)
order by col3,col4,col6,col7,col1,col5,col2;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (e>a and e<b)
   and d>e
   and c>d
order by col6,col7,col4,col5,col2,col3,col1;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (e>a and e<b)
   and d>e
   and c>d
order by col6,col3,col4,col7,col5,col2,col1;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (e>a and e<b)
   and c>d
   and d>e
order by col6,col7,col4,col5,col2,col3,col1;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where (e>a and e<b)
   and c>d
   and d>e
order by col2,col1,col6,col7,col4,col5,col3;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where d>e
   and (e>a and e<b)
   and c>d
order by col6,col7,col4,col5,col2,col3,col1;

----
224 222.0 221 1 666 -1 0

statement query IFIIIII
select c as col1,
       (a+b+c+d+e)/5 as col2,
       e as col3,
       d-e as col4,
       a+b*2 as col5,
       b-c as col6,
       (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col7
from t1
where d>e
   and (e>a and e<b)
   and c>d
order by col5,col1,col6,col2,col3,col7,col4;

----
224 222.0 221 1 666 -1 0

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
    or c between b-2 and d+2
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
    or c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where (e>c or e<d)
    or c between b-2 and d+2
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
    or (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query I
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1
from t1
where c between b-2 and d+2
    or (e>c or e<d)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
111
222
222
222
222
222
222
222
333
333
333
333
333
333
333
333
333
333
333
444
444
444
444
444
444
444
444
444
444

statement query II
select e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1;

----
177 358
180 364
189 376
192 382
197 398
204 402
210 426
219 432
221 440
227 458
230 468
NULL 486
246 490
109 1050
110 1120
NULL 1240
126 1290
132 1300
135 1390
144 1430
146 1450
NULL 1510
157 1580
162 1600
165 1670
173 1700
237 2360
117 NULL
NULL NULL
NULL NULL

statement query II
select e as col1,
       case when c>avg_c then a*2 else b*10 end as col2
from (
 select a, b, c, d, e, avg_c
 from (
  select avg(c) as avg_c from t1
 ) as Q cross join (select a, b, c, d, e from t1) as R
)
order by col2,col1;

----
177 358
180 364
189 376
192 382
197 398
204 402
210 426
219 432
221 440
227 458
230 468
NULL 486
246 490
109 1050
110 1120
NULL 1240
126 1290
132 1300
135 1390
144 1430
146 1450
NULL 1510
157 1580
162 1600
165 1670
173 1700
237 2360
117 NULL
NULL NULL
NULL NULL

statement query IIFI
select a as col1,
       b-c as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where (c<=d-2 or c>=d+2)
order by col4,col2,col3,col1;

----
107 -1 107.0 106
115 NULL NULL 119
127 4 127.0 125
163 -1 162.0 161
188 -1 187.0 187
191 1 192.0 193
213 -3 212.0 214
216 3 217.0 215
220 -1 222.0 224
234 1 232.0 231

statement query IIFI
select a as col1,
       b-c as col2,
       (a+b+c+d+e)/5 as col3,
       c as col4
from t1
where (c<=d-2 or c>=d+2)
order by col1,col4,col2,col3;

----
107 -1 107.0 106
115 NULL NULL 119
127 4 127.0 125
163 -1 162.0 161
188 -1 187.0 187
191 1 192.0 193
213 -3 212.0 214
216 3 217.0 215
220 -1 222.0 224
234 1 232.0 231

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
   and (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
220 2 1 1338 3331

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where (c<=d-2 or c>=d+2)
   and c between b-2 and d+2
   and (e>a and e<b)
order by col1,col2,col5,col4,col3;

----
220 2 1 1338 3331

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
   and (e>a and e<b)
order by col4,col5,col2,col3,col1;

----
220 2 1 1338 3331

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
   and (c<=d-2 or c>=d+2)
   and (e>a and e<b)
order by col2,col3,col4,col5,col1;

----
220 2 1 1338 3331

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
   and (e>a and e<b)
   and (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
220 2 1 1338 3331

statement query IIIII
select a as col1,
       c-d as col2,
       abs(b-c) as col3,
       a+b*2+c*3 as col4,
       a+b*2+c*3+d*4+e*5 as col5
from t1
where c between b-2 and d+2
   and (e>a and e<b)
   and (c<=d-2 or c>=d+2)
order by col3,col4,col5,col2,col1;

----
220 2 1 1338 3331

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       e as col2,
       c-d as col3,
       b as col4,
       d-e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col4,col5,col2,col3,col1;

----
0 109 -2 105 -1
0 126 -3 129 2
0 162 -3 160 2
0 189 2 186 -4
0 192 3 194 -2
0 210 2 211 2
0 219 -2 218 -2
0 221 2 223 1
0 230 -2 232 3
0 117 3 NULL -1

statement query IIIII
select (select count(*) from t1 as x where x.c>t1.c and x.d<t1.d) as col1,
       e as col2,
       c-d as col3,
       b as col4,
       d-e as col5
from t1
where (c<=d-2 or c>=d+2)
order by col5,col2,col4,col3,col1;

----
0 189 2 186 -4
0 192 3 194 -2
0 219 -2 218 -2
0 109 -2 105 -1
0 117 3 NULL -1
0 221 2 223 1
0 126 -3 129 2
0 162 -3 160 2
0 210 2 211 2
0 230 -2 232 3

statement query I
select a-b as col1
from t1
where (c<=d-2 or c>=d+2)
order by col1;

----
-3
-3
-2
-2
2
2
2
2
3
NULL

statement query I
select a-b as col1
from t1
where (c<=d-2 or c>=d+2)
order by col1;

----
-3
-3
-2
-2
2
2
2
2
3
NULL

statement query TTIITIT
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3 as col5,
       d as col6,
       a-b as col7
from t1
order by col6,col7,col4,col5,col2,col3,col1;

----
NULL NULL 1 444 NULL 101 NULL
107.0 1612 -2 333 635 108 2
NULL NULL -1 444 NULL 114 NULL
NULL NULL 3 444 NULL 116 NULL
NULL NULL 1 222 738 122 -3
127.0 1902 -3 222 760 128 -2
132.0 1985 1 333 793 133 1
137.0 2046 1 222 827 136 -1
142.0 2131 1 222 851 140 -1
162.0 2432 -3 444 966 164 3
172.0 2579 1 444 1030 171 4
182.0 2728 1 333 1096 183 1
187.0 2806 2 333 1121 185 2
192.0 2878 3 222 1158 190 -3
197.0 2949 -1 333 1180 196 1
NULL NULL -1 444 NULL 203 NULL
NULL NULL 1 444 NULL 207 NULL
212.0 3175 2 333 1277 212 2
217.0 3260 -2 222 1297 217 -2
222.0 3331 2 222 1338 222 -3
227.0 3399 -1 333 1360 226 1
232.0 3473 -2 333 1391 233 2
NULL NULL NULL 444 NULL 238 3
247.0 3706 -1 111 1484 248 -4
NULL NULL NULL 333 940 NULL 1
NULL NULL NULL 333 1000 NULL 1
NULL NULL NULL 333 905 NULL 2
NULL NULL NULL 444 1455 NULL 3
NULL NULL NULL 444 880 NULL 4
NULL NULL NULL 444 1057 NULL 4

statement query FIIIIII
select (a+b+c+d+e)/5 as col1,
       a+b*2+c*3+d*4+e*5 as col2,
       c-d as col3,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col4,
       a+b*2+c*3 as col5,
       d as col6,
       a-b as col7
from t1
order by col3,col7,col4,col2,col1,col6,col5;

----
127.0 1902 -3 222 760 128 -2
162.0 2432 -3 444 966 164 3
217.0 3260 -2 222 1297 217 -2
107.0 1612 -2 333 635 108 2
232.0 3473 -2 333 1391 233 2
247.0 3706 -1 111 1484 248 -4
197.0 2949 -1 333 1180 196 1
227.0 3399 -1 333 1360 226 1
NULL NULL -1 444 NULL 114 NULL
NULL NULL -1 444 NULL 203 NULL
NULL NULL 1 222 738 122 -3
137.0 2046 1 222 827 136 -1
142.0 2131 1 222 851 140 -1
132.0 1985 1 333 793 133 1
182.0 2728 1 333 1096 183 1
172.0 2579 1 444 1030 171 4
NULL NULL 1 444 NULL 101 NULL
NULL NULL 1 444 NULL 207 NULL
222.0 3331 2 222 1338 222 -3
187.0 2806 2 333 1121 185 2
212.0 3175 2 333 1277 212 2
192.0 2878 3 222 1158 190 -3
NULL NULL 3 444 NULL 116 NULL
NULL NULL NULL 333 940 NULL 1
NULL NULL NULL 333 1000 NULL 1
NULL NULL NULL 333 905 NULL 2
NULL NULL NULL 444 NULL 238 3
NULL NULL NULL 444 1455 NULL 3
NULL NULL NULL 444 880 NULL 4
NULL NULL NULL 444 1057 NULL 4

statement query III
select c as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3 as col3
from t1
where a>b
order by col2,col3,col1;

----
214 222 1277
244 222 1455
106 333 635
161 333 966
184 333 1096
134 444 793
187 444 1121
147 555 880
150 555 905
155 555 940
166 555 1000
172 555 1030
176 555 1057
195 555 1180
225 555 1360
231 555 1391
NULL 555 NULL

statement query III
select c as col1,
       case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col2,
       a+b*2+c*3 as col3
from t1
where a>b
order by col1,col3,col2;

----
106 333 635
134 444 793
147 555 880
150 555 905
155 555 940
161 333 966
166 555 1000
172 555 1030
176 555 1057
184 333 1096
187 444 1121
195 555 1180
214 222 1277
225 555 1360
231 555 1391
244 222 1455
NULL 555 NULL

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       a+b*2 as col3,
       d-e as col4
from t1
order by col4,col2,col3,col1;

----
222 144 428 -4
333 189 560 -4
444 173 514 -2
222 192 579 -2
222 219 652 -2
333 109 317 -1
444 117 NULL -1
333 197 595 -1
444 204 NULL -1
333 227 685 -1
333 132 391 1
222 135 416 1
222 221 666 1
444 237 711 1
222 126 385 2
444 162 483 2
333 210 635 2
111 246 743 2
333 180 544 3
333 230 698 3
444 110 NULL 4
444 146 439 NULL
333 157 475 NULL
333 165 502 NULL
444 177 529 NULL
222 NULL 369 NULL
333 NULL 455 NULL
444 NULL 723 NULL
444 NULL NULL NULL
444 NULL NULL NULL

statement query IIII
select case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col1,
       e as col2,
       a+b*2 as col3,
       d-e as col4
from t1
order by col1,col2,col3,col4;

----
111 246 743 2
222 126 385 2
222 135 416 1
222 144 428 -4
222 192 579 -2
222 219 652 -2
222 221 666 1
222 NULL 369 NULL
333 109 317 -1
333 132 391 1
333 157 475 NULL
333 165 502 NULL
333 180 544 3
333 189 560 -4
333 197 595 -1
333 210 635 2
333 227 685 -1
333 230 698 3
333 NULL 455 NULL
444 110 NULL 4
444 117 NULL -1
444 146 439 NULL
444 162 483 2
444 173 514 -2
444 177 529 NULL
444 204 NULL -1
444 237 711 1
444 NULL 723 NULL
444 NULL NULL NULL
444 NULL NULL NULL

statement query IITIT
select c-d as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       a+b*2+c*3+d*4 as col5
from t1
order by col4,col5,col2,col3,col1;

----
1 101 NULL 104 NULL
-2 108 1612 107 1067
3 116 NULL 115 NULL
1 122 NULL 121 1226
-3 128 1902 127 1272
1 133 1985 131 1325
1 136 2046 138 1371
1 140 2131 142 1411
NULL NULL NULL 149 NULL
NULL NULL NULL 153 NULL
NULL NULL NULL 159 NULL
-3 164 2432 163 1622
NULL NULL NULL 168 NULL
1 171 2579 174 1714
NULL NULL NULL 179 NULL
1 183 2728 182 1828
2 185 2806 188 1861
3 190 2878 191 1918
-1 196 2949 199 1964
-1 203 NULL 201 NULL
2 212 3175 213 2125
-2 217 3260 216 2165
2 222 3331 220 2226
-1 226 3399 229 2264
-2 233 3473 234 2323
NULL 238 NULL 239 NULL
NULL NULL NULL 243 NULL
-1 248 3706 245 2476
-1 114 NULL NULL NULL
1 207 NULL NULL NULL

statement query IIIII
select c-d as col1,
       d as col2,
       a+b*2+c*3+d*4+e*5 as col3,
       abs(a) as col4,
       a+b*2+c*3+d*4 as col5
from t1
order by col5,col1,col4,col2,col3;

----
-2 108 1612 107 1067
1 122 NULL 121 1226
-3 128 1902 127 1272
1 133 1985 131 1325
1 136 2046 138 1371
1 140 2131 142 1411
-3 164 2432 163 1622
1 171 2579 174 1714
1 183 2728 182 1828
2 185 2806 188 1861
3 190 2878 191 1918
-1 196 2949 199 1964
2 212 3175 213 2125
-2 217 3260 216 2165
2 222 3331 220 2226
-1 226 3399 229 2264
-2 233 3473 234 2323
-1 248 3706 245 2476
-1 203 NULL 201 NULL
-1 114 NULL NULL NULL
1 101 NULL 104 NULL
1 207 NULL NULL NULL
3 116 NULL 115 NULL
NULL NULL NULL 149 NULL
NULL NULL NULL 153 NULL
NULL NULL NULL 159 NULL
NULL NULL NULL 168 NULL
NULL NULL NULL 179 NULL
NULL 238 NULL 239 NULL
NULL NULL NULL 243 NULL

statement query IFIIIII
select d as col1,
       (a+b+c+d+e)/5 as col2,
       d-e as col3,
       b-c as col4,
       b as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a+b*2 as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col6,col7,col4,col5,col2,col3,col1;

----
128 127.0 2 4 129 1902 385
133 132.0 1 -4 130 1985 391
136 137.0 1 2 139 2046 416
140 142.0 -4 2 143 2131 428
164 162.0 2 -1 160 2432 483
171 172.0 -2 -2 170 2579 514
183 182.0 3 -3 181 2728 544
185 187.0 -4 -1 186 2806 560
190 192.0 -2 1 194 2878 579
196 197.0 -1 3 198 2949 595
212 212.0 2 -3 211 3175 635
217 217.0 -2 3 218 3260 652
222 222.0 1 -1 223 3331 666
226 227.0 -1 3 228 3399 685
233 232.0 3 1 232 3473 698
248 247.0 2 2 249 3706 743
122 NULL NULL 1 124 NULL 369
NULL NULL NULL -2 145 NULL 439
NULL NULL NULL 1 151 NULL 455
NULL NULL NULL 3 158 NULL 475
NULL NULL NULL 1 167 NULL 502
NULL NULL NULL -1 175 NULL 529
238 NULL 1 NULL 236 NULL 711
NULL NULL NULL -4 240 NULL 723
207 NULL NULL -2 206 NULL NULL
114 NULL 4 -1 112 NULL NULL
116 NULL -1 NULL NULL NULL NULL
101 NULL NULL NULL NULL NULL NULL

statement query ITTTTTT
select d as col1,
       (a+b+c+d+e)/5 as col2,
       d-e as col3,
       b-c as col4,
       b as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a+b*2 as col7
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or c>d
order by col1,col5,col2,col3,col4,col6,col7;

----
101 NULL NULL NULL NULL NULL NULL
114 NULL 4 -1 112 NULL NULL
116 NULL -1 NULL NULL NULL NULL
122 NULL NULL 1 124 NULL 369
128 127.0 2 4 129 1902 385
133 132.0 1 -4 130 1985 391
136 137.0 1 2 139 2046 416
140 142.0 -4 2 143 2131 428
164 162.0 2 -1 160 2432 483
171 172.0 -2 -2 170 2579 514
183 182.0 3 -3 181 2728 544
185 187.0 -4 -1 186 2806 560
190 192.0 -2 1 194 2878 579
196 197.0 -1 3 198 2949 595
207 NULL NULL -2 206 NULL NULL
212 212.0 2 -3 211 3175 635
217 217.0 -2 3 218 3260 652
222 222.0 1 -1 223 3331 666
226 227.0 -1 3 228 3399 685
233 232.0 3 1 232 3473 698
238 NULL 1 NULL 236 NULL 711
248 247.0 2 2 249 3706 743
NULL NULL NULL -2 145 NULL 439
NULL NULL NULL 1 151 NULL 455
NULL NULL NULL 3 158 NULL 475
NULL NULL NULL 1 167 NULL 502
NULL NULL NULL -1 175 NULL 529
NULL NULL NULL -4 240 NULL 723

statement query IFIIIII
select d as col1,
       (a+b+c+d+e)/5 as col2,
       d-e as col3,
       b-c as col4,
       b as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a+b*2 as col7
from t1
where c>d
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col6,col7,col4,col5,col2,col3,col1;

----
128 127.0 2 4 129 1902 385
133 132.0 1 -4 130 1985 391
136 137.0 1 2 139 2046 416
140 142.0 -4 2 143 2131 428
164 162.0 2 -1 160 2432 483
171 172.0 -2 -2 170 2579 514
183 182.0 3 -3 181 2728 544
185 187.0 -4 -1 186 2806 560
190 192.0 -2 1 194 2878 579
196 197.0 -1 3 198 2949 595
212 212.0 2 -3 211 3175 635
217 217.0 -2 3 218 3260 652
222 222.0 1 -1 223 3331 666
226 227.0 -1 3 228 3399 685
233 232.0 3 1 232 3473 698
248 247.0 2 2 249 3706 743
122 NULL NULL 1 124 NULL 369
NULL NULL NULL -2 145 NULL 439
NULL NULL NULL 1 151 NULL 455
NULL NULL NULL 3 158 NULL 475
NULL NULL NULL 1 167 NULL 502
NULL NULL NULL -1 175 NULL 529
238 NULL 1 NULL 236 NULL 711
NULL NULL NULL -4 240 NULL 723
207 NULL NULL -2 206 NULL NULL
114 NULL 4 -1 112 NULL NULL
116 NULL -1 NULL NULL NULL NULL
101 NULL NULL NULL NULL NULL NULL

statement query IFIIIII
select d as col1,
       (a+b+c+d+e)/5 as col2,
       d-e as col3,
       b-c as col4,
       b as col5,
       a+b*2+c*3+d*4+e*5 as col6,
       a+b*2 as col7
from t1
where c>d
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col2,col7,col5,col1,col4,col6,col3;

----
128 127.0 2 4 129 1902 385
133 132.0 1 -4 130 1985 391
136 137.0 1 2 139 2046 416
140 142.0 -4 2 143 2131 428
164 162.0 2 -1 160 2432 483
171 172.0 -2 -2 170 2579 514
183 182.0 3 -3 181 2728 544
185 187.0 -4 -1 186 2806 560
190 192.0 -2 1 194 2878 579
196 197.0 -1 3 198 2949 595
212 212.0 2 -3 211 3175 635
217 217.0 -2 3 218 3260 652
222 222.0 1 -1 223 3331 666
226 227.0 -1 3 228 3399 685
233 232.0 3 1 232 3473 698
248 247.0 2 2 249 3706 743
122 NULL NULL 1 124 NULL 369
NULL NULL NULL -2 145 NULL 439
NULL NULL NULL 1 151 NULL 455
NULL NULL NULL 3 158 NULL 475
NULL NULL NULL 1 167 NULL 502
NULL NULL NULL -1 175 NULL 529
238 NULL 1 NULL 236 NULL 711
NULL NULL NULL -4 240 NULL 723
114 NULL 4 -1 112 NULL NULL
207 NULL NULL -2 206 NULL NULL
101 NULL NULL NULL NULL NULL NULL
116 NULL -1 NULL NULL NULL NULL

statement query IIIIII
select a+b*2 as col1,
       b as col2,
       abs(b-c) as col3,
       d-e as col4,
       a as col5,
       c-d as col6
from t1
where a>b
    or e+d between a+b-10 and c+130
order by col6,col4,col5,col2,col3,col1;

----
385 129 4 2 127 -3
483 160 1 2 163 -3
317 105 1 -1 107 -2
698 232 1 3 234 -2
595 198 3 -1 199 -1
685 228 3 -1 229 -1
514 170 2 -2 174 1
391 130 4 1 131 1
544 181 3 3 182 1
560 186 1 -4 188 2
635 211 3 2 213 2
711 236 NULL 1 239 NULL
439 145 2 NULL 149 NULL
455 151 1 NULL 153 NULL
475 158 3 NULL 159 NULL
502 167 1 NULL 168 NULL
529 175 1 NULL 179 NULL
723 240 4 NULL 243 NULL

statement query IIIIII
select a+b*2 as col1,
       b as col2,
       abs(b-c) as col3,
       d-e as col4,
       a as col5,
       c-d as col6
from t1
where a>b
    or e+d between a+b-10 and c+130
order by col2,col3,col5,col6,col4,col1;

----
317 105 1 -1 107 -2
385 129 4 2 127 -3
391 130 4 1 131 1
439 145 2 NULL 149 NULL
455 151 1 NULL 153 NULL
475 158 3 NULL 159 NULL
483 160 1 2 163 -3
502 167 1 NULL 168 NULL
514 170 2 -2 174 1
529 175 1 NULL 179 NULL
544 181 3 3 182 1
560 186 1 -4 188 2
595 198 3 -1 199 -1
635 211 3 2 213 2
685 228 3 -1 229 -1
698 232 1 3 234 -2
711 236 NULL 1 239 NULL
723 240 4 NULL 243 NULL

statement query IIIIII
select a+b*2 as col1,
       b as col2,
       abs(b-c) as col3,
       d-e as col4,
       a as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
    or a>b
order by col6,col4,col5,col2,col3,col1;

----
385 129 4 2 127 -3
483 160 1 2 163 -3
317 105 1 -1 107 -2
698 232 1 3 234 -2
595 198 3 -1 199 -1
685 228 3 -1 229 -1
514 170 2 -2 174 1
391 130 4 1 131 1
544 181 3 3 182 1
560 186 1 -4 188 2
635 211 3 2 213 2
711 236 NULL 1 239 NULL
439 145 2 NULL 149 NULL
455 151 1 NULL 153 NULL
475 158 3 NULL 159 NULL
502 167 1 NULL 168 NULL
529 175 1 NULL 179 NULL
723 240 4 NULL 243 NULL

statement query IIIIII
select a+b*2 as col1,
       b as col2,
       abs(b-c) as col3,
       d-e as col4,
       a as col5,
       c-d as col6
from t1
where e+d between a+b-10 and c+130
    or a>b
order by col2,col6,col5,col1,col3,col4;

----
317 105 1 -1 107 -2
385 129 4 2 127 -3
391 130 4 1 131 1
439 145 2 NULL 149 NULL
455 151 1 NULL 153 NULL
475 158 3 NULL 159 NULL
483 160 1 2 163 -3
502 167 1 NULL 168 NULL
514 170 2 -2 174 1
529 175 1 NULL 179 NULL
544 181 3 3 182 1
560 186 1 -4 188 2
595 198 3 -1 199 -1
635 211 3 2 213 2
685 228 3 -1 229 -1
698 232 1 3 234 -2
711 236 NULL 1 239 NULL
723 240 4 NULL 243 NULL

statement query I
select d-e as col1
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where (a>b-2 and a<b+2)
    or e+d between a+b-10 and c+130
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
    or exists(select 1 from t1 as x where x.b<t1.b)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query I
select d-e as col1
from t1
where exists(select 1 from t1 as x where x.b<t1.b)
    or e+d between a+b-10 and c+130
    or (a>b-2 and a<b+2)
order by col1;

----
-4
-4
-2
-2
-2
-1
-1
-1
-1
1
1
1
1
2
2
2
2
3
3
4
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

statement query IIIFII
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       abs(a) as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b-c as col6
from t1
order by col6,col4,col5,col2,col3,col1;

----
444 131 133 132.0 4 -4
222 243 NULL NULL 25 -4
333 182 183 182.0 14 -3
222 213 212 212.0 19 -3
555 174 171 172.0 12 -2
555 149 NULL NULL 7 -2
555 NULL 207 NULL 18 -2
333 107 108 107.0 0 -1
333 163 164 162.0 10 -1
444 188 185 187.0 15 -1
444 220 222 222.0 21 -1
555 NULL 114 NULL 1 -1
555 179 NULL NULL 13 -1
444 191 190 192.0 16 1
555 234 233 232.0 23 1
333 121 122 NULL 2 1
555 153 NULL NULL 8 1
555 168 NULL NULL 11 1
111 138 136 137.0 5 2
111 142 140 142.0 6 2
444 245 248 247.0 26 2
555 199 196 197.0 17 3
333 216 217 217.0 20 3
555 229 226 227.0 22 3
555 159 NULL NULL 9 3
333 127 128 127.0 3 4
555 104 101 NULL 0 NULL
333 115 116 NULL 0 NULL
222 201 203 NULL 0 NULL
555 239 238 NULL 24 NULL

statement query IIITIT
select case a+1 when b then 111 when c then 222
        when d then 333  when e then 444 else 555 end as col1,
       abs(a) as col2,
       d as col3,
       (a+b+c+d+e)/5 as col4,
       (select count(*) from t1 as x where x.b<t1.b) as col5,
       b-c as col6
from t1
order by col5,col1,col4,col3,col6,col2;

----
222 201 203 NULL 0 NULL
333 107 108 107.0 0 -1
333 115 116 NULL 0 NULL
555 104 101 NULL 0 NULL
555 NULL 114 NULL 1 -1
333 121 122 NULL 2 1
333 127 128 127.0 3 4
444 131 133 132.0 4 -4
111 138 136 137.0 5 2
111 142 140 142.0 6 2
555 149 NULL NULL 7 -2
555 153 NULL NULL 8 1
555 159 NULL NULL 9 3
333 163 164 162.0 10 -1
555 168 NULL NULL 11 1
555 174 171 172.0 12 -2
555 179 NULL NULL 13 -1
333 182 183 182.0 14 -3
444 188 185 187.0 15 -1
444 191 190 192.0 16 1
555 199 196 197.0 17 3
555 NULL 207 NULL 18 -2
222 213 212 212.0 19 -3
333 216 217 217.0 20 3
444 220 222 222.0 21 -1
555 229 226 227.0 22 3
555 234 233 232.0 23 1
555 239 238 NULL 24 NULL
222 243 NULL NULL 25 -4
444 245 248 247.0 26 2

statement query IIIII
select a as col1,
       case when a<b-3 then 111 when a<=b then 222
        when a<b+3 then 333 else 444 end as col2,
       e as col3,
       a+b*2+c*3+d*4+e*5 as col4,
       a-b as col5
from t1
order by col4,col5,col2,col3,col1;

----
107 333 109 1612 2
127 222 126 1902 -2
131 333 132 1985 1
138 222 135 2046 -1
142 222 144 2131 -1
163 444 162 2432 3
174 444 173 2579 4
182 333 180 2728 1
188 333 189 2806 2
191 222 192 2878 -3
199 333 197 2949 1
213 333 210 3175 2
216 222 219 3260 -2
220 222 221 3331 -3
229 333 227 3399 1
234 333 230 3473 2
245 111 246 3706 -4
121 222 NULL NULL -3
159 333 157 NULL 1
168 333 165 NULL 1
153 333 NULL NULL 2
239 444 237 NULL 3
243 444 NULL NULL 3
149 444 146 NULL 4
179 444 177 NULL 4
NULL 444 110 NULL NULL
115 444 117 NULL NULL
201 444 204 NULL NULL
104 444 NULL NULL NULL
NULL 444 NULL NULL NULL

