statement ok
DROP DATABASE IF EXISTS db1

statement ok
CREATE DATABASE db1

statement ok
USE db1

statement ok
CREATE TABLE test_table(id INTEGER, age INT)

statement ok
insert into test_table (id, age) values (1,3)

statement ok
DROP STAGE IF EXISTS test

statement ok
CREATE STAGE IF NOT EXISTS test

statement ok
copy into @test from test_table FILE_FORMAT = (type = parquet)

statement ok
copy into test_table from (select (t.id+1), age from @test t)  FILE_FORMAT = (type = parquet)

query II
select * from test_table order by id
----
1 3
2 3

statement error 1016
copy into test_table from (select (t.id+1), age from @test t)  FILE_FORMAT = (type = parquet)

statement ok
copy into test_table from (select (t.id+1), age from @test t)  FILE_FORMAT = (type = parquet) force=true

query II
select * from test_table order by id
----
1 3
2 3
2 3
