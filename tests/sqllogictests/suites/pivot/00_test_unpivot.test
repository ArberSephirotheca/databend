statement ok
CREATE TABLE monthly_sales(empid INT, dept TEXT, Jan INT, Feb INT, Mar INT, April INT);

statement ok
INSERT INTO monthly_sales VALUES
    (1, 'electronics', 100, 200, 300, 100),
    (2, 'clothes', 100, 300, 150, 200),
    (3, 'cars', 200, 400, 100, 50);

query IIII
SELECT * exclude(Jan,Feb,Mar,April), unnest(['Jan','Feb','Mar','April']) AS month, unnest([Jan,Feb,Mar,April]) AS sales
FROM monthly_sales
ORDER BY empid;
----
1	electronics	Jan	100
1	electronics	Feb	200
1	electronics	Mar	300
1	electronics	April	100
2	clothes	Jan	100
2	clothes	Feb	300
2	clothes	Mar	150
2	clothes	April	200
3	cars	Jan	200
3	cars	Feb	400
3	cars	Mar	100
3	cars	April	50

query IIII
SELECT * FROM monthly_sales
    UNPIVOT(sales FOR month IN (jan, feb, mar, april))
    ORDER BY empid;
----
1	electronics	Jan	100
1	electronics	Feb	200
1	electronics	Mar	300
1	electronics	April	100
2	clothes	Jan	100
2	clothes	Feb	300
2	clothes	Mar	150
2	clothes	April	200
3	cars	Jan	200
3	cars	Feb	400
3	cars	Mar	100
3	cars	April	50

statement ok
drop table monthly_sales;


