ast            : TRY_CAST(a AS UINT8)
raw expr       : TRY_CAST(#0::UInt16 AS UInt8)
checked expr   : try_to_uint8<UInt16>(#0)
evaluation:
+--------+------------+--------------------+
|        | a          | Output             |
+--------+------------+--------------------+
| Type   | UInt16     | UInt8 NULL         |
| Domain | {0..=1024} | {0..=255} ∪ {NULL} |
| Row 0  | 0          | 0                  |
| Row 1  | 64         | 64                 |
| Row 2  | 255        | 255                |
| Row 3  | 512        | NULL               |
| Row 4  | 1024       | NULL               |
+--------+------------+--------------------+
evaluation (internal):
+--------+------------------------------------------------------------------------------+
| Column | Data                                                                         |
+--------+------------------------------------------------------------------------------+
| a      | UInt16([0, 64, 255, 512, 1024])                                              |
| Output | NullableColumn { column: UInt8([0, 64, 255, 0, 0]), validity: [0b___00111] } |
+--------+------------------------------------------------------------------------------+


ast            : TRY_CAST(a AS UINT16)
raw expr       : TRY_CAST(#0::Int16 AS UInt16)
checked expr   : try_to_uint16<Int16>(#0)
evaluation:
+--------+----------+------------------+
|        | a        | Output           |
+--------+----------+------------------+
| Type   | Int16    | UInt16 NULL      |
| Domain | {-4..=3} | {0..=3} ∪ {NULL} |
| Row 0  | 0        | 0                |
| Row 1  | 1        | 1                |
| Row 2  | 2        | 2                |
| Row 3  | 3        | 3                |
| Row 4  | -4       | NULL             |
+--------+----------+------------------+
evaluation (internal):
+--------+----------------------------------------------------------------------------+
| Column | Data                                                                       |
+--------+----------------------------------------------------------------------------+
| a      | Int16([0, 1, 2, 3, -4])                                                    |
| Output | NullableColumn { column: UInt16([0, 1, 2, 3, 0]), validity: [0b___01111] } |
+--------+----------------------------------------------------------------------------+


ast            : TRY_CAST(a AS INT64)
raw expr       : TRY_CAST(#0::Int16 AS Int64)
checked expr   : try_to_int64<Int16>(#0)
evaluation:
+--------+----------+------------+
|        | a        | Output     |
+--------+----------+------------+
| Type   | Int16    | Int64 NULL |
| Domain | {-4..=3} | {-4..=3}   |
| Row 0  | 0        | 0          |
| Row 1  | 1        | 1          |
| Row 2  | 2        | 2          |
| Row 3  | 3        | 3          |
| Row 4  | -4       | -4         |
+--------+----------+------------+
evaluation (internal):
+--------+----------------------------------------------------------------------------+
| Column | Data                                                                       |
+--------+----------------------------------------------------------------------------+
| a      | Int16([0, 1, 2, 3, -4])                                                    |
| Output | NullableColumn { column: Int64([0, 1, 2, 3, -4]), validity: [0b___11111] } |
+--------+----------------------------------------------------------------------------+


ast            : (TRY_CAST(a AS FLOAT32), TRY_CAST(a AS INT32), TRY_CAST(b AS FLOAT32), TRY_CAST(b AS INT32))
raw expr       : tuple(TRY_CAST(#0::UInt64 AS Float32), TRY_CAST(#0::UInt64 AS Int32), TRY_CAST(#1::Float64 AS Float32), TRY_CAST(#1::Float64 AS Int32))
checked expr   : tuple<Float32 NULL, Int32 NULL, Float32 NULL, Int32 NULL>(try_to_float32<UInt64>(#0), try_to_int32<UInt64>(#0), try_to_float32<Float64>(#1), try_to_int32<Float64>(#1))
evaluation:
+--------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
|        | a                          | b                                                                                                                                                                                                                                                                                                                              | Output                                                                                                     |
+--------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
| Type   | UInt64                     | Float64                                                                                                                                                                                                                                                                                                                        | (Float32 NULL, Int32 NULL, Float32 NULL, Int32 NULL)                                                       |
| Domain | {0..=18446744073709551615} | {-179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000..=inf} | ({0..=18446744000000000000}, {0..=2147483647} ∪ {NULL}, {-inf..=inf}, {-2147483648..=2147483647} ∪ {NULL}) |
| Row 0  | 0                          | 0                                                                                                                                                                                                                                                                                                                              | (0, 0, 0, 0)                                                                                               |
| Row 1  | 1                          | 4294967295                                                                                                                                                                                                                                                                                                                     | (1, 1, 4294967296, NULL)                                                                                   |
| Row 2  | 255                        | 18446744073709551616                                                                                                                                                                                                                                                                                                           | (255, 255, 18446744073709551616, NULL)                                                                     |
| Row 3  | 65535                      | -179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000         | (65535, 65535, -inf, NULL)                                                                                 |
| Row 4  | 4294967295                 | 179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000          | (4294967296, NULL, inf, NULL)                                                                              |
| Row 5  | 18446744073709551615       | inf                                                                                                                                                                                                                                                                                                                            | (18446744073709551616, NULL, inf, NULL)                                                                    |
+--------+----------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------------------------+
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a      | UInt64([0, 1, 255, 65535, 4294967295, 18446744073709551615])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| b      | Float64([0, 4294967295, 18446744073709551616, -179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, 179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, inf]) |
| Output | Tuple { fields: [NullableColumn { column: Float32([0, 1, 255, 65535, 4294967296, 18446744073709551616]), validity: [0b__111111] }, NullableColumn { column: Int32([0, 1, 255, 65535, 0, 0]), validity: [0b__001111] }, NullableColumn { column: Float32([0, 4294967296, 18446744073709551616, -inf, inf, inf]), validity: [0b__111111] }, NullableColumn { column: Int32([0, 0, 0, 0, 0, 0]), validity: [0b__000001] }], len: 6 }                                                                                                                                                                                                                                                                  |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast            : TRY_CAST([[a, b], NULL, NULL] AS Array(Array(Int8)))
raw expr       : TRY_CAST(array(array(#0::Int16, #1::Int16), NULL, NULL) AS Array(Array(Int8)))
checked expr   : TRY_CAST(array<T0=Array(Int16) NULL><T0, T0, T0>(CAST(array<T0=Int16><T0, T0>(#0, #1) AS Array(Int16) NULL), CAST(NULL AS Array(Int16) NULL), CAST(NULL AS Array(Int16) NULL)) AS Array(Array(Int8 NULL) NULL) NULL)
optimized expr : TRY_CAST(array<T0=Array(Int16) NULL><T0, T0, T0>(CAST(array<T0=Int16><T0, T0>(#0, #1) AS Array(Int16) NULL), NULL, NULL) AS Array(Array(Int8 NULL) NULL) NULL)
evaluation:
+--------+-----------+------------+------------------------------------+
|        | a         | b          | Output                             |
+--------+-----------+------------+------------------------------------+
| Type   | Int16     | Int16      | Array(Array(Int8 NULL) NULL) NULL  |
| Domain | {0..=255} | {-129..=0} | [[{-128..=127} ∪ {NULL}] ∪ {NULL}] |
| Row 0  | 0         | 0          | [[0, 0], [], []]                   |
| Row 1  | 1         | -1         | [[1, -1], [], []]                  |
| Row 2  | 2         | -127       | [[2, -127], [], []]                |
| Row 3  | 127       | -128       | [[127, -128], [], []]              |
| Row 4  | 255       | -129       | [[NULL, NULL], [], []]             |
+--------+-----------+------------+------------------------------------+
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                        |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a      | Int16([0, 1, 2, 127, 255])                                                                                                                                                                                                                                                                                                                                                  |
| b      | Int16([0, -1, -127, -128, -129])                                                                                                                                                                                                                                                                                                                                            |
| Output | NullableColumn { column: ArrayColumn { values: NullableColumn { column: ArrayColumn { values: NullableColumn { column: Int8([0, 0, 1, -1, 2, -127, 127, -128, 0, 0]), validity: [0b11111111, 0b______00] }, offsets: [0, 2, 2, 2, 4, 4, 4, 6, 6, 6, 8, 8, 8, 10, 10, 10] }, validity: [0b11111111, 0b_1111111] }, offsets: [0, 3, 6, 9, 12, 15] }, validity: [0b___11111] } |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast            : TRY_CAST((a, b, NULL) AS TUPLE(Int8, UInt8, Boolean NULL))
raw expr       : TRY_CAST(tuple(#0::Int16, #1::Int16, NULL) AS (Int8, UInt8, Boolean NULL))
checked expr   : TRY_CAST(tuple<Int16, Int16, NULL>(#0, #1, NULL) AS (Int8 NULL, UInt8 NULL, Boolean NULL) NULL)
evaluation:
+--------+-----------+------------+------------------------------------------------+
|        | a         | b          | Output                                         |
+--------+-----------+------------+------------------------------------------------+
| Type   | Int16     | Int16      | (Int8 NULL, UInt8 NULL, Boolean NULL) NULL     |
| Domain | {0..=256} | {-129..=1} | ({0..=127} ∪ {NULL}, {0..=1} ∪ {NULL}, {NULL}) |
| Row 0  | 0         | 0          | (0, 0, NULL)                                   |
| Row 1  | 1         | 1          | (1, 1, NULL)                                   |
| Row 2  | 2         | -127       | (2, NULL, NULL)                                |
| Row 3  | 127       | -128       | (127, NULL, NULL)                              |
| Row 4  | 256       | -129       | (NULL, NULL, NULL)                             |
+--------+-----------+------------+------------------------------------------------+
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                        |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| a      | Int16([0, 1, 2, 127, 256])                                                                                                                                                                                                                                  |
| b      | Int16([0, 1, -127, -128, -129])                                                                                                                                                                                                                             |
| Output | Tuple { fields: [NullableColumn { column: Int8([0, 1, 2, 127, 0]), validity: [0b___01111] }, NullableColumn { column: UInt8([0, 1, 0, 0, 0]), validity: [0b___00011] }, NullableColumn { column: Boolean([0b___00000]), validity: [0b___00000] }], len: 5 } |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast            : CAST(a AS INT16)
raw expr       : CAST(#0::Float64 AS Int16)
checked expr   : to_int16<Float64>(#0)
evaluation:
+--------+--------------+----------+
|        | a            | Output   |
+--------+--------------+----------+
| Type   | Float64      | Int16    |
| Domain | {-4.4..=3.3} | {-4..=3} |
| Row 0  | 0            | 0        |
| Row 1  | 1.1          | 1        |
| Row 2  | 2.2          | 2        |
| Row 3  | 3.3          | 3        |
| Row 4  | -4.4         | -4       |
+--------+--------------+----------+
evaluation (internal):
+--------+-----------------------------------+
| Column | Data                              |
+--------+-----------------------------------+
| a      | Float64([0, 1.1, 2.2, 3.3, -4.4]) |
| Output | Int16([0, 1, 2, 3, -4])           |
+--------+-----------------------------------+


ast            : CAST(b AS INT16)
raw expr       : CAST(#0::Int8 AS Int16)
checked expr   : to_int16<Int8>(#0)
evaluation:
+--------+----------+----------+
|        | b        | Output   |
+--------+----------+----------+
| Type   | Int8     | Int16    |
| Domain | {-4..=3} | {-4..=3} |
| Row 0  | 0        | 0        |
| Row 1  | 1        | 1        |
| Row 2  | 2        | 2        |
| Row 3  | 3        | 3        |
| Row 4  | -4       | -4       |
+--------+----------+----------+
evaluation (internal):
+--------+-------------------------+
| Column | Data                    |
+--------+-------------------------+
| b      | Int8([0, 1, 2, 3, -4])  |
| Output | Int16([0, 1, 2, 3, -4]) |
+--------+-------------------------+


error: 
  --> SQL:1:1
  |
1 | CAST(a AS UINT16)
  | ^^^^^^^^^^^^^^^^^ unable to cast -4 to UInt16



error: 
  --> SQL:1:1
  |
1 | CAST(c AS INT16)
  | ^^^^^^^^^^^^^^^^ unable to cast 11111111111 to Int16



